From apw@canonical.com  Tue Nov 17 11:13:50 2009
From: Andy Whitcroft <apw@canonical.com>
Date: Fri, 10 Jul 2009 14:51:41 +0000 (+0100)
Subject: AppArmor: fix operator precidence issue in as_path_link
Git-commit: 14af2d3f28b70768e8b804cb2a09637ab555ed79
Git-Repo: git://kernel.ubuntu.com/jj/apparmor-mainline.git AppArmor-2.4

AppArmor: fix operator precidence issue in as_path_link

Looks like a previous attempt to fix the operator precidence missed.

Signed-off-by: Andy Whitcroft <apw@canonical.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>
Acked-by: Jeff Mahoney <jeffm@suse.com>
---
 security/apparmor/file.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/security/apparmor/file.c
+++ b/security/apparmor/file.c
@@ -310,7 +310,7 @@ int aa_path_link(struct aa_profile *prof
 	sa.perms.quiet &= AA_MAY_LINK;
 	sa.perms.kill &= AA_MAY_LINK;
 
-	if ((!sa.perms.allowed & AA_MAY_LINK)) {
+	if (!(sa.perms.allowed & AA_MAY_LINK)) {
 		sa.base.error = -EACCES;
 		goto audit;
 	}
