From aa74c3755ecc24914f9b3aaf5ba1436836697a7d Mon Sep 17 00:00:00 2001
From: Ben Skeggs <bskeggs@redhat.com>
Date: Wed, 12 Sep 2012 13:38:13 +1000
Subject: drm/nouveau: have drm debugging macros build on top of core macros
Git-commit: aa74c3755ecc24914f9b3aaf5ba1436836697a7d
Patch-mainline: v3.7-rc3

May kill the DRM version completely at some point, undecided..

Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
Acked-by: Michal Srb <msrb@suse.com>
---
 drivers/gpu/drm/nouveau/nouveau_drm.h |   19 ++++++-------------
 1 files changed, 6 insertions(+), 13 deletions(-)

diff --git a/drivers/gpu/drm/nouveau/nouveau_drm.h b/drivers/gpu/drm/nouveau/nouveau_drm.h
index ab0c174..3c12e98 100644
--- a/drivers/gpu/drm/nouveau/nouveau_drm.h
+++ b/drivers/gpu/drm/nouveau/nouveau_drm.h
@@ -132,20 +132,13 @@ nouveau_dev(struct drm_device *dev)
 int nouveau_drm_suspend(struct pci_dev *, pm_message_t);
 int nouveau_drm_resume(struct pci_dev *);
 
-#define NV_PRINTK(level, code, drm, fmt, args...)                              \
-	printk(level "nouveau " code "[     DRM][%s] " fmt,                    \
-	       pci_name((drm)->dev->pdev), ##args)
-#define NV_FATAL(drm, fmt, args...)                                            \
-	NV_PRINTK(KERN_CRIT, "!", (drm), fmt, ##args)
-#define NV_ERROR(drm, fmt, args...)                                            \
-	NV_PRINTK(KERN_ERR, "E", (drm), fmt, ##args)
-#define NV_WARN(drm, fmt, args...)                                             \
-	NV_PRINTK(KERN_WARNING, "W", (drm), fmt, ##args)
-#define NV_INFO(drm, fmt, args...)                                             \
-	NV_PRINTK(KERN_INFO, " ", (drm), fmt, ##args)
-#define NV_DEBUG(drm, fmt, args...) do {                                       \
+#define NV_FATAL(cli, fmt, args...) nv_fatal((cli), fmt, ##args)
+#define NV_ERROR(cli, fmt, args...) nv_error((cli), fmt, ##args)
+#define NV_WARN(cli, fmt, args...) nv_warn((cli), fmt, ##args)
+#define NV_INFO(cli, fmt, args...) nv_info((cli), fmt, ##args)
+#define NV_DEBUG(cli, fmt, args...) do {                                       \
 	if (drm_debug & DRM_UT_DRIVER)                                         \
-		NV_PRINTK(KERN_DEBUG, "D", drm, fmt, ##args);                  \
+		nv_info((cli), fmt, ##args);                                   \
 } while (0)
 
 #endif

