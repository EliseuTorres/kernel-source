From 8035ccabc961cdc4f17500312276d0c682396fbc Mon Sep 17 00:00:00 2001
From: Dave Airlie <airlied@redhat.com>
Date: Tue, 18 May 2010 19:00:14 +1000
Patch-mainline: 2.6.35
References: fate#310916
Git-commit: 26481fb15644b5fd85d4cea020f74a234cdf6803
Subject: [PATCH 0768/2588] drm/radeon/pm: fix device_create_file return value
 checks.

print an error if these fail.

Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 26481fb15644b5fd85d4cea020f74a234cdf6803)

Signed-off-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/gpu/drm/radeon/radeon_pm.c |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/radeon/radeon_pm.c b/drivers/gpu/drm/radeon/radeon_pm.c
index c88edae..a8d162c 100644
--- a/drivers/gpu/drm/radeon/radeon_pm.c
+++ b/drivers/gpu/drm/radeon/radeon_pm.c
@@ -398,6 +398,7 @@ void radeon_pm_resume(struct radeon_device *rdev)
 
 int radeon_pm_init(struct radeon_device *rdev)
 {
+	int ret;
 	/* default to profile method */
 	rdev->pm.pm_method = PM_METHOD_PROFILE;
 	rdev->pm.dynpm_state = DYNPM_STATE_DISABLED;
@@ -427,8 +428,12 @@ int radeon_pm_init(struct radeon_device *rdev)
 		}
 
 		/* where's the best place to put these? */
-		device_create_file(rdev->dev, &dev_attr_power_profile);
-		device_create_file(rdev->dev, &dev_attr_power_method);
+		ret = device_create_file(rdev->dev, &dev_attr_power_profile);
+		if (ret)
+			DRM_ERROR("failed to create device file for power profile\n");
+		ret = device_create_file(rdev->dev, &dev_attr_power_method);
+		if (ret)
+			DRM_ERROR("failed to create device file for power method\n");
 
 #ifdef CONFIG_ACPI
 		rdev->acpi_nb.notifier_call = radeon_acpi_event;
-- 
1.7.6

