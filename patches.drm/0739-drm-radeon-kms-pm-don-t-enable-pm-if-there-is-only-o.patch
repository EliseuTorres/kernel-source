From bf58af36abe87baeddd8404e2561a8120e62ab9f Mon Sep 17 00:00:00 2001
From: Alex Deucher <alexdeucher@gmail.com>
Date: Wed, 24 Mar 2010 11:32:29 -0400
Patch-mainline: 2.6.35
References: fate#310916
Git-commit: 90c3905950021a9b37ac1a4dd78225881f4c61e4
Subject: [PATCH 0739/2588] drm/radeon/kms/pm: don't enable pm if there is
 only on power state

Just adds overhead when the power state will never change.

Signed-off-by: Alex Deucher <alexdeucher@gmail.com>
Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 90c3905950021a9b37ac1a4dd78225881f4c61e4)

Signed-off-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/gpu/drm/radeon/radeon_pm.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/gpu/drm/radeon/radeon_pm.c b/drivers/gpu/drm/radeon/radeon_pm.c
index a137ee2..8111264 100644
--- a/drivers/gpu/drm/radeon/radeon_pm.c
+++ b/drivers/gpu/drm/radeon/radeon_pm.c
@@ -113,7 +113,7 @@ int radeon_pm_init(struct radeon_device *rdev)
 
 	INIT_DELAYED_WORK(&rdev->pm.idle_work, radeon_pm_idle_work_handler);
 
-	if (radeon_dynpm != -1 && radeon_dynpm) {
+	if ((radeon_dynpm != -1 && radeon_dynpm) && (rdev->pm.num_power_states > 1)) {
 		rdev->pm.state = PM_STATE_PAUSED;
 		DRM_INFO("radeon: dynamic power management enabled\n");
 	}
-- 
1.7.6

