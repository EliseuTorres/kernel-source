From f3298532f71f163877b9003009d6e1eefe988258 Mon Sep 17 00:00:00 2001
From: Ben Skeggs <bskeggs@redhat.com>
Date: Tue, 13 Dec 2011 12:46:18 +1000
Subject: drm/nvc0: add initial memory type detection
Git-commit: f3298532f71f163877b9003009d6e1eefe988258
Patch-mainline: v3.4-rc1

Uses only the VBIOS tables, from what I can tell this is what NVIDIA do
too, I was able to change the detected memory type by modifying this table
on a NVC1 chipset.

Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
Acked-by: Michal Srb <msrb@suse.com>
---
 drivers/gpu/drm/nouveau/nvc0_vram.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/nouveau/nvc0_vram.c b/drivers/gpu/drm/nouveau/nvc0_vram.c
index ce984d5..fd687ee 100644
--- a/drivers/gpu/drm/nouveau/nvc0_vram.c
+++ b/drivers/gpu/drm/nouveau/nvc0_vram.c
@@ -115,6 +115,8 @@ nvc0_vram_init(struct drm_device *dev)
 	NV_DEBUG(dev, "0x100800: 0x%08x\n", nv_rd32(dev, 0x100800));
 	NV_DEBUG(dev, "parts 0x%08x bcast_mem_amount 0x%08x\n", parts, bsize);
 
+	dev_priv->vram_type = nouveau_mem_vbios_type(dev);
+
 	/* read amount of vram attached to each memory controller */
 	part = 0;
 	while (parts) {

