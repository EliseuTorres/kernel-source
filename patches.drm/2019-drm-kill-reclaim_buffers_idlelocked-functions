From 3ae6b64400cc92530bcab73d13c6e1b7a5cfd915 Mon Sep 17 00:00:00 2001
From: Daniel Vetter <daniel.vetter@ffwll.ch>
Date: Tue, 25 Oct 2011 23:42:29 +0200
Subject: drm: kill reclaim_buffers_idlelocked functions
Git-commit: 3ae6b64400cc92530bcab73d13c6e1b7a5cfd915
Patch-mainline: v3.6-rc1

The only two users are now folded into the drivers preclose functions,
so this is unused.

Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
Signed-off-by: Dave Airlie <airlied@redhat.com>
Acked-by: Michal Srb <msrb@suse.com>
---
 drivers/gpu/drm/drm_fops.c |    8 --------
 include/drm/drmP.h         |    2 --
 2 files changed, 0 insertions(+), 10 deletions(-)

diff --git a/drivers/gpu/drm/drm_fops.c b/drivers/gpu/drm/drm_fops.c
index 123de28..f6231f02 100644
--- a/drivers/gpu/drm/drm_fops.c
+++ b/drivers/gpu/drm/drm_fops.c
@@ -417,14 +417,6 @@ static void drm_master_release(struct drm_device *dev, struct file *filp)
 	    file_priv->master->lock.hw_lock)
 		drm_reclaim_locked_buffers(dev, filp);
 
-	if (dev->driver->reclaim_buffers_idlelocked &&
-	    file_priv->master->lock.hw_lock) {
-		drm_idlelock_take(&file_priv->master->lock);
-		dev->driver->reclaim_buffers_idlelocked(dev, file_priv);
-		drm_idlelock_release(&file_priv->master->lock);
-	}
-
-
 	if (drm_i_have_hw_lock(dev, file_priv)) {
 		DRM_DEBUG("File %p released, freeing lock for context %d\n",
 			  filp, _DRM_LOCKING_CONTEXT(file_priv->master->lock.hw_lock->lock));
diff --git a/include/drm/drmP.h b/include/drm/drmP.h
index e4e3be3..5f2211c 100644
--- a/include/drm/drmP.h
+++ b/include/drm/drmP.h
@@ -880,8 +880,6 @@ struct drm_driver {
 				 struct drm_file * file_priv);
 	void (*reclaim_buffers_locked) (struct drm_device *dev,
 					struct drm_file *file_priv);
-	void (*reclaim_buffers_idlelocked) (struct drm_device *dev,
-					    struct drm_file *file_priv);
 	void (*set_version) (struct drm_device *dev,
 			     struct drm_set_version *sv);
 

