From 160b2c3667a9c3e34311f4e7c79aa8d365b0018b Mon Sep 17 00:00:00 2001
From: Alex Deucher <alexdeucher@gmail.com>
Date: Tue, 23 Feb 2010 13:12:43 -0500
Patch-mainline: 2.6.34
References: fate#310916
Git-commit: 22e6dd7e700111c1aa49581d27f2b349cbc798dd
Subject: [PATCH 0444/2588] drm/radeon/kms/evergreen: fix typo in cursor code

cursor x/y are surface relative.

fixes fdo bug 26551

Signed-off-by: Alex Deucher <alexdeucher@gmail.com>
Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 22e6dd7e700111c1aa49581d27f2b349cbc798dd)

Signed-off-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/gpu/drm/radeon/radeon_cursor.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/radeon/radeon_cursor.c b/drivers/gpu/drm/radeon/radeon_cursor.c
index 6aa1954..b7023ff 100644
--- a/drivers/gpu/drm/radeon/radeon_cursor.c
+++ b/drivers/gpu/drm/radeon/radeon_cursor.c
@@ -215,6 +215,11 @@ int radeon_crtc_cursor_move(struct drm_crtc *crtc,
 
 	radeon_lock_cursor(crtc, true);
 	if (ASIC_IS_DCE4(rdev)) {
+		/* cursors are offset into the total surface */
+		x += crtc->x;
+		y += crtc->y;
+		DRM_DEBUG("x %d y %d c->x %d c->y %d\n", x, y, crtc->x, crtc->y);
+
 		/* XXX: check if evergreen has the same issues as avivo chips */
 		WREG32(EVERGREEN_CUR_POSITION + radeon_crtc->crtc_offset,
 		       ((xorigin ? 0 : x) << 16) |
-- 
1.7.6

