From b6d8e7ec38843edfc4a4491b746a17ff517ab4be Mon Sep 17 00:00:00 2001
From: Ben Skeggs <bskeggs@redhat.com>
Date: Thu, 7 Jul 2011 09:51:29 +1000
Subject: drm/nvd0/disp: stub dac load detect, prevents oops
Git-commit: b6d8e7ec38843edfc4a4491b746a17ff517ab4be
Patch-mainline: v3.2-rc1

Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
Acked-by: Michal Srb <msrb@suse.com>
---
 drivers/gpu/drm/nouveau/nvd0_display.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/nouveau/nvd0_display.c b/drivers/gpu/drm/nouveau/nvd0_display.c
index 7b3efff..08a54b7 100644
--- a/drivers/gpu/drm/nouveau/nvd0_display.c
+++ b/drivers/gpu/drm/nouveau/nvd0_display.c
@@ -637,6 +637,12 @@ nvd0_dac_disconnect(struct drm_encoder *encoder)
 	}
 }
 
+static enum drm_connector_status
+nvd0_dac_detect(struct drm_encoder *encoder, struct drm_connector *connector)
+{
+	return connector_status_disconnected;
+}
+
 static void
 nvd0_dac_destroy(struct drm_encoder *encoder)
 {
@@ -652,6 +658,7 @@ static const struct drm_encoder_helper_funcs nvd0_dac_hfunc = {
 	.mode_set = nvd0_dac_mode_set,
 	.disable = nvd0_dac_disconnect,
 	.get_crtc = nvd0_display_crtc_get,
+	.detect = nvd0_dac_detect
 };
 
 static const struct drm_encoder_funcs nvd0_dac_func = {

