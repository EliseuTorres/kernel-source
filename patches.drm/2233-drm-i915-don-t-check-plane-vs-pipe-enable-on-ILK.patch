From b26cfef428e582f0ae529ecbf7a0de3d19fd2edc Mon Sep 17 00:00:00 2001
From: Jesse Barnes <jbarnes@virtuousgeek.org>
Date: Wed, 2 Feb 2011 12:28:02 -0800
Patch-mainline: 2.6.39
References: fate#310916
Git-commit: 19ec135838f032ad1aa0610b173ad78c16d53d47
Subject: [PATCH 2233/2588] drm/i915: don't check plane vs pipe enable on ILK+

These bits have a different meaning on ILK+, where planes are hardwired
to pipes.  Fixing this avoid some spurious assertion failures.

Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk>
(cherry picked from commit 19ec135838f032ad1aa0610b173ad78c16d53d47)

Signed-off-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/gpu/drm/i915/intel_display.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/intel_display.c b/drivers/gpu/drm/i915/intel_display.c
index 7292bf9..b54f61d 100644
--- a/drivers/gpu/drm/i915/intel_display.c
+++ b/drivers/gpu/drm/i915/intel_display.c
@@ -1225,6 +1225,10 @@ static void assert_planes_disabled(struct drm_i915_private *dev_priv,
 	u32 val;
 	int cur_pipe;
 
+	/* Planes are fixed to pipes on ILK+ */
+	if (HAS_PCH_SPLIT(dev_priv->dev))
+		return;
+
 	/* Need to check both planes against the pipe */
 	for (i = 0; i < 2; i++) {
 		reg = DSPCNTR(i);
-- 
1.7.6

