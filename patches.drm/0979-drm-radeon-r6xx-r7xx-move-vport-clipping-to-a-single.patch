From fbb22c2204c4360dcb8ec817d7be439c92533660 Mon Sep 17 00:00:00 2001
From: Alex Deucher <alexdeucher@gmail.com>
Date: Mon, 26 Jul 2010 13:47:54 -0400
Patch-mainline: 2.6.36
References: fate#310916
Git-commit: 363c6a16e30464fddcb8f82b7e8f44109729cc95
Subject: [PATCH 0979/2588] drm/radeon: r6xx/r7xx move vport clipping to a
 single packet

Saves lots of dwords in blit emit

Signed-off-by: Alex Deucher <alexdeucher@gmail.com>
Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 363c6a16e30464fddcb8f82b7e8f44109729cc95)

Signed-off-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/gpu/drm/radeon/r600_blit_shaders.c |  310 ++++++----------------------
 1 files changed, 62 insertions(+), 248 deletions(-)

diff --git a/drivers/gpu/drm/radeon/r600_blit_shaders.c b/drivers/gpu/drm/radeon/r600_blit_shaders.c
index 3a775c1..9a0553c 100644
--- a/drivers/gpu/drm/radeon/r600_blit_shaders.c
+++ b/drivers/gpu/drm/radeon/r600_blit_shaders.c
@@ -167,163 +167,70 @@ const u32 r6xx_default_state[] =
 	0x20002000,
 	0x00000000, /* PA_SC_EDGERULE */
 
-	0xc0026900,
+	0xc0406900,
 	0x00000094,
 	0x80000000, /* PA_SC_VPORT_SCISSOR_0_TL */
 	0x20002000, /* PA_SC_VPORT_SCISSOR_0_BR */
-
-	0xc0026900,
-	0x000000b4,
-	0x00000000, /* PA_SC_VPORT_ZMIN_0 */
-	0x3f800000,
-
-	0xc0026900,
-	0x00000096,
 	0x80000000, /* PA_SC_VPORT_SCISSOR_1_TL */
 	0x20002000,
-
-	0xc0026900,
-	0x000000b6,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x00000098,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000b8,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x0000009a,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000ba,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x0000009c,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000bc,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x0000009e,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000be,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a0,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c0,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a2,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c2,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a4,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c4,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a6,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c6,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a8,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c8,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000aa,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000ca,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000ac,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000cc,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000ae,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000ce,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000b0,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000d0,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000b2,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000d2,
+	0x00000000, /* PA_SC_VPORT_ZMIN_0 */
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
 	0x00000000,
 	0x3f800000,
 
@@ -665,163 +572,70 @@ const u32 r7xx_default_state[] =
 	0x20002000,
 	0xaaaaaaaa, /* PA_SC_EDGERULE */
 
-	0xc0026900,
+	0xc0406900,
 	0x00000094,
 	0x80000000, /* PA_SC_VPORT_SCISSOR_0_TL */
 	0x20002000, /* PA_SC_VPORT_SCISSOR_0_BR */
-
-	0xc0026900,
-	0x000000b4,
-	0x00000000, /* PA_SC_VPORT_ZMIN_0 */
-	0x3f800000,
-
-	0xc0026900,
-	0x00000096,
+	0x80000000, /* PA_SC_VPORT_SCISSOR_1_TL */
+	0x20002000,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000b6,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x00000098,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000b8,
-	0x00000000,
-	0x3f800000,
-
-	0xc0016900,
-	0x0000009a,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000ba,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x0000009c,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000bc,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x0000009e,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000be,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a0,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c0,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a2,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c2,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a4,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c4,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a6,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c6,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000a8,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000c8,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000aa,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000ca,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000ac,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000cc,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000ae,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000ce,
-	0x00000000,
-	0x3f800000,
-
-	0xc0026900,
-	0x000000b0,
 	0x80000000,
 	0x20002000,
-
-	0xc0026900,
-	0x000000d0,
+	0x00000000, /* PA_SC_VPORT_ZMIN_0 */
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
+	0x00000000,
+	0x3f800000,
 	0x00000000,
 	0x3f800000,
-
-	0xc0026900,
-	0x000000b2,
-	0x80000000,
-	0x20002000,
-
-	0xc0026900,
-	0x000000d2,
 	0x00000000,
 	0x3f800000,
 
-- 
1.7.6

