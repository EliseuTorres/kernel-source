From: Dave Airlie <airlied@redhat.com>
Date: Wed Feb 5 14:47:45 2014 +1000
Subject: drm/mgag200,ast,cirrus: fix regression with drm_can_sleep conversion
Patch-mainline: Upstream
Git-commit: 8b7ad1bb3d440da888f2a939dc870eba429b9192

References: bnc#883380
Signed-off-by: Egbert Eich <eich@suse.com>

I totally sign inverted my way out of this one.

Cc: stable@vger.kernel.org
Reported-by: "Sabrina Dubroca" <sd@queasysnail.net>
Signed-off-by: Dave Airlie <airlied@redhat.com>
Signed-off-by: Egbert Eich <eich@suse.de>

Conflicts:
	drivers/gpu/drm/cirrus/cirrus_fbdev.c
	drivers/gpu/drm/mgag200/mgag200_fb.c
---
 drivers/gpu/drm/ast/ast_fb.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/ast/ast_fb.c b/drivers/gpu/drm/ast/ast_fb.c
index 0f92796..a29a163 100644
--- a/drivers/gpu/drm/ast/ast_fb.c
+++ b/drivers/gpu/drm/ast/ast_fb.c
@@ -64,7 +64,7 @@ static void ast_dirty_update(struct ast_fbdev *afbdev,
 	 * then the BO is being moved and we should
 	 * store up the damage until later.
 	 */
-	if (!drm_can_sleep())
+	if (drm_can_sleep())
 		ret = ast_bo_reserve(bo, true);
 	if (ret) {
 		if (ret != -EBUSY)
