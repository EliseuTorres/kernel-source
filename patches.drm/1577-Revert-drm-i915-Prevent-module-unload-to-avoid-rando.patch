From 92a7755e0000273135cf569a99c8abf7dbb55c07 Mon Sep 17 00:00:00 2001
From: Chris Wilson <chris@chris-wilson.co.uk>
Date: Fri, 8 Oct 2010 16:28:27 +0100
Patch-mainline: 2.6.37
References: fate#310916
Git-commit: 83e41eb9cc3de6c08d63bbcf2c953bfbf65c025c
Subject: [PATCH 1577/2588] Revert "drm/i915: Prevent module unload to avoid
 random memory corruption"

This reverts commit 6939a5aca7cfada279a24c307e772f33104fca20.

Daniel Vetter supplied a set of fixes for all the module unload bugs he
could trigger on his machines, so let the fun recommence!
(cherry picked from commit 83e41eb9cc3de6c08d63bbcf2c953bfbf65c025c)

Signed-off-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/gpu/drm/i915/i915_dma.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_dma.c b/drivers/gpu/drm/i915/i915_dma.c
index a99fae3..f451af6 100644
--- a/drivers/gpu/drm/i915/i915_dma.c
+++ b/drivers/gpu/drm/i915/i915_dma.c
@@ -2065,9 +2065,6 @@ int i915_driver_load(struct drm_device *dev, unsigned long flags)
 	dev_priv->mchdev_lock = &mchdev_lock;
 	spin_unlock(&mchdev_lock);
 
-	/* XXX Prevent module unload due to memory corruption bugs. */
-	__module_get(THIS_MODULE);
-
 	return 0;
 
 out_workqueue_free:
-- 
1.7.6

