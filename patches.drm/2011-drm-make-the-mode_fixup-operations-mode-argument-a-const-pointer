From e811f5ae19043b2ac2c28e147a4274038e655598 Mon Sep 17 00:00:00 2001
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date: Tue, 17 Jul 2012 17:56:50 +0200
Subject: drm: Make the .mode_fixup() operations mode argument a const pointer
Git-commit: e811f5ae19043b2ac2c28e147a4274038e655598
Patch-mainline: v3.6-rc1

The passed mode must not be modified by the operation, make it const.

Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Dave Airlie <airlied@redhat.com>
Acked-by: Michal Srb <msrb@suse.com>
---
 drivers/gpu/drm/ast/ast_mode.c                  |    6 +++---
 drivers/gpu/drm/cirrus/cirrus_mode.c            |    6 +++---
 drivers/gpu/drm/gma500/cdv_intel_crt.c          |    2 +-
 drivers/gpu/drm/gma500/cdv_intel_display.c      |    2 +-
 drivers/gpu/drm/gma500/cdv_intel_hdmi.c         |    2 +-
 drivers/gpu/drm/gma500/cdv_intel_lvds.c         |    2 +-
 drivers/gpu/drm/gma500/mdfld_dsi_dpi.c          |    2 +-
 drivers/gpu/drm/gma500/mdfld_dsi_dpi.h          |    2 +-
 drivers/gpu/drm/gma500/mdfld_intel_display.c    |    2 +-
 drivers/gpu/drm/gma500/oaktrail_crtc.c          |    2 +-
 drivers/gpu/drm/gma500/oaktrail_hdmi.c          |    2 +-
 drivers/gpu/drm/gma500/psb_intel_display.c      |    2 +-
 drivers/gpu/drm/gma500/psb_intel_drv.h          |    2 +-
 drivers/gpu/drm/gma500/psb_intel_lvds.c         |    2 +-
 drivers/gpu/drm/gma500/psb_intel_sdvo.c         |    6 +++---
 drivers/gpu/drm/i2c/ch7006_drv.c                |    2 +-
 drivers/gpu/drm/i2c/ch7006_mode.c               |    2 +-
 drivers/gpu/drm/i2c/ch7006_priv.h               |    2 +-
 drivers/gpu/drm/i2c/sil164_drv.c                |    2 +-
 drivers/gpu/drm/i915/dvo.h                      |    2 +-
 drivers/gpu/drm/i915/intel_crt.c                |    2 +-
 drivers/gpu/drm/i915/intel_dp.c                 |    3 ++-
 drivers/gpu/drm/i915/intel_dvo.c                |    2 +-
 drivers/gpu/drm/i915/intel_hdmi.c               |    2 +-
 drivers/gpu/drm/i915/intel_lvds.c               |    2 +-
 drivers/gpu/drm/i915/intel_sdvo.c               |    6 +++---
 drivers/gpu/drm/i915/intel_tv.c                 |    3 ++-
 drivers/gpu/drm/mgag200/mgag200_mode.c          |    8 ++++----
 drivers/gpu/drm/radeon/atombios_crtc.c          |    2 +-
 drivers/gpu/drm/radeon/atombios_dp.c            |    2 +-
 drivers/gpu/drm/radeon/atombios_encoders.c      |    4 ++--
 drivers/gpu/drm/radeon/radeon_display.c         |    4 ++--
 drivers/gpu/drm/radeon/radeon_legacy_crtc.c     |    2 +-
 drivers/gpu/drm/radeon/radeon_legacy_encoders.c |    2 +-
 drivers/gpu/drm/radeon/radeon_mode.h            |    4 ++--
 drivers/gpu/drm/udl/udl_encoder.c               |    2 +-
 drivers/gpu/drm/udl/udl_modeset.c               |    2 +-
 drivers/staging/omapdrm/omap_crtc.c             |    2 +-
 drivers/staging/omapdrm/omap_encoder.c          |    2 +-
 include/drm/drm_crtc_helper.h                   |    4 ++--
 include/drm/drm_encoder_slave.h                 |    2 +-
 55 files changed, 78 insertions(+), 72 deletions(-)

Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/ast/ast_mode.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/ast/ast_mode.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/ast/ast_mode.c
@@ -460,8 +460,8 @@ static void ast_crtc_dpms(struct drm_crt
 }
 
 static bool ast_crtc_mode_fixup(struct drm_crtc *crtc,
-				  struct drm_display_mode *mode,
-				  struct drm_display_mode *adjusted_mode)
+				const struct drm_display_mode *mode,
+				struct drm_display_mode *adjusted_mode)
 {
 	return true;
 }
@@ -680,7 +680,7 @@ static void ast_encoder_dpms(struct drm_
 }
 
 static bool ast_mode_fixup(struct drm_encoder *encoder,
-			   struct drm_display_mode *mode,
+			   const struct drm_display_mode *mode,
 			   struct drm_display_mode *adjusted_mode)
 {
 	return true;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/cirrus/cirrus_mode.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/cirrus/cirrus_mode.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/cirrus/cirrus_mode.c
@@ -97,7 +97,7 @@ static void cirrus_crtc_dpms(struct drm_
  * to just pass that straight through, so this does nothing
  */
 static bool cirrus_crtc_mode_fixup(struct drm_crtc *crtc,
-				   struct drm_display_mode *mode,
+				   const struct drm_display_mode *mode,
 				   struct drm_display_mode *adjusted_mode)
 {
 	return true;
@@ -429,8 +429,8 @@ void cirrus_crtc_fb_gamma_get(struct drm
 
 
 static bool cirrus_encoder_mode_fixup(struct drm_encoder *encoder,
-				  struct drm_display_mode *mode,
-				  struct drm_display_mode *adjusted_mode)
+				      const struct drm_display_mode *mode,
+				      struct drm_display_mode *adjusted_mode)
 {
 	return true;
 }
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/ch7006_drv.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i2c/ch7006_drv.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/ch7006_drv.c
@@ -88,7 +88,7 @@ static void ch7006_encoder_restore(struc
 }
 
 static bool ch7006_encoder_mode_fixup(struct drm_encoder *encoder,
-				      struct drm_display_mode *mode,
+				      const struct drm_display_mode *mode,
 				      struct drm_display_mode *adjusted_mode)
 {
 	struct ch7006_priv *priv = to_ch7006_priv(encoder);
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/ch7006_mode.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i2c/ch7006_mode.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/ch7006_mode.c
@@ -172,7 +172,7 @@ struct ch7006_mode ch7006_modes[] = {
 };
 
 struct ch7006_mode *ch7006_lookup_mode(struct drm_encoder *encoder,
-				       struct drm_display_mode *drm_mode)
+				       const struct drm_display_mode *drm_mode)
 {
 	struct ch7006_priv *priv = to_ch7006_priv(encoder);
 	struct ch7006_mode *mode;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/ch7006_priv.h
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i2c/ch7006_priv.h
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/ch7006_priv.h
@@ -111,7 +111,7 @@ extern struct ch7006_tv_norm_info ch7006
 extern struct ch7006_mode ch7006_modes[];
 
 struct ch7006_mode *ch7006_lookup_mode(struct drm_encoder *encoder,
-				       struct drm_display_mode *drm_mode);
+				       const struct drm_display_mode *drm_mode);
 
 void ch7006_setup_levels(struct drm_encoder *encoder);
 void ch7006_setup_subcarrier(struct drm_encoder *encoder);
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/sil164_drv.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i2c/sil164_drv.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/sil164_drv.c
@@ -254,7 +254,7 @@ sil164_encoder_restore(struct drm_encode
 
 static bool
 sil164_encoder_mode_fixup(struct drm_encoder *encoder,
-			  struct drm_display_mode *mode,
+			  const struct drm_display_mode *mode,
 			  struct drm_display_mode *adjusted_mode)
 {
 	return true;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/dvo.h
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/dvo.h
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/dvo.h
@@ -86,7 +86,7 @@ struct intel_dvo_dev_ops {
 	 * buses with clock limitations.
 	 */
 	bool (*mode_fixup)(struct intel_dvo_device *dvo,
-			   struct drm_display_mode *mode,
+			   const struct drm_display_mode *mode,
 			   struct drm_display_mode *adjusted_mode);
 
 	/*
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_crt.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_crt.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_crt.c
@@ -132,7 +132,7 @@ static int intel_crt_mode_valid(struct d
 }
 
 static bool intel_crt_mode_fixup(struct drm_encoder *encoder,
-				 struct drm_display_mode *mode,
+				 const struct drm_display_mode *mode,
 				 struct drm_display_mode *adjusted_mode)
 {
 	return true;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_dp.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_dp.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_dp.c
@@ -704,7 +704,8 @@ intel_dp_i2c_init(struct intel_dp *intel
 }
 
 static bool
-intel_dp_mode_fixup(struct drm_encoder *encoder, struct drm_display_mode *mode,
+intel_dp_mode_fixup(struct drm_encoder *encoder,
+		    const struct drm_display_mode *mode,
 		    struct drm_display_mode *adjusted_mode)
 {
 	struct drm_device *dev = encoder->dev;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_dvo.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_dvo.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_dvo.c
@@ -136,7 +136,7 @@ static int intel_dvo_mode_valid(struct d
 }
 
 static bool intel_dvo_mode_fixup(struct drm_encoder *encoder,
-				 struct drm_display_mode *mode,
+				 const struct drm_display_mode *mode,
 				 struct drm_display_mode *adjusted_mode)
 {
 	struct intel_dvo *intel_dvo = enc_to_intel_dvo(encoder);
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_hdmi.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_hdmi.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_hdmi.c
@@ -685,7 +685,7 @@ static int intel_hdmi_mode_valid(struct
 }
 
 static bool intel_hdmi_mode_fixup(struct drm_encoder *encoder,
-				  struct drm_display_mode *mode,
+				  const struct drm_display_mode *mode,
 				  struct drm_display_mode *adjusted_mode)
 {
 	return true;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_lvds.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_lvds.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_lvds.c
@@ -229,7 +229,7 @@ static inline u32 panel_fitter_scaling(u
 }
 
 static bool intel_lvds_mode_fixup(struct drm_encoder *encoder,
-				  struct drm_display_mode *mode,
+				  const struct drm_display_mode *mode,
 				  struct drm_display_mode *adjusted_mode)
 {
 	struct drm_device *dev = encoder->dev;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_sdvo.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_sdvo.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_sdvo.c
@@ -956,7 +956,7 @@ static bool intel_sdvo_set_tv_format(str
 
 static bool
 intel_sdvo_set_output_timings_from_mode(struct intel_sdvo *intel_sdvo,
-					struct drm_display_mode *mode)
+					const struct drm_display_mode *mode)
 {
 	struct intel_sdvo_dtd output_dtd;
 
@@ -975,7 +975,7 @@ intel_sdvo_set_output_timings_from_mode(
  * Unfortunately we have to set up the full output mode to do that. */
 static bool
 intel_sdvo_get_preferred_input_mode(struct intel_sdvo *intel_sdvo,
-				    struct drm_display_mode *mode,
+				    const struct drm_display_mode *mode,
 				    struct drm_display_mode *adjusted_mode)
 {
 	struct intel_sdvo_dtd input_dtd;
@@ -1000,7 +1000,7 @@ intel_sdvo_get_preferred_input_mode(stru
 }
 
 static bool intel_sdvo_mode_fixup(struct drm_encoder *encoder,
-				  struct drm_display_mode *mode,
+				  const struct drm_display_mode *mode,
 				  struct drm_display_mode *adjusted_mode)
 {
 	struct intel_sdvo *intel_sdvo = to_intel_sdvo(encoder);
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_tv.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/intel_tv.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/intel_tv.c
@@ -891,7 +891,8 @@ intel_tv_mode_valid(struct drm_connector
 
 
 static bool
-intel_tv_mode_fixup(struct drm_encoder *encoder, struct drm_display_mode *mode,
+intel_tv_mode_fixup(struct drm_encoder *encoder,
+		    const struct drm_display_mode *mode,
 		    struct drm_display_mode *adjusted_mode)
 {
 	struct drm_device *dev = encoder->dev;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/mgag200/mgag200_mode.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/mgag200/mgag200_mode.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/mgag200/mgag200_mode.c
@@ -78,8 +78,8 @@ static inline void mga_wait_busy(struct
  * to just pass that straight through, so this does nothing
  */
 static bool mga_crtc_mode_fixup(struct drm_crtc *crtc,
-				   struct drm_display_mode *mode,
-				   struct drm_display_mode *adjusted_mode)
+				const struct drm_display_mode *mode,
+				struct drm_display_mode *adjusted_mode)
 {
 	return true;
 }
@@ -1322,8 +1322,8 @@ void mga_crtc_fb_gamma_get(struct drm_cr
  * to handle any encoder-specific limitations
  */
 static bool mga_encoder_mode_fixup(struct drm_encoder *encoder,
-				  struct drm_display_mode *mode,
-				  struct drm_display_mode *adjusted_mode)
+				   const struct drm_display_mode *mode,
+				   struct drm_display_mode *adjusted_mode)
 {
 	return true;
 }
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/atombios_crtc.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/atombios_crtc.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/atombios_crtc.c
@@ -1624,7 +1624,7 @@ int atombios_crtc_mode_set(struct drm_cr
 }
 
 static bool atombios_crtc_mode_fixup(struct drm_crtc *crtc,
-				     struct drm_display_mode *mode,
+				     const struct drm_display_mode *mode,
 				     struct drm_display_mode *adjusted_mode)
 {
 	if (!radeon_crtc_scaling_mode_fixup(crtc, mode, adjusted_mode))
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/atombios_dp.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/atombios_dp.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/atombios_dp.c
@@ -609,7 +609,7 @@ int radeon_dp_get_panel_mode(struct drm_
 }
 
 void radeon_dp_set_link_config(struct drm_connector *connector,
-			       struct drm_display_mode *mode)
+			       const struct drm_display_mode *mode)
 {
 	struct radeon_connector *radeon_connector = to_radeon_connector(connector);
 	struct radeon_connector_atom_dig *dig_connector;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/atombios_encoders.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/atombios_encoders.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/atombios_encoders.c
@@ -58,7 +58,7 @@ static inline bool radeon_encoder_is_dig
 }
 
 static bool radeon_atom_mode_fixup(struct drm_encoder *encoder,
-				   struct drm_display_mode *mode,
+				   const struct drm_display_mode *mode,
 				   struct drm_display_mode *adjusted_mode)
 {
 	struct radeon_encoder *radeon_encoder = to_radeon_encoder(encoder);
@@ -2234,7 +2234,7 @@ radeon_atom_ext_dpms(struct drm_encoder
 }
 
 static bool radeon_atom_ext_mode_fixup(struct drm_encoder *encoder,
-				       struct drm_display_mode *mode,
+				       const struct drm_display_mode *mode,
 				       struct drm_display_mode *adjusted_mode)
 {
 	return true;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_display.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/radeon_display.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_display.c
@@ -1401,7 +1401,7 @@ void radeon_modeset_fini(struct radeon_d
 	radeon_i2c_fini(rdev);
 }
 
-static bool is_hdtv_mode(struct drm_display_mode *mode)
+static bool is_hdtv_mode(const struct drm_display_mode *mode)
 {
 	/* try and guess if this is a tv or a monitor */
 	if ((mode->vdisplay == 480 && mode->hdisplay == 720) || /* 480p */
@@ -1414,7 +1414,7 @@ static bool is_hdtv_mode(struct drm_disp
 }
 
 bool radeon_crtc_scaling_mode_fixup(struct drm_crtc *crtc,
-				struct drm_display_mode *mode,
+				const struct drm_display_mode *mode,
 				struct drm_display_mode *adjusted_mode)
 {
 	struct drm_device *dev = crtc->dev;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_legacy_crtc.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/radeon_legacy_crtc.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_legacy_crtc.c
@@ -1001,7 +1001,7 @@ static void radeon_set_pll(struct drm_cr
 }
 
 static bool radeon_crtc_mode_fixup(struct drm_crtc *crtc,
-				   struct drm_display_mode *mode,
+				   const struct drm_display_mode *mode,
 				   struct drm_display_mode *adjusted_mode)
 {
 	if (!radeon_crtc_scaling_mode_fixup(crtc, mode, adjusted_mode))
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_legacy_encoders.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/radeon_legacy_encoders.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_legacy_encoders.c
@@ -244,7 +244,7 @@ static void radeon_legacy_lvds_mode_set(
 }
 
 static bool radeon_legacy_mode_fixup(struct drm_encoder *encoder,
-				     struct drm_display_mode *mode,
+				     const struct drm_display_mode *mode,
 				     struct drm_display_mode *adjusted_mode)
 {
 	struct radeon_encoder *radeon_encoder = to_radeon_encoder(encoder);
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_mode.h
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/radeon_mode.h
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/radeon_mode.h
@@ -488,7 +488,7 @@ extern void radeon_connector_hotplug(str
 extern int radeon_dp_mode_valid_helper(struct drm_connector *connector,
 				       struct drm_display_mode *mode);
 extern void radeon_dp_set_link_config(struct drm_connector *connector,
-				      struct drm_display_mode *mode);
+				      const struct drm_display_mode *mode);
 extern void radeon_dp_link_train(struct drm_encoder *encoder,
 				 struct drm_connector *connector);
 extern bool radeon_dp_needs_link_train(struct radeon_connector *radeon_connector);
@@ -678,7 +678,7 @@ void radeon_enc_destroy(struct drm_encod
 void radeon_copy_fb(struct drm_device *dev, struct drm_gem_object *dst_obj);
 void radeon_combios_asic_init(struct drm_device *dev);
 bool radeon_crtc_scaling_mode_fixup(struct drm_crtc *crtc,
-					struct drm_display_mode *mode,
+					const struct drm_display_mode *mode,
 					struct drm_display_mode *adjusted_mode);
 void radeon_panel_mode_fixup(struct drm_encoder *encoder,
 			     struct drm_display_mode *adjusted_mode);
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/udl/udl_encoder.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/udl/udl_encoder.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/udl/udl_encoder.c
@@ -27,7 +27,7 @@ static void udl_encoder_disable(struct d
 }
 
 static bool udl_mode_fixup(struct drm_encoder *encoder,
-			   struct drm_display_mode *mode,
+			   const struct drm_display_mode *mode,
 			   struct drm_display_mode *adjusted_mode)
 {
 	return true;
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/udl/udl_modeset.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/udl/udl_modeset.c
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/udl/udl_modeset.c
@@ -251,7 +251,7 @@ static void udl_crtc_dpms(struct drm_crt
 }
 
 static bool udl_crtc_mode_fixup(struct drm_crtc *crtc,
-				  struct drm_display_mode *mode,
+				  const struct drm_display_mode *mode,
 				  struct drm_display_mode *adjusted_mode)
 
 {
Index: linux-3.0-SLE11-SP3/include/drm/drm_crtc_helper.h
===================================================================
--- linux-3.0-SLE11-SP3.orig/include/drm/drm_crtc_helper.h
+++ linux-3.0-SLE11-SP3/include/drm/drm_crtc_helper.h
@@ -62,7 +62,7 @@ struct drm_crtc_helper_funcs {
 
 	/* Provider can fixup or change mode timings before modeset occurs */
 	bool (*mode_fixup)(struct drm_crtc *crtc,
-			   struct drm_display_mode *mode,
+			   const struct drm_display_mode *mode,
 			   struct drm_display_mode *adjusted_mode);
 	/* Actually set the mode */
 	int (*mode_set)(struct drm_crtc *crtc, struct drm_display_mode *mode,
@@ -96,7 +96,7 @@ struct drm_encoder_helper_funcs {
 	void (*restore)(struct drm_encoder *encoder);
 
 	bool (*mode_fixup)(struct drm_encoder *encoder,
-			   struct drm_display_mode *mode,
+			   const struct drm_display_mode *mode,
 			   struct drm_display_mode *adjusted_mode);
 	void (*prepare)(struct drm_encoder *encoder);
 	void (*commit)(struct drm_encoder *encoder);
Index: linux-3.0-SLE11-SP3/include/drm/drm_encoder_slave.h
===================================================================
--- linux-3.0-SLE11-SP3.orig/include/drm/drm_encoder_slave.h
+++ linux-3.0-SLE11-SP3/include/drm/drm_encoder_slave.h
@@ -54,7 +54,7 @@ struct drm_encoder_slave_funcs {
 	void (*save)(struct drm_encoder *encoder);
 	void (*restore)(struct drm_encoder *encoder);
 	bool (*mode_fixup)(struct drm_encoder *encoder,
-			   struct drm_display_mode *mode,
+			   const struct drm_display_mode *mode,
 			   struct drm_display_mode *adjusted_mode);
 	int (*mode_valid)(struct drm_encoder *encoder,
 			  struct drm_display_mode *mode);
