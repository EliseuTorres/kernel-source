From: Takashi Iwai <tiwai@suse.de>
Patch-mainline: never
Subject: makefile: include fixes

Compatibility patch taken from SUSE:SLE-11-SP3:GA/drm.

Acked-by: Michal Srb <msrb@suse.com>
---
 drivers/gpu/drm/Makefile        |    3 +++
 drivers/gpu/drm/i810/Makefile   |    1 +
 drivers/gpu/drm/i915/Makefile   |    2 ++
 drivers/gpu/drm/radeon/Makefile |    1 +
 drivers/gpu/drm/ttm/Makefile    |    2 ++
 5 files changed, 9 insertions(+)

Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 
 drm-y       :=	drm_auth.o drm_buffer.o drm_bufs.o drm_cache.o \
 		drm_context.o drm_dma.o \
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i810/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i810/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i810/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 i810-y := i810_drv.o i810_dma.o
 
 obj-$(CONFIG_DRM_I810)	+= i810.o
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i915/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i915/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 i915-y := i915_drv.o i915_dma.o i915_irq.o \
 	  i915_debugfs.o \
           i915_suspend.o \
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/ttm/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/ttm/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/ttm/Makefile
@@ -1,7 +1,7 @@
 #
 # Makefile for the drm device driver.  This driver provides support for the
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 ttm-y := ttm_agp_backend.o ttm_memory.o ttm_tt.o ttm_bo.o \
 	ttm_bo_util.o ttm_bo_vm.o ttm_module.o \
 	ttm_object.o ttm_lock.o ttm_execbuf_util.o ttm_page_alloc.o \
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/radeon/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/radeon/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 
 hostprogs-y := mkregtable
 clean-files := rn50_reg_safe.h r100_reg_safe.h r200_reg_safe.h rv515_reg_safe.h r300_reg_safe.h r420_reg_safe.h rs600_reg_safe.h r600_reg_safe.h evergreen_reg_safe.h cayman_reg_safe.h
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/cirrus/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/cirrus/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/cirrus/Makefile
@@ -1,4 +1,4 @@
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 cirrus-y  := cirrus_main.o cirrus_mode.o \
 	cirrus_drv.o cirrus_fbdev.o cirrus_ttm.o
 
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/i2c/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/i2c/Makefile
@@ -1,4 +1,4 @@
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 
 ch7006-y := ch7006_drv.o ch7006_mode.o
 obj-$(CONFIG_DRM_I2C_CH7006) += ch7006.o
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/ast/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/ast/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/ast/Makefile
@@ -2,8 +2,8 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 
 ast-y := ast_drv.o ast_main.o ast_mode.o ast_fb.o ast_ttm.o ast_post.o
 
-obj-$(CONFIG_DRM_AST) := ast.o
\ No newline at end of file
+obj-$(CONFIG_DRM_AST) := ast.o
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/exynos/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/exynos/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/exynos/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm -Idrivers/gpu/drm/exynos
+ccflags-y := -Iinclude -Iinclude/drm -Idrivers/gpu/drm/exynos -Iinclude/uapi -Iinclude/uapi/drm
 exynosdrm-y := exynos_drm_drv.o exynos_drm_encoder.o exynos_drm_connector.o \
 		exynos_drm_crtc.o exynos_drm_fbdev.o exynos_drm_fb.o \
 		exynos_drm_buf.o exynos_drm_gem.o exynos_drm_core.o \
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/mga/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/mga/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/mga/Makefile
@@ -2,10 +2,9 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 mga-y := mga_drv.o mga_dma.o mga_state.o mga_warp.o mga_irq.o
 
 mga-$(CONFIG_COMPAT) += mga_ioc32.o
 
 obj-$(CONFIG_DRM_MGA)	+= mga.o
-
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/mgag200/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/mgag200/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/mgag200/Makefile
@@ -1,4 +1,4 @@
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 mgag200-y   := mgag200_main.o mgag200_mode.o \
 	mgag200_drv.o mgag200_fb.o mgag200_i2c.o mgag200_ttm.o
 
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/nouveau/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/nouveau/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/nouveau/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 ccflags-y += -I$(src)/core/include
 ccflags-y += -I$(src)/core
 ccflags-y += -I$(src)
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/r128/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/r128/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/r128/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 r128-y   := r128_drv.o r128_cce.o r128_state.o r128_irq.o
 
 r128-$(CONFIG_COMPAT)   += r128_ioc32.o
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/savage/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/savage/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/savage/Makefile
@@ -2,8 +2,7 @@
 # Makefile for the drm device driver.  This driver provides support for the
 # Direct Rendering Infrastructure (DRI) in XFree86 4.1.0 and higher.
 
-ccflags-y = -Iinclude/drm
+ccflags-y = -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 savage-y := savage_drv.o savage_bci.o savage_state.o
 
 obj-$(CONFIG_DRM_SAVAGE)+= savage.o
-
Index: linux-3.0-SLE11-SP3/drivers/gpu/drm/vmwgfx/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/gpu/drm/vmwgfx/Makefile
+++ linux-3.0-SLE11-SP3/drivers/gpu/drm/vmwgfx/Makefile
@@ -1,5 +1,5 @@
 
-ccflags-y := -Iinclude/drm
+ccflags-y := -Iinclude -Iinclude/drm -Iinclude/uapi -Iinclude/uapi/drm
 
 vmwgfx-y := vmwgfx_execbuf.o vmwgfx_gmr.o vmwgfx_kms.o vmwgfx_drv.o \
 	    vmwgfx_fb.o vmwgfx_ioctl.o vmwgfx_resource.o vmwgfx_buffer.o \
Index: linux-3.0-SLE11-SP3/Makefile
===================================================================
--- linux-3.0-SLE11-SP3.orig/Makefile
+++ linux-3.0-SLE11-SP3/Makefile
@@ -375,7 +375,8 @@ CFLAGS_GCOV	= -fprofile-arcs -ftest-cove
 LINUXINCLUDE    := -I$(srctree)/arch/$(hdr-arch)/include \
                    -Iarch/$(hdr-arch)/include/generated -Iinclude \
                    $(if $(KBUILD_SRC), -I$(srctree)/include) \
-                   -include include/generated/autoconf.h
+                   -include include/generated/autoconf.h \
+		   -I$(srctree)/include/uapi
 
 KBUILD_CPPFLAGS := -D__KERNEL__
 
