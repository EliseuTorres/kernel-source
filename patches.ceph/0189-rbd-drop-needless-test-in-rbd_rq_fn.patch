From 37c4477c8454e6fd15cd59d36952ddb1c64a08db Mon Sep 17 00:00:00 2001
From: Alex Elder <elder@inktank.com>
Date: Thu, 9 Aug 2012 10:33:25 -0700
Subject: [PATCH 189/938] rbd: drop needless test in rbd_rq_fn()
Patch-mainline: 3.10-rc2
References: fate#312983

There's a test for null rq pointer inside the while loop in
rbd_rq_fn() that's not needed.  That same test already occurred
in the immediatly preceding loop condition test.

Signed-off-by: Alex Elder <elder@inktank.com>
Reviewed-by: Yehuda Sadeh <yehuda@inktank.com>
Acked-by: Danny Al-Gaaf <dalgaaf@suse.de>

---
 drivers/block/rbd.c | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/drivers/block/rbd.c b/drivers/block/rbd.c
index 43f6ef8..3475bb2 100644
--- a/drivers/block/rbd.c
+++ b/drivers/block/rbd.c
@@ -1475,10 +1475,6 @@ static void rbd_rq_fn(struct request_queue *q)
 		struct rbd_req_coll *coll;
 		struct ceph_snap_context *snapc;
 
-		/* peek at request from block layer */
-		if (!rq)
-			break;
-
 		dout("fetched request\n");
 
 		/* filter out block requests we don't understand */
-- 
1.8.3

