From: Miklos Szeredi <mszeredi@suse.cz>
Subject: kabi: fix for move of d_rcu
Patch-mainline: no
References: bnc#903640 CVE-2014-8559

d_rcu shouldn't be used outside core VFS.  The size and offset of the other
fields doesn't change.   So it's OK to ignore this move.

Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
---
 include/linux/dcache.h |    7 +++++++
 1 file changed, 7 insertions(+)

--- a/include/linux/dcache.h
+++ b/include/linux/dcache.h
@@ -140,8 +140,14 @@ struct dentry {
 	struct list_head d_lru;		/* LRU list */
 	union {
 		struct list_head d_child;	/* child of parent list */
+#ifdef __GENKSYMS__
+	 	struct rcu_head d_rcu;
+#endif
 	} d_u;
 	struct list_head d_subdirs;	/* our children */
+#ifdef __GENKSYMS__
+	struct list_head d_alias;
+#else
 	/*
 	 * d_alias and d_rcu can share memory
 	 */
@@ -149,6 +155,7 @@ struct dentry {
 		struct list_head d_alias;	/* inode alias list */
 	 	struct rcu_head d_rcu;
 	};
+#endif
 };
 
 #define d_lock	d_lockref.lock
