Subject: MM: guard struct vm_area_struct kABI changes
From: Jiri Slaby <jslaby@suse.cz>
Patch-mainline: never
References: bnc#676419

Silence kABI checker. The structure should not be embed anywhere (it
makes no sense) and must be allocated in the core.

So move the vm_prev to the end of the structure and protect against
kabi checker.

This was introduced by 378776c2 in the stable tree which is 297c5eee3
upstream.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 include/linux/mm_types.h |    5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

--- a/include/linux/mm_types.h
+++ b/include/linux/mm_types.h
@@ -140,7 +140,7 @@ struct vm_area_struct {
 					   within vm_mm. */
 
 	/* linked list of VM areas per task, sorted by address */
-	struct vm_area_struct *vm_next, *vm_prev;
+	struct vm_area_struct *vm_next;
 
 	pgprot_t vm_page_prot;		/* Access permissions of this VMA. */
 	unsigned long vm_flags;		/* Flags, see mm.h. */
@@ -188,6 +188,9 @@ struct vm_area_struct {
 #ifdef CONFIG_NUMA
 	struct mempolicy *vm_policy;	/* NUMA policy for the VMA */
 #endif
+#ifndef __GENKSYMS__
+	struct vm_area_struct *vm_prev;
+#endif
 };
 
 struct core_thread {
