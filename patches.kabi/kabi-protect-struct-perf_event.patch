From: Jiri Slaby <jslaby@suse.cz>
Subject: kABI: protect struct perf_event
Patch-mainline: never, kabi

In 3.0.44, commit 71f08eb07187bb (perf_event: Switch to internal refcount, fix
race with close()), upstream commit a6fa941d94b411bbd2, changed
sched_task_group filp to refcount in struct perf_event. It indeed changed
layout of that structure.

Let's just ignore that since pointer and atomic_long_t have the same
size for architectures we care about.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 include/linux/perf_event.h |    4 ++++
 1 file changed, 4 insertions(+)

--- a/include/linux/perf_event.h
+++ b/include/linux/perf_event.h
@@ -925,7 +925,11 @@ struct perf_event {
 	struct hw_perf_event		hw;
 
 	struct perf_event_context	*ctx;
+#ifdef __GENKSYMS__
+	struct file			*filp;
+#else
 	atomic_long_t			refcount;
+#endif
 
 	/*
 	 * These accumulate total time (in nanoseconds) that children
