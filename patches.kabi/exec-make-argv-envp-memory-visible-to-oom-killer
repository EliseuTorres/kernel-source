From: Jeff Mahoney <jeffm@suse.com>
Subject: KABI: exec: make argv/envp memory visible to oom-killer
Patch-mainline: Never

 This patch moves vma_pages to end of the struct for kABI compatibility.

 The only instance I've seen of a statically allocated linux_binprm is
 for the mmu-less code.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 include/linux/binfmts.h |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/include/linux/binfmts.h
+++ b/include/linux/binfmts.h
@@ -29,7 +29,6 @@ struct linux_binprm{
 	char buf[BINPRM_BUF_SIZE];
 #ifdef CONFIG_MMU
 	struct vm_area_struct *vma;
-	unsigned long vma_pages;
 #else
 # define MAX_ARG_PAGES	32
 	struct page *page[MAX_ARG_PAGES];
@@ -58,6 +57,11 @@ struct linux_binprm{
 	unsigned interp_flags;
 	unsigned interp_data;
 	unsigned long loader, exec;
+#ifndef __GENKSYMS__
+#ifdef CONFIG_MMU
+	unsigned long vma_pages;
+#endif
+#endif
 };
 
 extern void acct_arg_size(struct linux_binprm *bprm, unsigned long pages);
