From: Jiri Slaby <jslaby@suse.cz>
Subject: kABI: protect struct mmc_host
Patch-mainline: never

In 3.0.32, commit 0d7755e450865b76b98e3fea2e166b0a2266972d (mmc: sdio:
avoid spurious calls to interrupt handlers), upstream commit
bbbc4c4d8c5face097d695f9bf3a39647ba6b7e7, added sdio_irq_pending to
struct mmc_host. It indeed changed layout of that structure.

Let's use an unused member in that structure instead.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 include/linux/mmc/host.h |    5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

--- a/include/linux/mmc/host.h
+++ b/include/linux/mmc/host.h
@@ -227,7 +227,11 @@ struct mmc_host {
 	/* host specific block data */
 	unsigned int		max_seg_size;	/* see blk_queue_max_segment_size */
 	unsigned short		max_segs;	/* see blk_queue_max_segments */
+#ifdef __GENKSYMS__
 	unsigned short		unused;
+#else
+	unsigned short		sdio_irq_pending;
+#endif
 	unsigned int		max_req_size;	/* maximum number of bytes in one req */
 	unsigned int		max_blk_size;	/* maximum size of one mmc block */
 	unsigned int		max_blk_count;	/* maximum number of blocks in one req */
@@ -267,7 +271,6 @@ struct mmc_host {
 
 	unsigned int		sdio_irqs;
 	struct task_struct	*sdio_irq_thread;
-	bool			sdio_irq_pending;
 	atomic_t		sdio_irq_thread_abort;
 
 	mmc_pm_flag_t		pm_flags;	/* requested pm features */
