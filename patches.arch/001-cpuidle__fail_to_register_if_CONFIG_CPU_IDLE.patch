From: Len Brown <len.brown@intel.com>
Subject: cpuidle: fail to register if !CONFIG_CPU_IDLE
References: fate#311818,fate#311942
Patch-Mainline: yes
Git-commit: 5991bb561038bc6b7b0a1dbea741a64e499ae118


Signed-off-by: Thomas Renninger <trenn@suse.de>

upstream: 6b2c676bf32be91f43215d5874c07c1becaba013

Signed-off-by: Len Brown <len.brown@intel.com>

diff --git a/include/linux/cpuidle.h b/include/linux/cpuidle.h
index dcf77fa..f5e6480 100644
--- a/include/linux/cpuidle.h
+++ b/include/linux/cpuidle.h
@@ -137,16 +137,16 @@ extern void cpuidle_disable_device(struct cpuidle_device *dev);
 #else
 
 static inline int cpuidle_register_driver(struct cpuidle_driver *drv)
-{return 0;}
+{return -ENODEV; }
 static inline void cpuidle_unregister_driver(struct cpuidle_driver *drv) { }
 static inline int cpuidle_register_device(struct cpuidle_device *dev)
-{return 0;}
+{return -ENODEV; }
 static inline void cpuidle_unregister_device(struct cpuidle_device *dev) { }
 
 static inline void cpuidle_pause_and_lock(void) { }
 static inline void cpuidle_resume_and_unlock(void) { }
 static inline int cpuidle_enable_device(struct cpuidle_device *dev)
-{return 0;}
+{return -ENODEV; }
 static inline void cpuidle_disable_device(struct cpuidle_device *dev) { }
 
 #endif
