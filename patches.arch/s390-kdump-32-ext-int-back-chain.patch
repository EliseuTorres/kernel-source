From: Michael Holzheu <holzheu@linux.vnet.ibm.com>
Subject: s390: initialize backchain for ext_int_handler()
Date:   Wed May 9 16:27:35 2012 +0200
Patch-mainline: v3.5-rc1
Git-commit: 0de9db37f0dff3bda21b3650ba60a21d3fe70df2
References: bnc#786472,ltc#82694,fate#314077
    
To allow correct stack backtraces the backchain for the external
interrupt handler is now initialized with zero like it is already
done for example by io_int_handler().

Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com>
Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
Acked-by: John L. Jolly <jjolly@suse.de>

---
 arch/s390/kernel/entry64.S |    1 +
 1 file changed, 1 insertion(+)

--- a/arch/s390/kernel/entry64.S
+++ b/arch/s390/kernel/entry64.S
@@ -723,6 +723,7 @@ ext_int_handler:
 ext_no_vtime:
 	HANDLE_SIE_INTERCEPT
 	TRACE_IRQS_OFF
+	xc	__SF_BACKCHAIN(8,%r15),__SF_BACKCHAIN(%r15)
 	lghi	%r1,4096
 	la	%r2,SP_PTREGS(%r15)	# address of register-save area
 	llgf	%r3,__LC_CPU_ADDRESS	# get cpu address + interruption code
