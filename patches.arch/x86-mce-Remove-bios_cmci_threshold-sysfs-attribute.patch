From: Borislav Petkov <borislav.petkov@amd.com>
Subject: x86, MCE: Remove bios_cmci_threshold sysfs attribute
Git-commit: 5bc66170dc486556a1e36fd384463536573f4b82
Patch-mainline: v3.7-rc2

450cc201038f3 ("x86/mce: Provide boot argument to honour bios-set CMCI
threshold") added the bios_cmci_threshold sysfs attribute which was
supposed to communicate to userspace tools that BIOS CMCI threshold has
been honoured.

However, this info is not of any importance to userspace - it should
rather get the actual error count it has been thresholded already from
MCi_STATUS[38:52].

So drop this before it becomes a used interface (good thing we caught
this early in 3.7-rc1, right after the merge window closed).

Cc: Naveen N. Rao <naveen.n.rao@linux.vnet.ibm.com>
Acked-by: Tony Luck <tony.luck@intel.com>
Link: http://lkml.kernel.org/r/20121017105940.GA14590@x1.osrc.amd.com
Signed-off-by: Borislav Petkov <borislav.petkov@amd.com>

Signed-off-by: Thomas Renninger <trenn@suse.de>
---
 arch/x86/kernel/cpu/mcheck/mce.c |    6 ------
 1 file changed, 6 deletions(-)

Index: linux-3.0-SLE11-SP3/arch/x86/kernel/cpu/mcheck/mce.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/arch/x86/kernel/cpu/mcheck/mce.c
+++ linux-3.0-SLE11-SP3/arch/x86/kernel/cpu/mcheck/mce.c
@@ -2133,11 +2133,6 @@ static struct sysdev_ext_attribute attr_
 	&mce_cmci_disabled
 };
 
-static struct sysdev_ext_attribute attr_bios_cmci_threshold = {
-	_SYSDEV_ATTR(bios_cmci_threshold, 0444, sysdev_show_int, NULL),
-	&mce_bios_cmci_threshold
-};
-
 static struct sysdev_attribute *mce_attrs[] = {
 	&attr_tolerant.attr,
 	&attr_check_interval.attr,
@@ -2146,7 +2141,6 @@ static struct sysdev_attribute *mce_attr
 	&attr_dont_log_ce.attr,
 	&attr_ignore_ce.attr,
 	&attr_cmci_disabled.attr,
-	&attr_bios_cmci_threshold.attr,
 	NULL
 };
 
