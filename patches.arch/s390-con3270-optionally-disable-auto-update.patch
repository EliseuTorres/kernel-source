From: Hannes Reinecke <hare@suse.de>
Date: Fri, 14 Mar 2014 12:21:08 +0100
Subject: [PATCH] con3270: optionally disable auto update
References: bnc#868409
Patch-Mainline: not yet

This patch adds a parameter 'auto_update' to the con3270
driver, causing the 'auto_update' feature to be disabled
if unset.
The 'auto_update' feature will cause the con3270 driver
to switch to the console view whenever new system messages
are display, which makes working on the 3270 terminal
awkward.

Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 drivers/s390/char/con3270.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/drivers/s390/char/con3270.c b/drivers/s390/char/con3270.c
index 699fd3e..80bc76e 100644
--- a/drivers/s390/char/con3270.c
+++ b/drivers/s390/char/con3270.c
@@ -30,6 +30,9 @@
 
 static struct raw3270_fn con3270_fn;
 
+static int auto_update = 1;
+module_param(auto_update, bool, 0);
+
 /*
  * Main 3270 console view data structure.
  */
@@ -379,6 +382,9 @@ con3270_activate(struct raw3270_view *view)
 {
 	struct con3270 *cp;
 
+	if (!auto_update)
+		return 0;
+
 	cp = (struct con3270 *) view;
 	cp->update_flags = CON_UPDATE_ALL;
 	con3270_set_timer(cp, 1);
-- 
1.7.12.4

