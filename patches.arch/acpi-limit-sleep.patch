From: Alexey Starikovskiy <astarikovskiy@suse.de>
Subject: [ACPI] Add constraints on usage of ACPI Sleep function
Patch-mainline: Never, fixed differently in commit 9cbfa18e8a7b34a32eddbd914a07f085962f50a8

    
    Panasonic Toughbook CF-52 may use uninitialized variable as argument
    to Sleep(), thus stopping init sequence for about 45 days (0xf0000def ms).
    Add constraints to not sleep that long, and also to not sleep during init.
    
    References: http://bugzilla.novell.com/show_bug.cgi?id=557710
    	    http://bugzilla.kernel.org/show_bug.cgi?id=13195
Signed-off-by: Alexey Starikovskiy <astarikovskiy@suse.de>

Index: linux-2.6.32-SLE11-SP1/drivers/acpi/osl.c
===================================================================
--- linux-2.6.32-SLE11-SP1.orig/drivers/acpi/osl.c	2010-06-25 03:49:28.662599639 +0400
+++ linux-2.6.32-SLE11-SP1/drivers/acpi/osl.c	2010-06-25 03:49:39.463608859 +0400
@@ -438,7 +438,15 @@
 
 void acpi_os_sleep(acpi_integer ms)
 {
-	schedule_timeout_interruptible(msecs_to_jiffies(ms));
+	if (ms > 1000) {
+		printk(KERN_WARNING FW_BUG
+			"ACPI: Limit %lld sleep to 1 second\n", ms);
+		ms = 1000;
+	}
+	if (system_state == SYSTEM_RUNNING)
+		schedule_timeout_interruptible(msecs_to_jiffies(ms));
+	else
+		acpi_os_stall(ms * 1000);
 }
 
 void acpi_os_stall(u32 us)
