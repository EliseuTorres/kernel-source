From: Gerald Schaefer <geraldsc@de.ibm.com>
Subject: kernel: warning when accessing /proc/cpuinfo
Patch-mainline: yes
References: bnc#717840,LTC#75096

Symptom:     The kernel prints a warning when /proc/cpuinfo is accessed if
             the system has been started with a cpu limit via the maxcpus
             kernel parameter.
Problem:     The show_cpuinfo code uses NR_CPUS instead of nr_cpus_ids as
             limit for the maximum cpu number. Calling the cpu_online
             function with a cpu number > nr_cpus_ids will trigger a waring
             in cpumask_check if the DEBUG_PER_CPUS_MAPS options is enabled.
Solution:    Use nr_cpus_ids instead of NR_CPUS in the show_cpuinfo code.

Acked-by: John Jolly <jjolly@suse.de>

---
 arch/s390/kernel/processor.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/arch/s390/kernel/processor.c
+++ b/arch/s390/kernel/processor.c
@@ -74,7 +74,7 @@ static int show_cpuinfo(struct seq_file
 
 static void *c_start(struct seq_file *m, loff_t *pos)
 {
-	return *pos < NR_CPUS ? (void *)((unsigned long) *pos + 1) : NULL;
+	return *pos < nr_cpu_ids ? (void *)((unsigned long) *pos + 1) : NULL;
 }
 
 static void *c_next(struct seq_file *m, void *v, loff_t *pos)
