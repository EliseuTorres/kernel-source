From: Jack Steiner <steiner@sgi.com>
Subject: x86 / UV: Fix bug in uv_global_gru_mmr_address macro
References: bnc#579636, FATE#306952
Patch-mainline: not yet

Fix bug in uv_global_gru_mmr_address macro.  Macro failed
to cast an int value to long prior to a left shift > 32.

Signed-off-by: Jack Steiner <steiner@sgi.com>
Signed-off-by: Rafael J. Wysocki <rjw@suse.de>
---
 arch/x86/include/asm/uv/uv_hub.h |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

Index: linux-2.6.32-SLE11-SP1/arch/x86/include/asm/uv/uv_hub.h
===================================================================
--- linux-2.6.32-SLE11-SP1.orig/arch/x86/include/asm/uv/uv_hub.h
+++ linux-2.6.32-SLE11-SP1/arch/x86/include/asm/uv/uv_hub.h
@@ -339,7 +339,8 @@ static inline unsigned char uv_read_glob
  */
 static inline unsigned long uv_global_gru_mmr_address(int pnode, unsigned long offset)
 {
-	return UV_GLOBAL_GRU_MMR_BASE | offset | (pnode << uv_hub_info->m_val);
+	return UV_GLOBAL_GRU_MMR_BASE | offset |
+		((unsigned long)pnode << uv_hub_info->m_val);
 }
 
 /*
