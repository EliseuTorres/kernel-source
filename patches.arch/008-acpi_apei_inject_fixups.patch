From: Chen Gong <gong.chen@linux.intel.com>
Subject: ACPI, APEI, EINJ, limit the range of einj_param
References: bnc#788160
Patch-Mainline: v3.4-rc6
Git-commit: 185210cc754754c2504afcef9d1c9cd4b8761a9c


Signed-off-by: Thomas Renninger <trenn@suse.de>

On the platforms with ACPI4.x support, parameter extension
is not always doable, which means only parameter extension
is enabled, einj_param can take effect.

v2->v1: stopping early in einj_get_parameter_address for einj_param

Signed-off-by: Chen Gong <gong.chen@linux.intel.com>
Acked-by: Tony Luck <tony.luck@intel.com>
Signed-off-by: Len Brown <len.brown@intel.com>

---
 drivers/acpi/apei/einj.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: linux-3.0-SLE11-SP3/drivers/acpi/apei/einj.c
===================================================================
--- linux-3.0-SLE11-SP3.orig/drivers/acpi/apei/einj.c
+++ linux-3.0-SLE11-SP3/drivers/acpi/apei/einj.c
@@ -238,7 +238,7 @@ static void *einj_get_parameter_address(
 			return v5param;
 		}
 	}
-	if (paddrv4) {
+	if (param_extension && paddrv4) {
 		struct einj_parameter *v4param;
 
 		v4param = acpi_os_map_memory(paddrv4, sizeof(*v4param));
