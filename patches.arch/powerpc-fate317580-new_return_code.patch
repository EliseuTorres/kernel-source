Subject: powerpc/rtas_flash: New return code to indicate FW entitlement expiry
From: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Patch-mainline: v3.9-rc7-44-gfd2d37c
Git-commit: fd2d37c8547e57e836f912cbb57a556022803891 
References: fate#317580  

Add new return code to rtas_flash to indicate firmware entitlement
expiry. Strictly we don't need this update. But to keep it in sync
with PAPR, this was added.

Signed-off-by: Ananth N Mavinakayanahalli <ananth@in.ibm.com>
Signed-off-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Acked-by: Dinar Valeev <dvaleev@suse.com>

diff --git a/arch/powerpc/kernel/rtas_flash.c b/arch/powerpc/kernel/rtas_flash.c
index bc97a21..a3e4034 100644
--- a/arch/powerpc/kernel/rtas_flash.c
+++ b/arch/powerpc/kernel/rtas_flash.c
@@ -77,6 +77,11 @@
  * T side will be updated with a downlevel image
  */
 #define VALIDATE_TMP_UPDATE_DL 6
+/*
+ * The candidate image's release date is later than the system's firmware
+ * service entitlement date - service warranty period has expired
+ */
+#define VALIDATE_OUT_OF_WRNTY  7

 /* ibm,manage-flash-image operation tokens */
 #define RTAS_REJECT_TMP_IMG   0
--
