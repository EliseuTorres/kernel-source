From: Gerald Schaefer <gerald.schaefer@de.ibm.com>
Subject: appldata: restore missing init_virt_timer()
Patch-mainline: not yet
Git-commit: -
References: bnc#860346,LTC#103493

Description:  appldata: restore missing init_virt_timer()
Symptom:      Kernel panic when disabling a not yet enabled timer.
Problem:      Commit 27f6b416 "s390/vtimer: rework virtual timer interface"
              removed the call to init_virt_timer() by mistake. A subsequent
              call to del_virt_timer() will then panic.
Solution:     Add init_virt_timer() again.
Reproduction: Do "echo 0 > /proc/sys/appldata/timer" before enabling the timer.

Signed-off-by: Gerald Schaefer <gerald.schaefer@de.ibm.com>
Acked-by: John Jolly <jjolly@suse.de>
---
 arch/s390/appldata/appldata_base.c |    1 +
 1 file changed, 1 insertion(+)

--- a/arch/s390/appldata/appldata_base.c
+++ b/arch/s390/appldata/appldata_base.c
@@ -527,6 +527,7 @@ static int __init appldata_init(void)
 {
 	int rc;
 
+	init_virt_timer(&appldata_timer);
 	appldata_timer.function = appldata_timer_function;
 	appldata_timer.data = (unsigned long) &appldata_work;
 
