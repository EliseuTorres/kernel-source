Subject: smsgiucv: reestablish IUCV path after resume
From: Ursula Braun <ursula.braun@de.ibm.com>
Patch-mainline: Submitted
References: bnc#786976,LTC#86245

Symptom:      After resume z/VM CP special messages are no longer delivered
Problem:      smsg_pm_restore_thaw() uses wrong checking before reconnecting
              the IUCV path to *MSG.
Solution:     Use correct checking in smsg_pm_restore_thaw()
Reproduction: Run suspend / resume with configured smsgiucv_app.

Acked-by: John Jolly <jjolly@suse.de>
---
 drivers/s390/net/smsgiucv.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/s390/net/smsgiucv.c
+++ b/drivers/s390/net/smsgiucv.c
@@ -157,7 +157,7 @@ static int smsg_pm_restore_thaw(struct d
 #ifdef CONFIG_PM_DEBUG
 	printk(KERN_WARNING "smsg_pm_restore_thaw\n");
 #endif
-	if (smsg_path && iucv_path_connected) {
+	if (smsg_path && !iucv_path_connected) {
 		memset(smsg_path, 0, sizeof(*smsg_path));
 		smsg_path->msglim = 255;
 		smsg_path->flags = 0;
