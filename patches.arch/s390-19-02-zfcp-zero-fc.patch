From: Gerald Schaefer <geraldsc@de.ibm.com>
Subject: zfcp: Zero memory for gpn_ft and adisc requests
References: bnc#617464,LTC#65466
Patch-mainline: Yes

Symptom:     zfcp sends els adisc or gpn_ft requests with invalid
             values in unused or reserved FC protocol fields.
Problem:     The memory used for these requests has not been
             completely initialized.
Solution:    Zero the memory used for the els adisc and gpn_ft
             requests before filling in the request data.

Acked-by: John Jolly <jjolly@suse.de>
---
 drivers/s390/scsi/zfcp_fc.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/drivers/s390/scsi/zfcp_fc.c	2010-06-25 11:19:40.000000000 +0200
+++ b/drivers/s390/scsi/zfcp_fc.c	2010-06-25 11:21:39.000000000 +0200
@@ -431,7 +431,7 @@ static int zfcp_fc_adisc(struct zfcp_por
 	struct zfcp_adapter *adapter = port->adapter;
 	int ret;
 
-	adisc = kmem_cache_alloc(zfcp_data.adisc_cache, GFP_ATOMIC);
+	adisc = kmem_cache_zalloc(zfcp_data.adisc_cache, GFP_ATOMIC);
 	if (!adisc)
 		return -ENOMEM;
 
@@ -524,7 +524,7 @@ static struct zfcp_gpn_ft *zfcp_alloc_sg
 	if (!gpn_ft)
 		return NULL;
 
-	req = kmem_cache_alloc(zfcp_data.gpn_ft_cache, GFP_KERNEL);
+	req = kmem_cache_zalloc(zfcp_data.gpn_ft_cache, GFP_KERNEL);
 	if (!req) {
 		kfree(gpn_ft);
 		gpn_ft = NULL;
