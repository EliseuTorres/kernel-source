From: Peter Oberparleiter <oberpar@linux.vnet.ibm.com>
Subject: sclp_vt220: Enable integrated ASCII console per default
Patch-mainline: v3.16-rc2
Git-commit: f2485f5d1c62bb8cccd452616892cdaf2466a090
References: bnc#885262, LTC#112035

Description:  sclp_vt220: Enable integrated ASCII console per default
Symptom:      Specifying kernel command line console=ttyS1 for a Linux running
              in a z/VM guest does not enable console output on the integrated
              ASCII console. Users have to specify the additional command line
              directive conmode=sclp. On LPAR, specifying console=ttyS1 is
              sufficient to enable console output on the integrated ASCII
              console. Also terminal output on /dev/ttyS1 is displayed on the
              ASCII console without specifying conmode=sclp.
Problem:      The sclp_vt220 console initialization code checks for
              conmode=sclp despite this not being a prerequisite for using
              the integrated ASCII console.
Solution:     Remove the check for conmode=sclp in the sclp_vt220 console
              initialization code.
Reproduction: 1. Attach the integrated ASCII console to the z/VM guest:
                 ATTACH SYSASCII TO *
              2. Boot Linux in a z/VM guest while specifying console=ttyS1 on
                 the kernel command line
              3. Check the integrated ASCII console applet on the HMC for
                 kernel messages.

Signed-off-by: Peter Oberparleiter <oberpar@linux.vnet.ibm.com>
Acked-by: John Jolly <jjolly@suse.de>
---
 drivers/s390/char/sclp_vt220.c |    2 --
 1 file changed, 2 deletions(-)

--- a/drivers/s390/char/sclp_vt220.c
+++ b/drivers/s390/char/sclp_vt220.c
@@ -843,8 +843,6 @@ sclp_vt220_con_init(void)
 {
 	int rc;
 
-	if (!CONSOLE_IS_SCLP)
-		return 0;
 	rc = __sclp_vt220_init(sclp_console_pages);
 	if (rc)
 		return rc;
