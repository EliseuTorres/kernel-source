From: Michael Holzheu <holzheu@linux.vnet.ibm.com>
Subject: hypfs: Missing files and directories
Patch-mainline: yes
References: bnc#769407,LTC#82838

Symptom:      Not all directories and files are created correctly by hypfs.
Problem:      With git commit 85fe4025c616a7c0ed07bc2fc8c5371b07f3888c
              ("fs: do not assign default i_ino in new_inode") the
              get_next_ino() function was moved from the new_inode() to
              the different file system implementations. Unfortunately
              hypfs has been overlooked by the author.
Solution:     Add get_next_ino() invocation to hypfs.
Reproduction: 1. Mount hypfs: mount none -t s390_hypfs /mnt
              2. List files: ls /mnt
              Result: Not all files and directories are available.

Acked-by: John Jolly <jjolly@suse.de>
---
 arch/s390/hypfs/inode.c |    1 +
 1 file changed, 1 insertion(+)

--- a/arch/s390/hypfs/inode.c
+++ b/arch/s390/hypfs/inode.c
@@ -103,6 +103,7 @@ static struct inode *hypfs_make_inode(st
 
 	if (ret) {
 		struct hypfs_sb_info *hypfs_info = sb->s_fs_info;
+		ret->i_ino = get_next_ino();
 		ret->i_mode = mode;
 		ret->i_uid = hypfs_info->uid;
 		ret->i_gid = hypfs_info->gid;
