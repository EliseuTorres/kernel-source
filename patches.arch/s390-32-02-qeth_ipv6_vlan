From: Gerald Schaefer <geraldsc@de.ibm.com>
Subject: qeth: l3 ipv6 vlan not working on shared OSA chpid
References: bnc#709866
Patch-mainline: 3.2-rc1
Git-commit: 1d31f52e38dfaf8bd07a6901c86fdd45e03eed24

    qeth: l3 ipv6 vlan not working on shared OSA chpid
    
    In layer 3 mode IPv6 over VLAN does not work on newer OSA  levels in
    case the sender and receiver run on the same (shared) OSA adapter.
    Keep vlan info in the skb so the qdio header is filled with the
    required vlan tag.
    
Signed-off-by: Frank Blaschka <frank.blaschka@de.ibm.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Signed-off-by: Gerald Schaefer <geraldsc@de.ibm.com>
Acked-by: Torsten Duwe <duwe@suse.de>

---
 drivers/s390/net/qeth_l3_main.c |    1 -
 1 file changed, 1 deletion(-)

--- a/drivers/s390/net/qeth_l3_main.c
+++ b/drivers/s390/net/qeth_l3_main.c
@@ -3109,7 +3109,6 @@ static int qeth_l3_hard_start_xmit(struc
 			tag = (u16 *)(new_skb->data + 12);
 			*tag = __constant_htons(ETH_P_8021Q);
 			*(tag + 1) = htons(vlan_tx_tag_get(new_skb));
-			new_skb->vlan_tci = 0;
 		}
 	}
 
