Git-commit: 49f8d8c04368d2e29cd26752715367ccafec5b1d
From: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date: Fri, 17 Oct 2014 17:49:44 -0700
Subject: [PATCH] powerpc/numa: use cached value of update->cpu in
 update_cpu_topology
Reference: bsc#924809
Patch-mainline: v3.18-rc3

There isn't any need to keep referring to update->cpu, as we've already
checked cpu == update->cpu at this point.

Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
Acked-by: Dinar Valeev <dvaleev@suse.com>
---
 arch/powerpc/mm/numa.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- dev1/arch/powerpc/mm/numa.c	2015-03-30 18:50:50.280062156 -0500
+++ dev1/arch/powerpc/mm/numa.c	2015-03-30 18:51:03.420079257 -0500
@@ -1499,8 +1499,8 @@ static int update_cpu_topology(void *dat
 		if (cpu != update->cpu)
 			continue;
 
-		unmap_cpu_from_node(update->cpu);
-		map_cpu_to_node(update->cpu, update->new_nid);
+		unmap_cpu_from_node(cpu);
+		map_cpu_to_node(cpu, update->new_nid);
 		vdso_getcpu_init();
 	}

