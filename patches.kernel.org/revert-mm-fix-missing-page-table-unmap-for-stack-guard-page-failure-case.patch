From 3d883cf1503ce441ac98edc8634c7bde41a544bd Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@suse.de>
Date: Fri, 20 Aug 2010 11:16:33 -0700
Subject: Revert "mm: fix missing page table unmap for stack guard page failure case"

This reverts commit ab832422673d1774c4ce3941f2ac87743d73bded.

Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---
 mm/memory.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

diff --git a/mm/memory.c b/mm/memory.c
index 76d1b21..92ef198 100644
--- a/mm/memory.c
+++ b/mm/memory.c
@@ -2662,10 +2662,8 @@ static int do_anonymous_page(struct mm_struct *mm, struct vm_area_struct *vma,
 	spinlock_t *ptl;
 	pte_t entry;
 
-	if (check_stack_guard_page(vma, address) < 0) {
-		pte_unmap(page_table);
+	if (check_stack_guard_page(vma, address) < 0)
 		return VM_FAULT_SIGBUS;
-	}
 
 	if (!(flags & FAULT_FLAG_WRITE)) {
 		entry = pte_mkspecial(pfn_pte(my_zero_pfn(address),
-- 
1.7.1

