From 731cfcfc640f1c739bca75fd15aeda12e51b2a02 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@suse.de>
Date: Fri, 20 Aug 2010 11:16:15 -0700
Subject: Revert "x86: don't send SIGBUS for kernel page faults"

This reverts commit 495b59364c67bc1f970a6229895ae15d1684d694.

Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---
 arch/x86/mm/fault.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

diff --git a/arch/x86/mm/fault.c b/arch/x86/mm/fault.c
index 1739358..f4cee90 100644
--- a/arch/x86/mm/fault.c
+++ b/arch/x86/mm/fault.c
@@ -801,10 +801,8 @@ do_sigbus(struct pt_regs *regs, unsigned long error_code, unsigned long address,
 	up_read(&mm->mmap_sem);
 
 	/* Kernel mode? Handle exceptions or die: */
-	if (!(error_code & PF_USER)) {
+	if (!(error_code & PF_USER))
 		no_context(regs, error_code, address);
-		return;
-	}
 
 	/* User-space => ok to do another page fault: */
 	if (is_prefetch(regs, error_code, address))
-- 
1.7.1

