From: Vipul Pandya <vipul@chelsio.com>
Date: Fri, 1 Feb 2013 00:03:47 +0000
Subject: [PATCH v4 08/25] cxgb3: Update VLAN extraction stats in the GRO path
Patch-mainline: v3.9-rc1
Git-commit: 72073ad2adacd2ed58a1dd98995342ca409a156e
References: bsc#909575 FATE#317552

Signed-off-by: Divy Le Ray <divy@chelsio.com>
Signed-off-by: Vipul Pandya <vipul@chelsio.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: David Chang <dchang@suse.com>
---
 drivers/net/ethernet/chelsio/cxgb3/sge.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/drivers/net/ethernet/chelsio/cxgb3/sge.c
+++ b/drivers/net/ethernet/chelsio/cxgb3/sge.c
@@ -2130,8 +2130,10 @@ static void lro_add_page(struct adapter
 
 	skb_record_rx_queue(skb, qs - &adap->sge.qs[pi->first_qset]);
 
-	if (cpl->vlan_valid)
+	if (cpl->vlan_valid) {
+		qs->port_stats[SGE_PSTAT_VLANEX]++;
 		__vlan_hwaccel_put_tag(skb, ntohs(cpl->vlan));
+	}
 	napi_gro_frags(&qs->napi);
 }
 
