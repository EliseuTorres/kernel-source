From: Willem de Bruijn <willemb@google.com>
Date: Fri, 27 Apr 2012 09:04:05 +0000
Subject: e1000e: add transmit timestamping support
Patch-mainline: v3.5-rc1
Git-commit: 80be3129d7152fe73b7d5db4595e2f4267497f24
References: bnc#795174 FATE#313648

Signed-off-by: Willem de Bruijn <willemb@google.com>
Acked-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Benjamin Poirier <bpoirier@suse.de>
---
 drivers/net/ethernet/intel/e1000e/netdev.c |    2 ++
 1 file changed, 2 insertions(+)
--- a/drivers/net/ethernet/intel/e1000e/netdev.c
+++ b/drivers/net/ethernet/intel/e1000e/netdev.c
@@ -5034,6 +5034,8 @@ static netdev_tx_t e1000_xmit_frame(stru
 	/* if count is 0 then mapping error has occurred */
 	count = e1000_tx_map(tx_ring, skb, first, max_per_txd, nr_frags, mss);
 	if (count) {
+		skb_tx_timestamp(skb);
+
 		netdev_sent_queue(netdev, skb->len);
 		e1000_tx_queue(tx_ring, tx_flags, count);
 		/* Make sure there is space in the ring for the next send. */
