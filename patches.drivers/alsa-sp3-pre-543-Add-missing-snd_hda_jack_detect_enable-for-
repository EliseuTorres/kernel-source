From ccfcf7d151c01969133b5555eed635537c41c944 Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Wed, 20 Jun 2012 09:30:42 +0200
Subject: [PATCH] ALSA: hda - Add missing snd_hda_jack_detect_enable() for simple_hdmi*()
Git-commit: ccfcf7d151c01969133b5555eed635537c41c944
Patch-mainline: 3.6-rc1
References: FATE#313695

Reported-by: Annie Liu <annieliu@viatech.com.cn>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 sound/pci/hda/patch_hdmi.c |    8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

--- a/sound/pci/hda/patch_hdmi.c
+++ b/sound/pci/hda/patch_hdmi.c
@@ -1415,13 +1415,15 @@ static int simple_playback_init(struct h
 	int i;
 
 	for (i = 0; i < spec->num_pins; i++) {
-		snd_hda_codec_write(codec, spec->pins[i].pin_nid, 0,
+		hda_nid_t pin = spec->pins[i].pin_nid;
+		snd_hda_codec_write(codec, pin, 0,
 				    AC_VERB_SET_PIN_WIDGET_CONTROL, PIN_OUT);
 		/* some codecs require to unmute the pin */
-		if (get_wcaps(codec, spec->pins[i].pin_nid) & AC_WCAP_OUT_AMP)
-			snd_hda_codec_write(codec, spec->pins[i].pin_nid, 0,
+		if (get_wcaps(codec, pin) & AC_WCAP_OUT_AMP)
+			snd_hda_codec_write(codec, pin, 0,
 					    AC_VERB_SET_AMP_GAIN_MUTE,
 					    AMP_OUT_UNMUTE);
+		snd_hda_jack_detect_enable(codec, pin, pin);
 	}
 	snd_hda_jack_report_sync(codec);
 	return 0;
