From 9dd8cf125d27742a25219bfdf82026e7efed27d9 Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Thu, 21 Jun 2012 10:43:15 +0200
Subject: [PATCH] ALSA: hda - Don't rely on event tag for simple_hdmi
Git-commit: 9dd8cf125d27742a25219bfdf82026e7efed27d9
Patch-mainline: 3.6-rc1
References: FATE#313695

VIA codecs seem not returning the event tag in the unsolicited events,
thus the current code relying on the tag value doesn't work.
Since simple_hdmi stuff has only a single pin, we can use simply
snd_hda_jack_set_dirty_all() to activate the pin-detection
independently from the tag value.

Tested-by: Annie Liu <AnnieLiu@viatech.com.cn>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 sound/pci/hda/patch_hdmi.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/sound/pci/hda/patch_hdmi.c
+++ b/sound/pci/hda/patch_hdmi.c
@@ -1388,7 +1388,7 @@ static int simple_playback_build_pcms(st
 static void simple_hdmi_unsol_event(struct hda_codec *codec,
 				    unsigned int res)
 {
-	snd_hda_jack_get_action(codec, res >> AC_UNSOL_RES_TAG_SHIFT);
+	snd_hda_jack_set_dirty_all(codec);
 	snd_hda_jack_report_sync(codec);
 }
 
