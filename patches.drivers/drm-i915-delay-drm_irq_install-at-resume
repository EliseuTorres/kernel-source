From: Adam Jackson <ajax@redhat.com>
Subject: [PATCH] drm/i915: delay drm_irq_install() at resume
Patch-mainline: Submitted
References: bnc#753698

Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/gpu/drm/i915/i915_drv.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/drivers/gpu/drm/i915/i915_drv.c
+++ b/drivers/gpu/drm/i915/i915_drv.c
@@ -479,13 +479,14 @@ static int i915_drm_thaw(struct drm_devi
 			ironlake_init_pch_refclk(dev);
 
 		drm_mode_config_reset(dev);
-		drm_irq_install(dev);
 
 		/* Resume the modeset for every activated CRTC */
 		mutex_lock(&dev->mode_config.mutex);
 		drm_helper_resume_force_mode(dev);
 		mutex_unlock(&dev->mode_config.mutex);
 
+		drm_irq_install(dev);
+
 		if (IS_IRONLAKE_M(dev))
 			ironlake_enable_rc6(dev);
 	}
