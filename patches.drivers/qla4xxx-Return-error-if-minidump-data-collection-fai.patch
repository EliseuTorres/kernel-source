From: Vikas Chaudhary <vikas.chaudhary@qlogic.com>
Date: Fri, 23 Aug 2013 03:40:20 -0400
Subject: [PATCH 07/34] qla4xxx: Return error if minidump data collection
 fails
Git-commit: 35a9c2ab3914a148b97a8df9cd7febafc7a07371
Patch-mainline: v3.12-rc1
References: FATE#317545 bnc#909371

Return error from function qla4_8xxx_collect_md_data()
if minidump data collection fails.

Signed-off-by: Vikas Chaudhary <vikas.chaudhary@qlogic.com>
Signed-off-by: James Bottomley <JBottomley@Parallels.com>
Acked-by: Hannes Reinecke <hare@suse.de>
---
 drivers/scsi/qla4xxx/ql4_nx.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/scsi/qla4xxx/ql4_nx.c b/drivers/scsi/qla4xxx/ql4_nx.c
index 37c3092..cb80cec 100644
--- a/drivers/scsi/qla4xxx/ql4_nx.c
+++ b/drivers/scsi/qla4xxx/ql4_nx.c
@@ -2543,6 +2543,7 @@ skip_nxt_entry:
 		ql4_printk(KERN_INFO, ha,
 			   "Dump data mismatch: Data collected: [0x%x], total_data_size:[0x%x]\n",
 			   data_collected, ha->fw_dump_size);
+		rval = QLA_ERROR;
 		goto md_failed;
 	}
 
-- 
1.8.0

