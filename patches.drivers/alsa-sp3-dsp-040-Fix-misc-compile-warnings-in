From 9a0869f4028916a164b1ba600e819c1dcd7c17a2 Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Thu, 7 Feb 2013 12:41:40 +0100
Subject: [PATCH] ALSA: hda - Fix misc compile warnings in patch_ca0132.c
Mime-version: 1.0
Content-type: text/plain; charset=UTF-8
Content-transfer-encoding: 8bit
Git-commit: 9a0869f4028916a164b1ba600e819c1dcd7c17a2
Patch-mainline: 3.9-rc1
References: bnc#814440,FATE#314291

  sound/pci/hda/patch_ca0132.c: In function ‘ca0132_is_vnode_effective’:
  sound/pci/hda/patch_ca0132.c:3331:15: warning: ‘nid’ may be used uninitialized in this function [-Wmaybe-uninitialized]
  sound/pci/hda/patch_ca0132.c:4345:13: warning: ‘ca0132_download_dsp’ defined but not used [-Wunused-function]

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 sound/pci/hda/patch_ca0132.c |   14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)

--- a/sound/pci/hda/patch_ca0132.c
+++ b/sound/pci/hda/patch_ca0132.c
@@ -3312,25 +3312,22 @@ static bool ca0132_is_vnode_effective(st
 {
 	struct ca0132_spec *spec = codec->spec;
 	hda_nid_t nid;
-	bool effective = false;
 
 	switch (vnid) {
 	case VNID_SPK:
 		nid = spec->shared_out_nid;
-		effective = true;
 		break;
 	case VNID_MIC:
 		nid = spec->shared_mic_nid;
-		effective = true;
 		break;
 	default:
-		break;
+		return false;
 	}
 
-	if (effective && shared_nid)
+	if (shared_nid)
 		*shared_nid = nid;
 
-	return effective;
+	return true;
 }
 
 /*
@@ -4343,6 +4340,9 @@ static void ca0132_download_dsp(struct h
 {
 	struct ca0132_spec *spec = codec->spec;
 
+#ifndef CONFIG_SND_HDA_CODEC_CA0132_DSP
+	return; /* NOP */
+#endif
 	spec->dsp_state = DSP_DOWNLOAD_INIT;
 
 	if (spec->dsp_state == DSP_DOWNLOAD_INIT) {
@@ -4527,9 +4527,7 @@ static int ca0132_init(struct hda_codec
 	ca0132_init_params(codec);
 	ca0132_init_flags(codec);
 	snd_hda_sequence_write(codec, spec->base_init_verbs);
-#ifdef CONFIG_SND_HDA_CODEC_CA0132_DSP
 	ca0132_download_dsp(codec);
-#endif
 	ca0132_refresh_widget_caps(codec);
 	ca0132_setup_defaults(codec);
 	ca0132_init_analog_mic2(codec);
