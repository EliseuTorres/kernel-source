From: Brian King <brking@linux.vnet.ibm.com>
Subject: ipr: Increase alignment boundary of command blocks
Git-commit: 1bfff2f8696ea13fc3d55a977f50abbddee336b2
Patch-mainline: yes
References: bnc#794550,fate#314040

    The latest generation of ipr hardware performs best when command blocks
    are aligned to a boundary equal to the size of the command block. Ensure
    512 byte alignment, since this is the largest size command block we
    can send.
    
Signed-off-by: Brian King <brking@linux.vnet.ibm.com>
Signed-off-by: James Bottomley <JBottomley@Parallels.com>
Acked-by: Torsten Duwe <duwe@suse.de>

---
 drivers/scsi/ipr.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: b/drivers/scsi/ipr.c
===================================================================
--- a/drivers/scsi/ipr.c	2012-12-07 11:14:48.505148833 -0600
+++ b/drivers/scsi/ipr.c	2012-12-07 11:15:04.117067259 -0600
@@ -8307,7 +8307,7 @@ static int __devinit ipr_alloc_cmd_blks(
 	int i;
 
 	ioa_cfg->ipr_cmd_pool = pci_pool_create (IPR_NAME, ioa_cfg->pdev,
-						 sizeof(struct ipr_cmnd), 16, 0);
+						 sizeof(struct ipr_cmnd), 512, 0);
 
 	if (!ioa_cfg->ipr_cmd_pool)
 		return -ENOMEM;
