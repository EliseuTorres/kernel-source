From: Dan Williams <dan.j.williams@intel.com>
Date: Fri, 23 Sep 2011 16:43:45 -0700
Subject: libsas: fix try_test_sas_gpio_gp_bit() build error
Git-commit: scsi-misc d962480e9a061505637bb16543d49e247349e25d
References: bnc#721246
Patch-Mainline: Included in scsi-misc

If the user has disabled CONFIG_SCSI_SAS_HOST_SMP then libsas drivers
will not be receiving smp-gpio frames and do not need this lookup code.

Reported-by: Randy Dunlap <rdunlap@xenotime.net>
Tested-by: Randy Dunlap <rdunlap@xenotime.net>
Signed-off-by: Dan Williams <dan.j.williams@intel.com>
Signed-off-by: James Bottomley <JBottomley@Parallels.com>
Acked-by: Hannes Reinecke <hare@suse.de>
---
 include/scsi/libsas.h |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/include/scsi/libsas.h b/include/scsi/libsas.h
index ac9d80c..d455fa9 100644
--- a/include/scsi/libsas.h
+++ b/include/scsi/libsas.h
@@ -413,7 +413,14 @@ static inline unsigned int to_sas_gpio_od(int device, int bit)
 	return 3 * device + bit;
 }
 
+#ifdef CONFIG_SCSI_SAS_HOST_SMP
 int try_test_sas_gpio_gp_bit(unsigned int od, u8 *data, u8 index, u8 count);
+#else
+static inline int try_test_sas_gpio_gp_bit(unsigned int od, u8 *data, u8 index, u8 count)
+{
+	return -1;
+}
+#endif
 
 /* ---------- Tasks ---------- */
 /*
-- 
1.6.0.2

