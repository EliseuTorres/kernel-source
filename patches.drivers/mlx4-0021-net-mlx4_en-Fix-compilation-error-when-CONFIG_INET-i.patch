From: Hadar Hen Zion <hadarh@mellanox.com>
Date: Mon, 4 Feb 2013 03:01:21 +0000
Subject: net/mlx4_en: Fix compilation error when CONFIG_INET isn't defined
Patch-mainline: v3.9-rc1
Git-commit: f9d96862cacd1177d76d82f70f88ac57cb05e6e0
References: bug#919382 FATE#317529

ip_eth_mc_map function can't be used when CONFIG_INET isn't defined.
Fixed compilation error by adding CONFIG_INET define check before using the
function.

Signed-off-by: Hadar Hen Zion <hadarh@mellanox.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Benjamin Poirier <bpoirier@suse.de>
---
 drivers/net/ethernet/mellanox/mlx4/en_ethtool.c |    4 ++++
 1 file changed, 4 insertions(+)

--- a/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
+++ b/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
@@ -705,6 +705,7 @@ static int mlx4_en_ethtool_add_mac_rule_
 						struct mlx4_spec_list *spec_l2,
 						__be32 ipv4_dst)
 {
+#ifdef CONFIG_INET
 	__be64 be_mac = 0;
 	unsigned char mac[ETH_ALEN];
 
@@ -716,6 +717,9 @@ static int mlx4_en_ethtool_add_mac_rule_
 	}
 
 	return mlx4_en_ethtool_add_mac_rule(cmd, rule_list_h, spec_l2, &mac[0]);
+#else
+	return -EINVAL;
+#endif
 }
 
 static int add_ip_rule(struct mlx4_en_priv *priv,
