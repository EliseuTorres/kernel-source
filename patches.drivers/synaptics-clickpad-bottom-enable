From: Takashi Iwai <tiwai@suse.de>
Subject: Add parameter to enable/disable the sensing of clickpad button area
Patch-mainline: Unlikely
References: bnc#58529

Add a module option "clickpad_button_sense" to enable/disable the sensing
of the bottom button area for Synaptics clickpad devices.

Sensing in the button area gives annyoing user experience; the mouse
pointer moves when you click in this area and miesses the position, e.g.
a small check box or an icon.  Thus usually the sensing in the button area
is disabled.

However, if you enable the horizontal scrolling, this area is used for the
scrolling area, and you need to enable the sensing.

The module option above can be changed via sysfs file
   /sys/modules/psmouse/parameters/clickpad_button_sense
dynamically.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/input/mouse/synaptics.c |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/drivers/input/mouse/synaptics.c
+++ b/drivers/input/mouse/synaptics.c
@@ -368,6 +368,10 @@
 static int clickpad_area = 20;
 module_param(clickpad_area, int, 0644);
 
+/* flag to enable/disable touching in the button area */
+static int clickpad_button_sense;
+module_param(clickpad_button_sense, bool, 0644);
+
 /* handle clickpad events */
 static void clickpad_process_packet(struct synaptics_data *priv,
 				    struct synaptics_hw_state *hw)
@@ -379,7 +383,7 @@
 	   !clickpad_disabled) {
 		/* button area */
 		/* allow position change for the v-scroll area exceptionally */
-		if (hw->x < X_VSCROLL || hw->middle)
+		if ((hw->x < X_VSCROLL || hw->middle) && !clickpad_button_sense)
 			hw->z = 0; /* don't move pointer */
 		/* clickpad reports only the middle button, and we need
 		 * to fake left/right buttons depending on the touch position
