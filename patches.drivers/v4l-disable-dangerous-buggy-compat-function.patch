From: Kees Cook <kees.cook@canonical.com>
Date: Wed, 13 Oct 2010 12:12:06 -0700
Subject: [PATCH] v4l: disable dangerous buggy compat function
Patch-mainline: Never, Linus is trying to fix this mess up
References: bnc#646045, CVE-2010-2963

Fix CVE-2010-2963 by disabling the entire bad compat function.

See 3e645d6b485446c54c6745c5e2cf5c528fe4deec for Linus trying to fix it.
But, we don't care as there are no callers in our tree.

Signed-off-by: Kees Cook <kees.cook@canonical.com>
Signed-off-by: Brandon Philips <bphilips@suse.de>
---
 drivers/media/video/v4l2-compat-ioctl32.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/media/video/v4l2-compat-ioctl32.c b/drivers/media/video/v4l2-compat-ioctl32.c
index 073f013..a322b72 100644
--- a/drivers/media/video/v4l2-compat-ioctl32.c
+++ b/drivers/media/video/v4l2-compat-ioctl32.c
@@ -198,6 +198,7 @@ struct video_code32 {
 
 static int get_microcode32(struct video_code *kp, struct video_code32 __user *up)
 {
+	return -EFAULT;
 	if (!access_ok(VERIFY_READ, up, sizeof(struct video_code32)) ||
 		copy_from_user(kp->loadwhat, up->loadwhat, sizeof(up->loadwhat)) ||
 		get_user(kp->datasize, &up->datasize) ||
-- 
1.7.1

