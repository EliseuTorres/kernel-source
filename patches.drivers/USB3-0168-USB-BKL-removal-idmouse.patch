From dbdae3bd4af15c32e3b5eb6e608c1e2ea751b07f Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oliver@neukum.org>
Date: Thu, 14 Jan 2010 16:11:03 +0100
Subject: USB: BKL removal: idmouse
Patch-mainline: v2.6.34
Git-commit: dbdae3bd4af15c32e3b5eb6e608c1e2ea751b07f

BKL was not needed at all. Removed without replacement.

Signed-off-by: Oliver Neukum <oliver@neukum.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/misc/idmouse.c |    8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

--- a/drivers/usb/misc/idmouse.c
+++ b/drivers/usb/misc/idmouse.c
@@ -24,7 +24,6 @@
 #include <linux/module.h>
 #include <linux/completion.h>
 #include <linux/mutex.h>
-#include <linux/smp_lock.h>
 #include <asm/uaccess.h>
 #include <linux/usb.h>
 
@@ -227,20 +226,16 @@ static int idmouse_open(struct inode *in
 	struct usb_interface *interface;
 	int result;
 
-	lock_kernel();
 	/* get the interface from minor number and driver information */
 	interface = usb_find_interface (&idmouse_driver, iminor (inode));
-	if (!interface) {
-		unlock_kernel();
+	if (!interface)
 		return -ENODEV;
-	}
 
 	mutex_lock(&open_disc_mutex);
 	/* get the device information block from the interface */
 	dev = usb_get_intfdata(interface);
 	if (!dev) {
 		mutex_unlock(&open_disc_mutex);
-		unlock_kernel();
 		return -ENODEV;
 	}
 
@@ -277,7 +272,6 @@ error:
 
 	/* unlock this device */
 	mutex_unlock(&dev->lock);
-	unlock_kernel();
 	return result;
 }
 
