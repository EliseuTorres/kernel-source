From ddb8152b054e357907f57fb5ae65d494a3c79065 Mon Sep 17 00:00:00 2001
From: Wu Fengguang <fengguang.wu@intel.com>
Date: Fri, 30 Oct 2009 11:43:03 +0100
Subject: ALSA: hda - reorder intelhdmi prepare/cleanup callbacks
Patch-mainline: 
References: FATE#306783

No behavior change.

Signed-off-by: Wu Fengguang <fengguang.wu@intel.com>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 sound/pci/hda/patch_intelhdmi.c |   22 +++++++++++-----------
 1 files changed, 11 insertions(+), 11 deletions(-)

diff --git a/sound/pci/hda/patch_intelhdmi.c b/sound/pci/hda/patch_intelhdmi.c
index c17feac..6be5ca4 100644
--- a/sound/pci/hda/patch_intelhdmi.c
+++ b/sound/pci/hda/patch_intelhdmi.c
@@ -543,30 +543,30 @@ static void intel_hdmi_unsol_event(struct hda_codec *codec, unsigned int res)
  * Callbacks
  */
 
-static int intel_hdmi_playback_pcm_cleanup(struct hda_pcm_stream *hinfo,
+static int intel_hdmi_playback_pcm_prepare(struct hda_pcm_stream *hinfo,
 					   struct hda_codec *codec,
+					   unsigned int stream_tag,
+					   unsigned int format,
 					   struct snd_pcm_substream *substream)
 {
-	struct intel_hdmi_spec *spec = codec->spec;
+	hdmi_set_channel_count(codec, cvt_nid,
+			       substream->runtime->channels);
 
-	hdmi_stop_infoframe_trans(codec, pin_nid);
+	hdmi_setup_audio_infoframe(codec, cvt_nid, substream);
 
-	snd_hda_codec_cleanup_stream(codec, hinfo->nid);
+	snd_hda_codec_setup_stream(codec, hinfo->nid, stream_tag, 0, format);
 	return 0;
 }
 
-static int intel_hdmi_playback_pcm_prepare(struct hda_pcm_stream *hinfo,
+static int intel_hdmi_playback_pcm_cleanup(struct hda_pcm_stream *hinfo,
 					   struct hda_codec *codec,
-					   unsigned int stream_tag,
-					   unsigned int format,
 					   struct snd_pcm_substream *substream)
 {
-	hdmi_set_channel_count(codec, cvt_nid,
-			       substream->runtime->channels);
+	struct intel_hdmi_spec *spec = codec->spec;
 
-	hdmi_setup_audio_infoframe(codec, cvt_nid, substream);
+	hdmi_stop_infoframe_trans(codec, pin_nid);
 
-	snd_hda_codec_setup_stream(codec, hinfo->nid, stream_tag, 0, format);
+	snd_hda_codec_cleanup_stream(codec, hinfo->nid);
 	return 0;
 }
 
-- 
1.6.4.2

