From ivecera@redhat.com  Thu Jun 23 15:40:26 2011
From: Ivan Vecera <ivecera@redhat.com>
Date: Thu, 21 Apr 2011 00:20:04 +0000
Subject: [PATCH] be2net: increment work_counter in be_worker
Git-commit: e74fbd030223e29d269f4be17e3dce6de38f4c28
Patch-mainline: v2.6.39-rc6
References: FATE#311448, bnc#697255

The commit 609ff3b ("be2net: add code to display temperature of ASIC")
adds support to display temperature of ASIC but there is missing
increment of work_counter in be_worker. Because of this 1) the
function be_cmd_get_die_temperature is called every 1 second instead
of every 32 seconds 2) be_cmd_get_die_temperature is called, although
it is not supported.  This patch fixes this bug.

Signed-off-by: Ivan Vecera <ivecera@redhat.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Acked-by: Jeff Mahoney <jeffm@suse.com>
---
 drivers/net/benet/be_main.c |    1 +
 1 file changed, 1 insertion(+)
--- a/drivers/net/benet/be_main.c
+++ b/drivers/net/benet/be_main.c
@@ -1815,6 +1815,7 @@ static void be_worker(struct work_struct
 	}
 
 reschedule:
+	adapter->work_counter++;
 	schedule_delayed_work(&adapter->work, msecs_to_jiffies(1000));
 }
 
