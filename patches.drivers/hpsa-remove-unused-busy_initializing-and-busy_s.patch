From: Stephen M. Cameron <scameron@beardog.cce.hp.com>
Date: Wed, 26 Oct 2011 16:20:58 -0500
Subject: [SCSI] hpsa: remove unused busy_initializing and busy_scanning
Git-commit: 03ab31f4c14f259bfa160543c83dbfd93d6fb3e2
References: FATE#313833
Patch-Mainline: v3.2

Signed-off-by: Stephen M. Cameron <scameron@beardog.cce.hp.com>
Signed-off-by: James Bottomley <JBottomley@Parallels.com>
Acked-by: Hannes Reinecke <hare@suse.de>
---
 drivers/scsi/hpsa.c |    4 ----
 drivers/scsi/hpsa.h |    5 -----
 2 files changed, 0 insertions(+), 9 deletions(-)

diff --git a/drivers/scsi/hpsa.c b/drivers/scsi/hpsa.c
index d3054efb..a395ed7 100644
--- a/drivers/scsi/hpsa.c
+++ b/drivers/scsi/hpsa.c
@@ -4146,7 +4146,6 @@ reinit_after_soft_reset:
 		return -ENOMEM;
 
 	h->pdev = pdev;
-	h->busy_initializing = BUSY_INIT_BUSY;
 	h->intr_mode = hpsa_simple_mode ? SIMPLE_MODE_INT : PERF_MODE_INT;
 	INIT_LIST_HEAD(&h->cmpQ);
 	INIT_LIST_HEAD(&h->reqQ);
@@ -4255,7 +4254,6 @@ reinit_after_soft_reset:
 
 	hpsa_hba_inquiry(h);
 	hpsa_register_scsi(h);	/* hook ourselves into SCSI subsystem */
-	h->busy_initializing = BUSY_INIT_IDLE;
 	return 1;
 
 clean4:
@@ -4264,7 +4262,6 @@ clean4:
 	free_irq(h->intr[h->intr_mode], h);
 clean2:
 clean1:
-	h->busy_initializing = BUSY_INIT_IDLE;
 	kfree(h);
 	return rc;
 }
@@ -4305,7 +4302,6 @@ static void hpsa_shutdown(struct pci_dev *pdev)
 	 * To write all data in the battery backed cache to disks
 	 */
 	hpsa_flush_cache(h);
-	h->busy_initializing = BUSY_INIT_SHUTDOWN;
 	h->access.set_intr_mask(h, HPSA_INTR_OFF);
 	if (h->intr[h->intr_mode] != 0)
 	    free_irq(h->intr[h->intr_mode], h);
diff --git a/drivers/scsi/hpsa.h b/drivers/scsi/hpsa.h
index 778d080..3c056cc 100644
--- a/drivers/scsi/hpsa.h
+++ b/drivers/scsi/hpsa.h
@@ -97,11 +97,6 @@ struct ctlr_info {
 	unsigned long  		*cmd_pool_bits;
 	int			nr_allocs;
 	int			nr_frees;
-	int			busy_initializing;
-#define BUSY_INIT_IDLE 0
-#define BUSY_INIT_BUSY 1
-#define BUSY_INIT_SHUTDOWN 2
-	int			busy_scanning;
 	int			scan_finished;
 	spinlock_t		scan_lock;
 	wait_queue_head_t	scan_wait_queue;
-- 
1.7.4.2

