From: Maciej Patelczyk <maciej.patelczyk@intel.com>
Date: Thu, 28 Apr 2011 22:06:26 +0000
Subject: [PATCH 127/273] isci: Removed sci_base_object from scic_sds_remote_node_context.
Git-commit: af23e85737253624cde84704008be40355ff6922
References: FATE#311808,bnc#709528
Patch-Mainline: 3.0

The 'struct sci_base_object' was removed from the struct
scic_sds_remote_node_context.

Signed-off-by: Maciej Patelczyk <maciej.patelczyk@intel.com>
Signed-off-by: Dan Williams <dan.j.williams@intel.com>
Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 drivers/scsi/isci/remote_device.c       |    2 -
 drivers/scsi/isci/remote_node_context.c |   33 ++++++++----------------------
 drivers/scsi/isci/remote_node_context.h |    5 ----
 3 files changed, 9 insertions(+), 31 deletions(-)

diff --git a/drivers/scsi/isci/remote_device.c b/drivers/scsi/isci/remote_device.c
index 3fc66b2..2bbc7c2 100644
--- a/drivers/scsi/isci/remote_device.c
+++ b/drivers/scsi/isci/remote_device.c
@@ -1386,8 +1386,6 @@ static void scic_remote_device_construct(struct scic_sds_port *sci_port,
 
 	scic_sds_remote_node_context_construct(&sci_dev->rnc,
 					       SCIC_SDS_REMOTE_NODE_CONTEXT_INVALID_INDEX);
-
-	sci_object_set_association(&sci_dev->rnc, sci_dev);
 }
 
 /**
diff --git a/drivers/scsi/isci/remote_node_context.c b/drivers/scsi/isci/remote_node_context.c
index bc51ecf..49d2dc5 100644
--- a/drivers/scsi/isci/remote_node_context.c
+++ b/drivers/scsi/isci/remote_node_context.c
@@ -972,9 +972,7 @@ static void scic_sds_remote_node_context_invalidate_context_buffer(
  */
 static void scic_sds_remote_node_context_initial_state_enter(void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
-
-	rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *rnc = object;
 
 	SET_STATE_HANDLER(
 		rnc,
@@ -1002,9 +1000,7 @@ static void scic_sds_remote_node_context_initial_state_enter(void *object)
  */
 static void scic_sds_remote_node_context_posting_state_enter(void *object)
 {
-	struct scic_sds_remote_node_context *sci_rnc;
-
-	sci_rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *sci_rnc = object;
 
 	SET_STATE_HANDLER(
 		sci_rnc,
@@ -1022,9 +1018,7 @@ static void scic_sds_remote_node_context_posting_state_enter(void *object)
  */
 static void scic_sds_remote_node_context_invalidating_state_enter(void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
-
-	rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *rnc = object;
 
 	SET_STATE_HANDLER(
 		rnc,
@@ -1042,11 +1036,10 @@ static void scic_sds_remote_node_context_invalidating_state_enter(void *object)
  */
 static void scic_sds_remote_node_context_resuming_state_enter(void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
+	struct scic_sds_remote_node_context *rnc = object;
 	struct scic_sds_remote_device *sci_dev;
 	struct domain_device *dev;
 
-	rnc = (struct scic_sds_remote_node_context *)object;
 	sci_dev = rnc_to_dev(rnc);
 	dev = sci_dev_to_domain(sci_dev);
 
@@ -1077,9 +1070,7 @@ static void scic_sds_remote_node_context_resuming_state_enter(void *object)
  */
 static void scic_sds_remote_node_context_ready_state_enter(void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
-
-	rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *rnc = object;
 
 	SET_STATE_HANDLER(
 		rnc,
@@ -1101,9 +1092,7 @@ static void scic_sds_remote_node_context_ready_state_enter(void *object)
  */
 static void scic_sds_remote_node_context_tx_suspended_state_enter(void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
-
-	rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *rnc = object;
 
 	SET_STATE_HANDLER(
 		rnc,
@@ -1122,9 +1111,7 @@ static void scic_sds_remote_node_context_tx_suspended_state_enter(void *object)
 static void scic_sds_remote_node_context_tx_rx_suspended_state_enter(
 		void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
-
-	rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *rnc = object;
 
 	SET_STATE_HANDLER(
 		rnc,
@@ -1143,9 +1130,7 @@ static void scic_sds_remote_node_context_tx_rx_suspended_state_enter(
 static void scic_sds_remote_node_context_await_suspension_state_enter(
 	void *object)
 {
-	struct scic_sds_remote_node_context *rnc;
-
-	rnc = (struct scic_sds_remote_node_context *)object;
+	struct scic_sds_remote_node_context *rnc = object;
 
 	SET_STATE_HANDLER(
 		rnc,
@@ -1193,7 +1178,7 @@ void scic_sds_remote_node_context_construct(struct scic_sds_remote_node_context
 
 	sci_base_state_machine_construct(
 		&rnc->state_machine,
-		&rnc->parent,
+		rnc,
 		scic_sds_remote_node_context_state_table,
 		SCIC_SDS_REMOTE_NODE_CONTEXT_INITIAL_STATE
 		);
diff --git a/drivers/scsi/isci/remote_node_context.h b/drivers/scsi/isci/remote_node_context.h
index b3f2546..bc7914b 100644
--- a/drivers/scsi/isci/remote_node_context.h
+++ b/drivers/scsi/isci/remote_node_context.h
@@ -226,11 +226,6 @@ enum scic_sds_remote_node_context_destination_state {
  *    the silicon RNC.
  */
 struct scic_sds_remote_node_context {
-	/*
-	 * parent object
-	 */
-	struct sci_base_object parent;
-
 	/**
 	 * This field indicates the remote node index (RNI) associated with
 	 * this RNC.
-- 
1.6.0.2

