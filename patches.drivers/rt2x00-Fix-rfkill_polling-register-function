From: "Chen, Chien-Chia" <machen@suse.com>
Subject:[PATCH] rt2x00: rt2x00dev: move rfkill_polling register to proper place
References: bnc#748806
Patch-mainline: submitted to linux-wireless on 2012-03-29

Move rt2x00rfkill_register(rt2x00dev) to rt2x00lib_probe_dev().
It fixes of starting rfkill_poll function at the right time if
sets hard rfkill block and reboot. rt2x00mac_rfkill_poll should
be starting before bringing up the wireless interface.

Signed-off-by: Chen, Chien-Chia <machen@suse.com>
Acked-by: Helmut Schaa <helmut.schaa@googlemail.com>
CC: Kevin Chou <kevin.chou@mediatek.com>

---
 drivers/net/wireless/rt2x00/rt2x00dev.c |    6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

--- a/drivers/net/wireless/rt2x00/rt2x00dev.c
+++ b/drivers/net/wireless/rt2x00/rt2x00dev.c
@@ -1033,11 +1033,6 @@ static int rt2x00lib_initialize(struct r
 
 	set_bit(DEVICE_STATE_INITIALIZED, &rt2x00dev->flags);
 
-	/*
-	 * Register the extra components.
-	 */
-	rt2x00rfkill_register(rt2x00dev);
-
 	return 0;
 }
 
@@ -1169,6 +1164,7 @@ int rt2x00lib_probe_dev(struct rt2x00_de
 	rt2x00link_register(rt2x00dev);
 	rt2x00leds_register(rt2x00dev);
 	rt2x00debug_register(rt2x00dev);
+	rt2x00rfkill_register(rt2x00dev);
 
 	return 0;
 

