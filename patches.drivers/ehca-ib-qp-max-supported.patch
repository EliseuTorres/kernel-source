From: Alexander Schmidt <alexs@linux.vnet.ibm.com>
Subject: ib/ehca: allow access by query_qp()
References: bnc#575072,LTC#59986
Patch-mainline: Submitted - Wed, 27 Jan 2010 09:03:40 -0800 to linux-rdma@vger.kernel.org

The max_dest_rd_atomic and max_qp_rd_atomic values are
properly returned by query_qp(), so there should not be
an error returned when they are queried.

Signed-off-by: Alexander Schmidt <alexs@linux.vnet.ibm.com>
Acked-by: John Jolly <jjolly@suse.de>
---
Index: linux-2.6.32.3-0.5/drivers/infiniband/hw/ehca/ehca_qp.c
===================================================================
--- linux-2.6.32.3-0.5.orig/drivers/infiniband/hw/ehca/ehca_qp.c	2010-01-25 17:51:57.000000000 +0100
+++ linux-2.6.32.3-0.5/drivers/infiniband/hw/ehca/ehca_qp.c	2010-01-26 14:14:48.000000000 +0100
@@ -55,9 +55,7 @@
 /*
  * attributes not supported by query qp
  */
-#define QP_ATTR_QUERY_NOT_SUPPORTED (IB_QP_MAX_DEST_RD_ATOMIC | \
-				     IB_QP_MAX_QP_RD_ATOMIC   | \
-				     IB_QP_ACCESS_FLAGS       | \
+#define QP_ATTR_QUERY_NOT_SUPPORTED (IB_QP_ACCESS_FLAGS       | \
 				     IB_QP_EN_SQD_ASYNC_NOTIFY)
 
 /*

