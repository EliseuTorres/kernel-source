From fbdeca2d7753aa1ab929aeb77ccc46489eed02b9 Mon Sep 17 00:00:00 2001
From: Jiri Pirko <jiri@resnulli.us>
Date: Tue, 1 Jan 2013 03:30:16 +0000
Subject: [PATCH v2 002/021] net: add address assign type "SET"

Git-commit: fbdeca2d7753aa1ab929aeb77ccc46489eed02b9
Patch-mainline: v3.9-rc1
Reference: fate#317398
Target: sle11-sp4

This is the way to indicate that mac address of a device has been set by
dev_set_mac_address()

Signed-off-by: Jiri Pirko <jiri@resnulli.us>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Lee, Chun-Yi <jlee@suse.com>

---
 include/linux/netdevice.h |    2 ++
 net/core/dev.c            |    1 +
 2 files changed, 3 insertions(+)

Index: linux-3.0-SLE11-SP4/include/linux/netdevice.h
===================================================================
--- linux-3.0-SLE11-SP4.orig/include/linux/netdevice.h
+++ linux-3.0-SLE11-SP4/include/linux/netdevice.h
@@ -67,6 +67,8 @@ struct wireless_dev;
 #define NET_ADDR_PERM		0	/* address is permanent (default) */
 #define NET_ADDR_RANDOM		1	/* address is generated randomly */
 #define NET_ADDR_STOLEN		2	/* address is stolen from other device */
+#define NET_ADDR_SET		3	/* address is set using
+					 * dev_set_mac_address() */
 
 /* Backlog congestion levels */
 #define NET_RX_SUCCESS		0	/* keep 'em coming, baby */
Index: linux-3.0-SLE11-SP4/net/core/dev.c
===================================================================
--- linux-3.0-SLE11-SP4.orig/net/core/dev.c
+++ linux-3.0-SLE11-SP4/net/core/dev.c
@@ -5006,6 +5006,7 @@ int dev_set_mac_address(struct net_devic
 	err = ops->ndo_set_mac_address(dev, sa);
 	if (err)
 		return err;
+	dev->addr_assign_type = NET_ADDR_SET;
 	call_netdevice_notifiers(NETDEV_CHANGEADDR, dev);
 	add_device_randomness(dev->dev_addr, dev->addr_len);
 	return 0;
