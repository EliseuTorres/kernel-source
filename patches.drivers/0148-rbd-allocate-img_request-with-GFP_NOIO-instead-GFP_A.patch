From 30fbcb72be1d557e1735865bddd3d029240eae7f Mon Sep 17 00:00:00 2001
From: Ilya Dryomov <ilya.dryomov@inktank.com>
Date: Tue, 5 Aug 2014 11:25:54 +0400
Subject: [PATCH 148/213] rbd: allocate img_request with GFP_NOIO instead
 GFP_ATOMIC
References: fate#318918
Git-commit: 7a716aac01eedb8a7ebf36a0e81237c56f9f1bc1
Patch-mainline: v3.17-rc1

Now that rbd_img_request_create() is called from work functions, no
need to use GFP_ATOMIC.

Signed-off-by: Ilya Dryomov <ilya.dryomov@inktank.com>
Reviewed-by: Alex Elder <elder@linaro.org>
Acked-by: David Disseldorp <ddiss@suse.de>

---
 drivers/block/rbd.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/block/rbd.c b/drivers/block/rbd.c
index c260c3b..d848ce7 100644
--- a/drivers/block/rbd.c
+++ b/drivers/block/rbd.c
@@ -2099,7 +2099,7 @@ static struct rbd_img_request *rbd_img_request_create(
 {
 	struct rbd_img_request *img_request;
 
-	img_request = kmem_cache_alloc(rbd_img_request_cache, GFP_ATOMIC);
+	img_request = kmem_cache_alloc(rbd_img_request_cache, GFP_NOIO);
 	if (!img_request)
 		return NULL;
 
-- 
2.1.4

