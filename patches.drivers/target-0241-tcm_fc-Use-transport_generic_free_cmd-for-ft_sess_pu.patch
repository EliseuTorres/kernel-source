From: Andy Grover <agrover@redhat.com>
Date: Thu, 19 Jan 2012 13:39:20 -0800
Subject: [PATCH] tcm_fc: Use transport_generic_free_cmd for ft_sess_put in ft_send_tm
Git-commit: a1321f71e87930579afc4a4029cce128c23f3fd3
References: FATE#313550
Patch-Mainline: v3.4

transport_generic_free_cmd will end up calling ft_sess_put, so it should
work just the same.

Signed-off-by: Andy Grover <agrover@redhat.com>
Cc: Kiran Patil <kiran.patil@intel.com>
Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>
Acked-by: Hannes Reinecke <hare@suse.de>
---
 drivers/target/tcm_fc/tfc_cmd.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/target/tcm_fc/tfc_cmd.c b/drivers/target/tcm_fc/tfc_cmd.c
index c75ab41..979e983 100644
--- a/drivers/target/tcm_fc/tfc_cmd.c
+++ b/drivers/target/tcm_fc/tfc_cmd.c
@@ -410,7 +410,7 @@ static void ft_send_tm(struct ft_cmd *cmd)
 		sess = cmd->sess;
 		transport_send_check_condition_and_sense(&cmd->se_cmd,
 			cmd->se_cmd.scsi_sense_reason, 0);
-		ft_sess_put(sess);
+		transport_generic_free_cmd(&cmd->se_cmd, 0);
 		return;
 	}
 
-- 
1.7.4.2

