From eric.dumazet@gmail.com  Thu Jun 23 15:40:24 2011
From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Thu, 2 Sep 2010 13:07:41 -0700
Subject: [PATCH] drivers/net: avoid some skb->ip_summed initializations
Git-commit: bc8acf2c8c3e43fcc192762a9f964b3e9a17748b
Patch-mainline: v2.6.37-rc1
References: FATE#311448, bnc#697255

fresh skbs have ip_summed set to CHECKSUM_NONE (0)

We can avoid setting again skb->ip_summed to CHECKSUM_NONE in drivers.

Introduce skb_checksum_none_assert() helper so that we keep this
assertion documented in driver sources.

Change most occurrences of :

skb->ip_summed = CHECKSUM_NONE;

by :

skb_checksum_none_assert(skb);

Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Acked-by: Jeff Mahoney <jeffm@suse.com>
---
 drivers/net/benet/be_main.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
--- a/drivers/net/benet/be_main.c
+++ b/drivers/net/benet/be_main.c
@@ -928,7 +928,7 @@ static void be_rx_compl_process(struct b
 	skb_fill_rx_data(adapter, skb, rxcp, num_rcvd);
 
 	if (do_pkt_csum(rxcp, adapter->rx_csum))
-		skb->ip_summed = CHECKSUM_NONE;
+		skb_checksum_none_assert(skb);
 	else
 		skb->ip_summed = CHECKSUM_UNNECESSARY;
 
