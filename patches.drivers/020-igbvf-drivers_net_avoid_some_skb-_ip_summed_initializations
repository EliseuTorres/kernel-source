From: "Lee, Chun-Yi" <jlee@suse.com>
Subject: [PATCHv2 20/33] [igbvf] drivers/net: avoid some skb->ip_summed initializations
Patch-mainline: 2.6.37
Git-commit: bc8acf2c8c3e43fcc192762a9f964b3e9a17748b
References: bnc#699087, fate#311862

From: Eric Dumazet <eric.dumazet@gmail.com>

fresh skbs have ip_summed set to CHECKSUM_NONE (0)

We can avoid setting again skb->ip_summed to CHECKSUM_NONE in drivers.

Introduce skb_checksum_none_assert() helper so that we keep this
assertion documented in driver sources.

Change most occurrences of :

skb->ip_summed = CHECKSUM_NONE;

by :

skb_checksum_none_assert(skb);

Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Lee, Chun-Yi <jlee@suse.com>
---
 drivers/net/igbvf/netdev.c |    2 +-
 2 files changed, 16 insertions(+), 1 deletion(-)

--- a/drivers/net/igbvf/netdev.c
+++ b/drivers/net/igbvf/netdev.c
@@ -102,7 +102,7 @@ static void igbvf_receive_skb(struct igb
 static inline void igbvf_rx_checksum_adv(struct igbvf_adapter *adapter,
                                          u32 status_err, struct sk_buff *skb)
 {
-	skb->ip_summed = CHECKSUM_NONE;
+	skb_checksum_none_assert(skb);
 
 	/* Ignore Checksum bit is set or checksum is disabled through ethtool */
 	if ((status_err & E1000_RXD_STAT_IXSM) ||
