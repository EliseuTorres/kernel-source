From: Mauro Carvalho Chehab <mchehab@redhat.com>
Subject: i7core_edac: it is safe to i7core_unregister_mci() when mci=NULL
References: fate#311968
Git-commit: 88ef5ea9767b0c7bfb4b477e1857629fe8fa2983
Patch-mainline: v2.6.37-rc1


Signed-off-by: Thomas Renninger <trenn@suse.de>

i7core_unregister_mci() checks internally when mci=NULL. There's no
need to test it outside.

Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

---
 drivers/edac/i7core_edac.c |   13 +++++--------
 1 file changed, 5 insertions(+), 8 deletions(-)

Index: linux-2.6.32-SLE11-SP1/drivers/edac/i7core_edac.c
===================================================================
--- linux-2.6.32-SLE11-SP1.orig/drivers/edac/i7core_edac.c
+++ linux-2.6.32-SLE11-SP1/drivers/edac/i7core_edac.c
@@ -2092,10 +2092,9 @@ static int __devinit i7core_probe(struct
 	return 0;
 
 fail1:
-	list_for_each_entry(i7core_dev, &i7core_edac_list, list) {
-		if (i7core_dev->mci)
-			i7core_unregister_mci(i7core_dev);
-	}
+	list_for_each_entry(i7core_dev, &i7core_edac_list, list)
+		i7core_unregister_mci(i7core_dev);
+
 	i7core_put_all_devices();
 fail0:
 	mutex_unlock(&i7core_edac_lock);
@@ -2127,10 +2126,8 @@ static void __devexit i7core_remove(stru
 		return;
 	}
 
-	list_for_each_entry(i7core_dev, &i7core_edac_list, list) {
-		if (i7core_dev->mci)
-			i7core_unregister_mci(i7core_dev);
-	}
+	list_for_each_entry(i7core_dev, &i7core_edac_list, list)
+		i7core_unregister_mci(i7core_dev);
 
 	/* Release PCI resources */
 	i7core_put_all_devices();
