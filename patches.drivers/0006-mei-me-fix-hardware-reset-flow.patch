From 633a09cb63e08642ea57b3ed7d20a982ed9ae71d Mon Sep 17 00:00:00 2001
From: Tomas Winkler <tomas.winkler@intel.com>
Date: Sun, 14 Dec 2014 10:17:58 +0200
Subject: [char-misc 06/11] mei: me: fix hardware reset flow
Git-commit: ff96066e3171acdea356b331163495957cb833d0
Patch-mainline: 3.12-rc1
References: bnc#876086

commit ff96066e3171acdea356b331163495957cb833d0 upstream.

Both H_IS and H_IE needs to be set to receive H_RDY
interrupt

Signed-off-by: Tomas Winkler <tomas.winkler@intel.com>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/misc/mei/init.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/misc/mei/init.c
+++ b/drivers/misc/mei/init.c
@@ -270,7 +270,7 @@ void mei_me_hw_reset_release(struct mei_
  */
 static void mei_hw_reset(struct mei_device *dev, int interrupts_enabled)
 {
-	dev->host_hw_state |= (H_RST | H_IG);
+	dev->host_hw_state |= H_RST | H_IG | H_IS;
 
 	if (interrupts_enabled)
 		mei_enable_interrupts(dev);
