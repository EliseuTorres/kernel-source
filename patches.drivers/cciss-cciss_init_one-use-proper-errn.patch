From: Andrew Morton <akpm@linux-foundation.org>
Date: Tue, 21 Jan 2014 14:39:23 -0800
Subject: drivers/block/cciss.c:cciss_init_one(): use proper errnos
References: bnc#913241,FATE#317338
Patch-Mainline: v3.15
Git-commit: 4336548af4a2e73b4d786266e520e4e595718665

pci_driver.probe should return a meaningful errno, not -1.

Cc: Jens Axboe <axboe@kernel.dk>
Cc: Stephen M. Cameron <scameron@beardog.cce.hp.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Acked-by: Hannes Reinecke <hare@suse.de>
---
 drivers/block/cciss.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/block/cciss.c b/drivers/block/cciss.c
index c27bb4f..55a4d68 100644
--- a/drivers/block/cciss.c
+++ b/drivers/block/cciss.c
@@ -4945,7 +4945,7 @@ reinit_after_soft_reset:
 
 	i = alloc_cciss_hba(pdev);
 	if (i < 0)
-		return -1;
+		return -ENOMEM;
 
 	h = hba[i];
 	prod_idx = cciss_lookup_board_id(pdev, &h->board_id);
@@ -5158,7 +5158,7 @@ clean_no_release_regions:
 	 */
 	pci_set_drvdata(pdev, NULL);
 	free_hba(h);
-	return -1;
+	return -ENODEV;
 }
 
 static void cciss_shutdown(struct pci_dev *pdev)
-- 
1.8.5.2

