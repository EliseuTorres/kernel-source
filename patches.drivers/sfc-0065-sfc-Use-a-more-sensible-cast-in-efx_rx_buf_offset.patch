From: Ben Hutchings <bhutchings@solarflare.com>
Date: Mon, 30 Jan 2012 16:55:05 +0000
Subject: sfc: Use a more sensible cast in efx_rx_buf_offset()
Patch-mainline: v3.4-rc1
Git-commit: 06e63c57acbb1df7c35ebe846ae416a8b88dfafa
References: bnc#786035 FATE#314299

This function returns the page offset of the buffer, which can be
calculated based on either its DMA address or its virtual address.  It
used to use the virtual address and we would cast that to unsigned
long, as anything smaller would result in a compiler warning.  Now
that it's using the DMA address we should use unsigned int, matching
the return type.  It is also unnecessary to use __force.

Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
Acked-by: Benjamin Poirier <bpoirier@suse.de>
---
 drivers/net/ethernet/sfc/rx.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/net/ethernet/sfc/rx.c
+++ b/drivers/net/ethernet/sfc/rx.c
@@ -97,7 +97,7 @@ static inline unsigned int efx_rx_buf_of
 	/* Offset is always within one page, so we don't need to consider
 	 * the page order.
 	 */
-	return ((__force unsigned long) buf->dma_addr & (PAGE_SIZE - 1)) +
+	return ((unsigned int) buf->dma_addr & (PAGE_SIZE - 1)) +
 		efx->type->rx_buffer_hash_size;
 }
 static inline unsigned int efx_rx_buf_size(struct efx_nic *efx)
