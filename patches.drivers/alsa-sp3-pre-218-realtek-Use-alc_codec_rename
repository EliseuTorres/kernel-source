From 84db9150b64ccad9c40e42a9967f1cf9592ebc8f Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Mon, 17 Oct 2011 16:07:43 +0200
Subject: [PATCH] ALSA: hda/realtek - Use alc_codec_rename()
Git-commit: 84db9150b64ccad9c40e42a9967f1cf9592ebc8f
Patch-mainline: 3.2-rc1
References: FATE#314311

Replaced with alc_codec_rename() in all possible places.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 sound/pci/hda/patch_realtek.c |   17 +++++++++--------
 1 file changed, 9 insertions(+), 8 deletions(-)

--- a/sound/pci/hda/patch_realtek.c
+++ b/sound/pci/hda/patch_realtek.c
@@ -5692,10 +5692,10 @@ static int patch_alc888(struct hda_codec
 	if ((coef & 0x00f0) == 0x0030) {
 		kfree(codec->chip_name);
 		if (codec->vendor_id == 0x10ec0887)
-			codec->chip_name = kstrdup("ALC887-VD", GFP_KERNEL);
+			err = alc_codec_rename(codec, "ALC887-VD");
 		else
-			codec->chip_name = kstrdup("ALC888-VD", GFP_KERNEL);
-		if (!codec->chip_name) {
+			err = alc_codec_rename(codec, "ALC888-VD");
+		if (err < 0) {
 			alc_free(codec);
 			return -ENOMEM;
 		}
@@ -5705,9 +5705,8 @@ static int patch_alc888(struct hda_codec
 	/* For ALC888S-VC */
 	if (codec->vendor_id == 0x10ec0888) {
 		if ((coef & 0xf0f0) == 0x3020) {
-			kfree(codec->chip_name);
-			codec->chip_name = kstrdup("ALC886", GFP_KERNEL);
-			if (!codec->chip_name) {
+			err = alc_codec_rename(codec, "ALC886");
+			if (err < 0) {
 				alc_free(codec);
 				return -ENOMEM;
 			}
@@ -5719,8 +5718,10 @@ static int patch_alc888(struct hda_codec
 static int patch_alc899(struct hda_codec *codec)
 {
 	if ((alc_read_coef_idx(codec, 0) & 0x2000) != 0x2000) {
-		kfree(codec->chip_name);
-		codec->chip_name = kstrdup("ALC898", GFP_KERNEL);
+		if (alc_codec_rename(codec, "ALC898") < 0) {
+			alc_free(codec);
+			return -ENOMEM;
+		}
 	}
 	return patch_alc882(codec);
 }
