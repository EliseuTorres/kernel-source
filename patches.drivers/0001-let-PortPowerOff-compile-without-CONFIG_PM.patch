From c81e47c074ffa1307417b522e0c6d9b5b1641e18 Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.de>
Date: Wed, 12 Feb 2014 12:41:08 +0100
Git-Commit: c81e47c074ffa1307417b522e0c6d9b5b1641e18
Patch-Mainline: Never (Compile fix until upstream is fixed)
References: FATE#315518
Subject: [PATCH] let PortPowerOff compile without CONFIG_PM

move the critical functions out of the conditional section

Signed-off-by: Oliver Neukum <oneukum@suse.de>
---
 drivers/usb/core/hub.c | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

diff --git a/drivers/usb/core/hub.c b/drivers/usb/core/hub.c
index 28d1218..fcfafcc 100644
--- a/drivers/usb/core/hub.c
+++ b/drivers/usb/core/hub.c
@@ -2758,6 +2758,16 @@ static int port_is_power_on(struct usb_hub *hub, unsigned portstatus)
 	return ret;
 }
 
+static void usb_lock_port(struct usb_port *port_dev)
+{
+	mutex_lock(&port_dev->status_lock);
+}
+
+static void usb_unlock_port(struct usb_port *port_dev)
+{
+	mutex_unlock(&port_dev->status_lock);
+}
+
 #ifdef	CONFIG_PM
 
 /* Check if a port is suspended(USB2.0 port) or in U3 state(USB3.0 port) */
@@ -2928,16 +2938,6 @@ static unsigned wakeup_enabled_descendants(struct usb_device *udev)
 			(hub ? hub->wakeup_enabled_descendants : 0);
 }
 
-static void usb_lock_port(struct usb_port *port_dev)
-{
-	mutex_lock(&port_dev->status_lock);
-}
-
-static void usb_unlock_port(struct usb_port *port_dev)
-{
-	mutex_unlock(&port_dev->status_lock);
-}
-
 /*
  * usb_port_suspend - suspend a usb device's upstream port
  * @udev: device that's no longer in active use, not a root hub
-- 
1.8.4

