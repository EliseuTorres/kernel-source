From: Takashi Iwai <tiwai@suse.de>
Subject: mmc: Fix re-probing after hibernation
Patch-mainline: Submitted
References: bnc#646702

The commit 4c2ef25fe0b847d2ae818f74758ddb0be1c27d8e
  mmc: fix all hangs related to mmc/sd card insert/removal during
  suspend/resume
introduced a bug where the device probing no longer works after
hibernation.  This was because the pm notifier expects
PM_POST_HIBERNATION call while the system sends PM_POST_RESTORE
instead, thus disable_rescan is kept as 1.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/mmc/core/core.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/mmc/core/core.c
+++ b/drivers/mmc/core/core.c
@@ -1331,7 +1331,7 @@
 		break;
 
 	case PM_POST_SUSPEND:
-	case PM_POST_HIBERNATION:
+	case PM_POST_RESTORE:
 
 		spin_lock_irqsave(&host->lock, flags);
 		host->rescan_disable = 0;
