From: Mauro Carvalho Chehab <mchehab@redhat.com>
Subject: edac: Don't create csrow entries on instance groups
References: fate#311968
Patch-Mainline: yes
Git-commit: c419d921e68c54232ce6d369a3b528cd7644b2ae


Signed-off-by: Thomas Renninger <trenn@suse.de>

Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

---
 drivers/edac/edac_mc_sysfs.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

Index: linux-2.6.32-SLE11-SP1/drivers/edac/edac_mc_sysfs.c
===================================================================
--- linux-2.6.32-SLE11-SP1.orig/drivers/edac/edac_mc_sysfs.c
+++ linux-2.6.32-SLE11-SP1/drivers/edac/edac_mc_sysfs.c
@@ -785,7 +785,6 @@ static struct sysfs_ops inst_grp_ops = {
 static struct kobj_type ktype_inst_grp = {
 	.release = edac_inst_grp_release,
 	.sysfs_ops = &inst_grp_ops,
-	.default_attrs = (struct attribute **)default_csrow_attr,
 };
 
 
@@ -806,13 +805,14 @@ static int edac_create_mci_instance_attr
 	while (sysfs_attrib) {
 		if (sysfs_attrib->grp) {
 			struct kobject *newkobj = &sysfs_attrib->grp->kobj;
+
 			debugf0("%s() grp %s, mci %p\n", __func__,
 				sysfs_attrib->grp->name, mci);
 
 			sysfs_attrib->grp->mci = mci;
 
 			err = kobject_init_and_add(newkobj, &ktype_inst_grp,
-						kobj,
+						&mci->edac_mci_kobj,
 						sysfs_attrib->grp->name);
 			if (err)
 				return err;
