From 6dc6c65daf8ff83766835642dda8ed522382f987 Mon Sep 17 00:00:00 2001
From: Bhanu Prakash Gollapudi <bprakash@broadcom.com>
Date: Thu, 6 Oct 2011 18:08:51 -0700
Subject: [PATCH 35/36] bnx2fc: Unable to send lun/tgt reset on SLES 11
 kernels
Patch-mainline: Never
References: bnc#722414

Unlike upstream kernel, SLES 11 kernels have return value of SUCCESS/FAILED for
fc_block_scsi_eh instead of 0. So, the return code had to be handled
accordingly for SLES kernels.

Signed-off-by: Bhanu Prakash Gollapudi <bprakash@broadcom.com>

Acked-by: Ankit Jain <jankit@suse.de>
---
 drivers/scsi/bnx2fc/bnx2fc_io.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/scsi/bnx2fc/bnx2fc_io.c b/drivers/scsi/bnx2fc/bnx2fc_io.c
index 0c64d18..5768824 100644
--- a/drivers/scsi/bnx2fc/bnx2fc_io.c
+++ b/drivers/scsi/bnx2fc/bnx2fc_io.c
@@ -715,7 +715,7 @@ static int bnx2fc_initiate_tmf(struct scsi_cmnd *sc_cmd, u8 tm_flags)
 	}
 
 	rc = fc_block_scsi_eh(sc_cmd);
-	if (rc)
+	if (rc != SUCCESS)
 		return rc;
 
 	if (lport->state != LPORT_ST_READY || !(lport->link_up)) {
@@ -1108,7 +1108,7 @@ int bnx2fc_eh_abort(struct scsi_cmnd *sc_cmd)
 
 
 	rc = fc_block_scsi_eh(sc_cmd);
-	if (rc)
+	if (rc != SUCCESS)
 		return rc;
 
 	lport = shost_priv(sc_cmd->device->host);
-- 
1.7.6.178.g55272

