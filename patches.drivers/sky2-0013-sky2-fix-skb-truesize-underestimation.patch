From: Eric Dumazet <eric.dumazet@gmail.com>
Date: Thu, 13 Oct 2011 17:12:46 -0400
Subject: [PATCH 13/49] sky2: fix skb truesize underestimation
Patch-mainline: v3.2-rc1
Git-commit: 7ae60b3f3b297b7f04025c93f1cb2275c3a1dfcd
References: bsc#909566 FATE#314306

sky2 allocates a page per skb fragment. We must account
PAGE_SIZE increments on skb->truesize, not the actual frag length.

Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Gary Ching-Pang Lin <glin@suse.com>
---
 drivers/net/ethernet/marvell/sky2.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/net/ethernet/marvell/sky2.c
+++ b/drivers/net/ethernet/marvell/sky2.c
@@ -2502,7 +2502,7 @@ static void skb_put_frags(struct sk_buff
 
 			frag->size = size;
 			skb->data_len += size;
-			skb->truesize += size;
+			skb->truesize += PAGE_SIZE;
 			skb->len += size;
 			length -= size;
 		}
