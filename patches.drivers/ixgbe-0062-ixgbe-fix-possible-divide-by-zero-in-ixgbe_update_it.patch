From: Don Skidmore <donald.c.skidmore@intel.com>
Date: Sat, 2 Mar 2013 07:17:37 +0000
Subject: ixgbe: fix possible divide by zero in ixgbe_update_itr
Patch-mainline: v3.10-rc1
Git-commit: bdbeefe8ea8c7aa1e00397641e1f3dfa41a20968
References: bug#908398 FATE#317382

Protect the code by bailing out of ixgbe_update_itr() when this occurs.
The next call to ixgbe_update_itr will continue to dynamically update ITR.

Signed-of-by: Don Skidmore <donald.c.skidmore@intel.com>
Tested-by: Phil Schmitt <phillip.j.schmitt@intel.com>

Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
Acked-by: Benjamin Poirier <bpoirier@suse.de>
---
 drivers/net/ethernet/intel/ixgbe/ixgbe_main.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
+++ b/drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
@@ -2097,6 +2097,9 @@ static void ixgbe_update_itr(struct ixgb
 	 */
 	/* what was last interrupt timeslice? */
 	timepassed_us = q_vector->itr >> 2;
+	if (timepassed_us == 0)
+		return;
+
 	bytes_perint = bytes / timepassed_us; /* bytes/usec */
 
 	switch (itr_setting) {
