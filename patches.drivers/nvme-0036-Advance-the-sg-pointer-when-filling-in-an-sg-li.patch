From: Matthew Wilcox <matthew.r.wilcox@intel.com>
Date: Thu, 10 Feb 2011 08:49:59 -0500
Subject: NVMe: Advance the sg pointer when filling in an sg list
Git-commit: 51882d00f07da9601cc962a3596e48aafb4f4163
References: FATE#313627
Patch-Mainline: v3.7-rc1

For multipage BIOs, we were always using sg[0] instead of advancing
through the list.  Oops :-)

Signed-off-by: Matthew Wilcox <matthew.r.wilcox@intel.com>
Acked-by: Hannes Reinecke <hare@suse.de>
---
 drivers/block/nvme.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/block/nvme.c b/drivers/block/nvme.c
index 71bdf6f..903e7f1 100644
--- a/drivers/block/nvme.c
+++ b/drivers/block/nvme.c
@@ -321,6 +321,7 @@ static int nvme_map_bio(struct device *dev, struct nvme_req_info *info,
 	sg_init_table(sg, psegs);
 	bio_for_each_segment(bvec, bio, i) {
 		sg_set_page(sg, bvec->bv_page, bvec->bv_len, bvec->bv_offset);
+		sg++;
 		/* XXX: handle non-mergable here */
 		nsegs++;
 	}
-- 
1.7.4.2

