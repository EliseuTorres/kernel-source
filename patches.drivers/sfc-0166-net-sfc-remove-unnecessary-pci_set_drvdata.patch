From: Jingoo Han <jg1.han@samsung.com>
Date: Mon, 9 Dec 2013 12:24:07 +0900
Subject: [PATCH v2 166/244] net: sfc: remove unnecessary pci_set_drvdata()
Patch-mainline: v3.14-rc1
Git-commit: 3166950070ce6b9d1443758d82c0a42779a02153
References: bsc#909618 FATE#317521

The driver core clears the driver data to NULL after device_release
or on probe failure. Thus, it is not needed to manually clear the
device driver data to NULL.

Signed-off-by: Jingoo Han <jg1.han@samsung.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: David Chang <dchang@suse.com>
---
 drivers/net/ethernet/sfc/efx.c |    2 --
 1 file changed, 2 deletions(-)

--- a/drivers/net/ethernet/sfc/efx.c
+++ b/drivers/net/ethernet/sfc/efx.c
@@ -2644,7 +2644,6 @@ static void efx_pci_remove(struct pci_de
 	netif_dbg(efx, drv, efx->net_dev, "shutdown successful\n");
 
 	efx_fini_struct(efx);
-	pci_set_drvdata(pci_dev, NULL);
 	free_netdev(efx->net_dev);
 
 	pci_disable_pcie_error_reporting(pci_dev);
@@ -2838,7 +2837,6 @@ static int efx_pci_probe(struct pci_dev
  fail2:
 	efx_fini_struct(efx);
  fail1:
-	pci_set_drvdata(pci_dev, NULL);
 	WARN_ON(rc > 0);
 	netif_dbg(efx, drv, efx->net_dev, "initialisation failed. rc=%d\n", rc);
 	free_netdev(net_dev);
