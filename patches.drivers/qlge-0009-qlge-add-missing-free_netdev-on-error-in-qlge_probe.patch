From: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
Date: Wed, 22 May 2013 23:09:50 +0000
Subject: [PATCH 09/32] qlge: add missing free_netdev() on error in
 qlge_probe()
Patch-mainline: v3.10-rc5
Git-commit: 4d2593cc65fa15f2a36313aa8d03a0937226ad49
References: bsc#909361 FATE#317547

Add the missing free_netdev() before return from function
qlge_probe() in the error handling case.

Signed-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
Acked-by: Jitendra Kalsaria <jitendra.kalsaria@qlogic.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Gary Ching-Pang Lin <glin@suse.com>
---
 drivers/net/ethernet/qlogic/qlge/qlge_main.c |    1 +
 1 file changed, 1 insertion(+)

--- a/drivers/net/ethernet/qlogic/qlge/qlge_main.c
+++ b/drivers/net/ethernet/qlogic/qlge/qlge_main.c
@@ -4704,6 +4704,7 @@ static int qlge_probe(struct pci_dev *pd
 		dev_err(&pdev->dev, "net device registration failed.\n");
 		ql_release_all(pdev);
 		pci_disable_device(pdev);
+		free_netdev(ndev);
 		return err;
 	}
 	/* Start up the timer to trigger EEH if
