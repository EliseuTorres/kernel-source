From: Carolyn Wyborny <carolyn.wyborny@intel.com>
Date: Thu, 13 Oct 2011 17:28:39 +0000
Subject: [PATCH] igb: Fix for Alt MAC Address feature on 82580 and later
 devices
Git-commit: 65189d284b48bd2e747e8cf9dfb0ff63b859682f
Patch-mainline: v3.2-rc1
References: bnc#725830

In 82580 and later devices, the alternate MAC address feature is
completely handled by the option ROM and software does not handle
it anymore.  This patch changes the check_alt_mac_addr function to
exit immediately if device is 82580 or later.

Signed-off-by: Carolyn Wyborny <carolyn.wyborny@intel.com>
Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
Acked-by: Lee, Chun-Yi <jlee@suse.com>
---
 drivers/net/igb/e1000_mac.c |    7 +++++++
 1 file changed, 7 insertions(+)

--- a/drivers/net/igb/e1000_mac.c
+++ b/drivers/net/igb/e1000_mac.c
@@ -190,6 +190,13 @@ s32 igb_check_alt_mac_addr(struct e1000_
 	u16 offset, nvm_alt_mac_addr_offset, nvm_data;
 	u8 alt_mac_addr[ETH_ALEN];
 
+	/*
+	 * Alternate MAC address is handled by the option ROM for 82580
+	 * and newer. SW support not required.
+	 */
+	if (hw->mac.type >= e1000_82580)
+		goto out;
+
 	ret_val = hw->nvm.ops.read(hw, NVM_ALT_MAC_ADDR_PTR, 1,
 				 &nvm_alt_mac_addr_offset);
 	if (ret_val) {

