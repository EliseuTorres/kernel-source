From 250e41ac9f31216db1b592bfd77c6a097f10503d Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Fri, 15 Jun 2012 14:40:21 +0200
Subject: [PATCH] ALSA: hda - Enable unsol event for ATI and Nvidia HDMI codecs too
Git-commit: 250e41ac9f31216db1b592bfd77c6a097f10503d
Patch-mainline: 3.6-rc1
References: FATE#313695

ATI and Nvidia HDMI codecs have also the pin-detection capability,
so let's enable the jack-detecion for them, too.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 sound/pci/hda/patch_hdmi.c |   15 +++++----------
 1 file changed, 5 insertions(+), 10 deletions(-)

--- a/sound/pci/hda/patch_hdmi.c
+++ b/sound/pci/hda/patch_hdmi.c
@@ -1401,11 +1401,9 @@ static int simple_playback_build_control
 						    spec->cvts[i].cvt_nid);
 		if (err < 0)
 			return err;
-		if (codec->patch_ops.unsol_event) {
-			err = simple_hdmi_build_jack(codec, i);
-			if (err < 0)
-				return err;
-		}
+		err = simple_hdmi_build_jack(codec, i);
+		if (err < 0)
+			return err;
 	}
 
 	return 0;
@@ -1589,6 +1587,7 @@ static const struct hda_codec_ops simple
 	.build_pcms = simple_playback_build_pcms,
 	.init = simple_playback_init,
 	.free = simple_playback_free,
+	.unsol_event = simple_hdmi_unsol_event,
 };
 
 static int patch_simple_hdmi(struct hda_codec *codec,
@@ -1875,11 +1874,7 @@ static int patch_atihdmi(struct hda_code
 
 static int patch_via_hdmi(struct hda_codec *codec)
 {
-	int err = patch_simple_hdmi(codec, VIAHDMI_CVT_NID, VIAHDMI_PIN_NID);
-	if (err < 0)
-		return err;
-	codec->patch_ops.unsol_event = simple_hdmi_unsol_event;
-	return 0;
+	return patch_simple_hdmi(codec, VIAHDMI_CVT_NID, VIAHDMI_PIN_NID);
 }
 
 /*
