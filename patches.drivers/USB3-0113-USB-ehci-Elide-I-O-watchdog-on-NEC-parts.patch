From 3681d8f3ee8f47b60b4621a3d80f8d1d39e7185b Mon Sep 17 00:00:00 2001
From: David Miller <davem@davemloft.net>
Date: Tue, 6 Apr 2010 18:26:03 -0700
Subject: USB: ehci: Elide I/O watchdog on NEC parts
Patch-mainline: v2.6.35
Git-commit: 3681d8f3ee8f47b60b4621a3d80f8d1d39e7185b

I've been running with this patch on my Niagara2 boxes for some time
and have not seen any ill effects yet.  Maybe we can stash this into
the USB tree to get exposure for some time in -next and if anything
crops up we can simply revert?

Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/host/ehci-pci.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/usb/host/ehci-pci.c
+++ b/drivers/usb/host/ehci-pci.c
@@ -160,6 +160,9 @@ static int ehci_pci_setup(struct usb_hcd
 		return retval;
 
 	switch (pdev->vendor) {
+	case PCI_VENDOR_ID_NEC:
+		ehci->need_io_watchdog = 0;
+		break;
 	case PCI_VENDOR_ID_INTEL:
 		ehci->need_io_watchdog = 0;
 		if (pdev->device == 0x27cc) {
