From: Sritej Velaga <sritej.velaga@qlogic.com>
Date: Fri, 3 Feb 2012 11:35:12 +0000
Subject: netxen_nic: Fix phy link status
Patch-mainline: v3.4-rc1
Git-commit: db608c129b5258dbdff9c221857a95bc2dc1128e
References: bnc#784815 FATE#313898

Pass the adapter phy link status to the caller.

Signed-off-by: Sritej Velaga <sritej.velaga@qlogic.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Shahed Shaikh <shahed.shaikh@qlogic.com>
Acked-by: David Chang <dchang@suse.com>
Acked-by: Benjamin Poirier <bpoirier@suse.de>
---
 drivers/net/ethernet/qlogic/netxen/netxen_nic_ctx.c |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/drivers/net/ethernet/qlogic/netxen/netxen_nic_ctx.c
+++ b/drivers/net/ethernet/qlogic/netxen/netxen_nic_ctx.c
@@ -559,7 +559,11 @@ nx_fw_cmd_query_phy(struct netxen_adapte
 	if (rcode != NX_RCODE_SUCCESS)
 		return -EIO;
 
-	return cmd.rsp.arg1;
+	if (val == NULL)
+		return -EIO;
+
+	*val = cmd.rsp.arg1;
+	return 0;
 }
 
 int
