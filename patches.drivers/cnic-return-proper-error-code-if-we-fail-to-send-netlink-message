From 258c7a606fddf27efad678b598fa225c180b7c33 Mon Sep 17 00:00:00 2001
From: Michael Chan <mchan@broadcom.com>
Date: Wed, 13 Jul 2011 17:24:20 +0000
Subject: [PATCH 4/6] cnic: Return proper error code if we fail to send netlink
 message
Git-commit: 558e4c758c4c7bf209325f5865189c6558860b2b
Patch-mainline: 3.1-rc1
References: bnc#709063

Upstream commit: 558e4c758c4c7bf209325f5865189c6558860b2b

to allow iSCSI connection to fail faster instead of waiting for the
long timeout.

Update version to 2.5.6.

Signed-off-by: Michael Chan <mchan@broadcom.com>
Reviewed-by: Matt Carlson <mcarlson@broadcom.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Jeff Mahoney <jeffm@suse.com>
---
 drivers/net/cnic.c    |    2 +-
 drivers/net/cnic_if.h |    4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/net/cnic.c b/drivers/net/cnic.c
index 96482d0..c3b1698 100644
--- a/drivers/net/cnic.c
+++ b/drivers/net/cnic.c
@@ -328,7 +328,7 @@ static int cnic_send_nlmsg(struct cnic_local *cp, u32 type,
 		msleep(100);
 		retry++;
 	}
-	return 0;
+	return rc;
 }
 
 static void cnic_cm_upcall(struct cnic_local *, struct cnic_sock *, u8);
diff --git a/drivers/net/cnic_if.h b/drivers/net/cnic_if.h
index bc7000a..642b9d5 100644
--- a/drivers/net/cnic_if.h
+++ b/drivers/net/cnic_if.h
@@ -12,8 +12,8 @@
 #ifndef CNIC_IF_H
 #define CNIC_IF_H
 
-#define CNIC_MODULE_VERSION	"2.5.3"
-#define CNIC_MODULE_RELDATE	"June 6, 2011"
+#define CNIC_MODULE_VERSION	"2.5.6"
+#define CNIC_MODULE_RELDATE	"July 12, 2011"
 
 #define CNIC_ULP_RDMA		0
 #define CNIC_ULP_ISCSI		1
-- 
1.7.1.GIT



