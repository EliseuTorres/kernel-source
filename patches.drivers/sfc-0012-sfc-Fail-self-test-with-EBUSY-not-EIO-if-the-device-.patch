From: Ben Hutchings <bhutchings@solarflare.com>
Date: Wed, 12 Feb 2014 19:00:28 +0000
Subject: sfc: Fail self-test with -EBUSY, not -EIO, if the device is busy
Patch-mainline: v3.15-rc1
Git-commit: 5eed1f68523c8cdeeafae24350200d47ddc293b7
References: bsc#923037 FATE#318563

Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
Signed-off-by: Shradha Shah <sshah@solarflare.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Benjamin Poirier <bpoirier@suse.com>
---
 drivers/net/ethernet/sfc/ethtool.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/net/ethernet/sfc/ethtool.c
+++ b/drivers/net/ethernet/sfc/ethtool.c
@@ -461,7 +461,7 @@ static void efx_ethtool_self_test(struct
 		goto fail;
 
 	if (efx->state != STATE_READY) {
-		rc = -EIO;
+		rc = -EBUSY;
 		goto out;
 	}
 
