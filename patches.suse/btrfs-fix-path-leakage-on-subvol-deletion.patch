From: Josef Bacik <josef@redhat.com>
Date: Tue, 14 Jun 2011 14:24:32 -0400
Patch-mainline: yes
References: FATE#306586
Subject: [PATCH] Btrfs: fix path leakage on subvol deletion

The delayed ref patch accidently removed the btrfs_free_path in
btrfs_unlink_subvol, this puts it back and means we don't leak a path.  Thanks,

Signed-off-by: Josef Bacik <josef@redhat.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/inode.c |    1 +
 1 file changed, 1 insertion(+)

Index: linux-2.6.32-SLE11-SP2/fs/btrfs/inode.c
===================================================================
--- linux-2.6.32-SLE11-SP2.orig/fs/btrfs/inode.c
+++ linux-2.6.32-SLE11-SP2/fs/btrfs/inode.c
@@ -3072,6 +3072,7 @@ int btrfs_unlink_subvol(struct btrfs_tra
 	BUG_ON(ret);
 	dir->i_sb->s_dirt = 1;
 
+	btrfs_free_path(path);
 	return 0;
 }
 
