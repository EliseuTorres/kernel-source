Git-commit: 54499afbb80e44ae5511984486b4b33d6229fceb
From: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
Date: Fri, 12 Oct 2012 16:59:44 +0100
Subject: [PATCH] dm bufio: use list_move
Patch-mainline: v3.7-rc1
Reference: FATE#313903

Use list_move() instead of list_del() + list_add().

spatch with a semantic match was used to find this.
(http://coccinelle.lip6.fr/)

Signed-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
Signed-off-by: Alasdair G Kergon <agk@redhat.com>
Acked-by: NeilBrown <nfbrown@suse.com>

---
 drivers/md/dm-bufio.c |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

--- linux-3.0-SLE11-SP3.orig/drivers/md/dm-bufio.c
+++ linux-3.0-SLE11-SP3/drivers/md/dm-bufio.c
@@ -440,8 +440,7 @@ static void __relink_lru(struct dm_buffe
 	c->n_buffers[b->list_mode]--;
 	c->n_buffers[dirty]++;
 	b->list_mode = dirty;
-	list_del(&b->lru_list);
-	list_add(&b->lru_list, &c->lru[dirty]);
+	list_move(&b->lru_list, &c->lru[dirty]);
 }
 
 /*----------------------------------------------------------------
