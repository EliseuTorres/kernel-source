From: Tony Jones <tonyj@suse.de>
Subject: export audit logging symbols
Upstream: no

In SLE11 the following symbols were exported by patch 'apparmor-audit.diff'
With apparmor now being a built-in these exports were removed for SP1 but 
NSS requires that audit_log_untrustedstring be exported.

Re-export both symbols to be consistent with SLE11.

Signed-Off-by: Tony Jones <tonyj@suse.de>

---
 include/linux/audit.h |    3 +++
 kernel/audit.c        |    4 +++-
 2 files changed, 6 insertions(+), 1 deletion(-)

--- a/kernel/audit.c
+++ b/kernel/audit.c
@@ -1235,7 +1235,7 @@ static inline int audit_expand(struct au
  * will be called a second time.  Currently, we assume that a printk
  * can't format message larger than 1024 bytes, so we don't either.
  */
-static void audit_log_vformat(struct audit_buffer *ab, const char *fmt,
+void audit_log_vformat(struct audit_buffer *ab, const char *fmt,
 			      va_list args)
 {
 	int len, avail;
@@ -1511,3 +1511,5 @@ EXPORT_SYMBOL(audit_log_start);
 EXPORT_SYMBOL(audit_log_end);
 EXPORT_SYMBOL(audit_log_format);
 EXPORT_SYMBOL(audit_log);
+EXPORT_SYMBOL_GPL(audit_log_vformat);
+EXPORT_SYMBOL_GPL(audit_log_untrustedstring);
--- a/include/linux/audit.h
+++ b/include/linux/audit.h
@@ -586,6 +586,9 @@ extern void		    audit_log(struct audit_
 				      __attribute__((format(printf,4,5)));
 
 extern struct audit_buffer *audit_log_start(struct audit_context *ctx, gfp_t gfp_mask, int type);
+extern void 		    audit_log_vformat(struct audit_buffer *ab,
+					const char *fmt, va_list args)
+			    __attribute__((format(printf,2,0)));
 extern void		    audit_log_format(struct audit_buffer *ab,
 					     const char *fmt, ...)
 			    __attribute__((format(printf,2,3)));
