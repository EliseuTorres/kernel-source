From 35bd3b255e86cf3218ce4d4db9219cb234769932 Mon Sep 17 00:00:00 2001
From: Mel Gorman <mgorman@suse.de>
Date: Tue, 25 Nov 2014 19:30:25 +0000
Subject: [PATCH] mm, thp: Add dummy definition for VM_NOHUGEPAGE where
 necessary

References: prctl support for disabling THP (fate#317831)
Patch-mainline: No, unnecessary

This is specific to SLE due to the lack of commit
cc2383ec06be093789469852e1fe96e1148e9a2c.  There is no need to backport that
patch and its dependencies considering that the arches we support that lack
the definition for VM_NOHUGEPAGE also do not support transparent huge pages.

Signed-off-by: Mel Gorman <mgorman@suse.de>
---
 include/linux/mm.h | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/include/linux/mm.h b/include/linux/mm.h
index 9e4124f..ff52619 100644
--- a/include/linux/mm.h
+++ b/include/linux/mm.h
@@ -81,6 +81,13 @@ extern unsigned int kobjsize(const void *objp);
 #define VM_GROWSDOWN	0x00000100	/* general info on the segment */
 #if defined(CONFIG_STACK_GROWSUP) || defined(CONFIG_IA64)
 #define VM_GROWSUP	0x00000200
+
+/*
+ * SLE: Not the same as upstream but there is no need to backport the VM flag
+ * modifications at this time. The cases where this is valid are also on arches
+ * that do not support transparent huge pages so this is ok. -mel
+ */
+#define VM_NOHUGEPAGE	0x00000000
 #else
 #define VM_GROWSUP	0x00000000
 #define VM_NOHUGEPAGE	0x00000200	/* MADV_NOHUGEPAGE marked this vma */
