From: Jens Axboe <jaxboe@fusionio.com>
Date: Wed, 30 Mar 2011 09:51:33 +0200
Subject: block: dump request state on seeing a corrupted request completion
References: FATE#312039
Patch-mainline: v2.6.39-rc2
Git-commit: 8182924bc5850281985d73c312876746acd390b5

Currently we just dump a non-informative 'request botched' message.
Lets actually try and print something sane to help debug issues
around this.

Signed-off-by: Jens Axboe <jaxboe@fusionio.com>
Acked-by: Suresh Jayaraman <sjayaraman@suse.de>
---
 block/blk-core.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: linux-2.6.32-SLE11-SP2/block/blk-core.c
===================================================================
--- linux-2.6.32-SLE11-SP2.orig/block/blk-core.c
+++ linux-2.6.32-SLE11-SP2/block/blk-core.c
@@ -2146,7 +2146,7 @@ bool blk_update_request(struct request *
 	 * size, something has gone terribly wrong.
 	 */
 	if (blk_rq_bytes(req) < blk_rq_cur_bytes(req)) {
-		printk(KERN_ERR "blk: request botched\n");
+		blk_dump_rq_flags(req, "request botched");
 		req->__data_len = blk_rq_cur_bytes(req);
 	}
 
