From afa16a942ceca5cf360e010f7cfc1151eefd9a5d Mon Sep 17 00:00:00 2001
From: Hannes Reinecke <hare@suse.de>
Date: Wed, 10 Jun 2015 14:25:55 +0200
Subject: iscsi_ibft: Define missing 'ibft_addr'
References: bsc#932047
Patch-Mainline: n/a

When compiling with CONFIG_ISCSI_IBFT_FIND disabled the 'ibft_addr'
symbol is missing. So define it in iscsi_ibft.c for these cases.

Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 drivers/firmware/iscsi_ibft.c | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/drivers/firmware/iscsi_ibft.c b/drivers/firmware/iscsi_ibft.c
index 70441f8..8e477b9 100644
--- a/drivers/firmware/iscsi_ibft.c
+++ b/drivers/firmware/iscsi_ibft.c
@@ -93,6 +93,17 @@ MODULE_DESCRIPTION("sysfs interface to BIOS iBFT information");
 MODULE_LICENSE("GPL");
 MODULE_VERSION(IBFT_ISCSI_VERSION);
 
+#ifndef CONFIG_ISCSI_IBFT_FIND
+/*
+ * Physical location of iSCSI Boot Format Table.
+ * Normally defined in iscsi_ibft_find.c, which
+ * is statically compiled in if enabled.
+ * All others need to define it here.
+ */
+struct acpi_table_ibft *ibft_addr;
+EXPORT_SYMBOL_GPL(ibft_addr);
+#endif /* CONFIG_ISCSI_IBFT_FIND */
+
 struct ibft_hdr {
 	u8 id;
 	u8 version;
-- 
1.8.5.2

