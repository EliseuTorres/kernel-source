From 96d07d211739fd2450ac54e81d00fa40fcd4b1bd Mon Sep 17 00:00:00 2001
From: Jiri Slaby <jslaby@suse.cz>
Date: Fri, 20 Nov 2009 14:16:33 +0100
Subject: [PATCH] resource: move kernel function inside __KERNEL__
References: FATE#305733
Patch-mainline: yes

It is an internal function. Move it inside __KERNEL__ ifdef, along
with task_struct declaration.

Then we get:
x--- /usr/include/linux/resource.h       2009-09-14 15:09:29.000000000 +0200
x+++ usr/include/linux/resource.h       2010-01-04 11:30:54.000000000 +0100
x -3,8 +3,6 @@
x
x #include <linux/time.h>
x
x-struct task_struct;
x-
x /*
x  * Resource control/accounting header file for linux
x  */
x@@ -70,6 +68,5 @@
x  */
x #include <asm/resource.h>
x
x-int getrusage(struct task_struct *p, int who, struct rusage *ru);
x
x #endif

***********

include/linux/Kbuild is untouched, since unifdef is run even on
headers-y nowadays.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 include/linux/resource.h |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

--- a/include/linux/resource.h
+++ b/include/linux/resource.h
@@ -3,8 +3,6 @@
 
 #include <linux/time.h>
 
-struct task_struct;
-
 /*
  * Resource control/accounting header file for linux
  */
@@ -70,6 +68,12 @@ struct rlimit {
  */
 #include <asm/resource.h>
 
+#ifdef __KERNEL__
+
+struct task_struct;
+
 int getrusage(struct task_struct *p, int who, struct rusage __user *ru);
 
+#endif /* __KERNEL__ */
+
 #endif
