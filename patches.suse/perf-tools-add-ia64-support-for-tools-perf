From: Luck, Tony <tony.luck@intel.com>
Date: Tue, 17 Nov 2009 09:05:56 -0800
Subject: perf tools: Add ia64 support for tools/perf/
Patch-mainline: v2.6.33-rc1
Git-commit: 11ada26c78febe4662a8e848f3bff74e3200c920

Compiler on ia64 rejects the "-m64" option.
Add arch specific pieces to perf.h

Modified jeffm:
- -m64 portion removed. Ultimately implemented differently and inherited
   via 2.6.32.y

Signed-off-by: Tony Luck <tony.luck@intel.com>
Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
Cc: Paul Mackerras <paulus@samba.org>
LKML-Reference: <4b02d7f43514327a@agluck-desktop.sc.intel.com>
Signed-off-by: Ingo Molnar <mingo@elte.hu>
Acked-by: Jeff Mahoney <jeffm@suse.com>
---

 tools/perf/perf.h |    6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/tools/perf/perf.h b/tools/perf/perf.h
index 216bdb2..454d5d5 100644
--- a/tools/perf/perf.h
+++ b/tools/perf/perf.h
@@ -53,6 +53,12 @@
 #define cpu_relax()	asm volatile("" ::: "memory")
 #endif
 
+#ifdef __ia64__
+#include "../../arch/ia64/include/asm/unistd.h"
+#define rmb()		asm volatile ("mf" ::: "memory")
+#define cpu_relax()	asm volatile ("hint @pause" ::: "memory")
+#endif
+
 #include <time.h>
 #include <unistd.h>
 #include <sys/types.h>

