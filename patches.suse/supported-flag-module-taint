From: Jeff Mahoney <jeffm@suse.com>
Subject: supported-flag: add taint_unsupported() call
Patch-mainline: Never, SLES feature

Several modules have features that can be enabled at runtime but
produce an unsupported system as a result. We don't need to
duplicate the taint functionality in each one.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 include/linux/module.h |   10 ++++++++++
 1 file changed, 10 insertions(+)

--- a/include/linux/module.h
+++ b/include/linux/module.h
@@ -743,4 +743,14 @@ static inline void module_bug_finalize(c
 static inline void module_bug_cleanup(struct module *mod) {}
 #endif	/* CONFIG_GENERIC_BUG */
 
+static inline void taint_unsupported(void)
+{
+#ifdef CONFIG_ENTERPRISE_SUPPORT
+	add_taint(TAINT_NO_SUPPORT);
+#ifdef MODULE
+	THIS_MODULE->taints |= (1U << TAINT_NO_SUPPORT);
+#endif
+#endif
+}
+
 #endif /* _LINUX_MODULE_H */
