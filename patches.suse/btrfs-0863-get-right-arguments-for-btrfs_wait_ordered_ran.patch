From: Liu Bo <bo.li.liu@oracle.com>
Date: Thu, 1 Nov 2012 06:38:48 +0000
Patch-mainline: 3.8
Git-commit: 9f3959c53d57d010ae6f4205fbd0159cb7976a83
References: FATE#312888
Subject: [PATCH] Btrfs: get right arguments for
 btrfs_wait_ordered_range

btrfs_wait_ordered_range expects for 'len' instead of 'end'.

Signed-off-by: Liu Bo <bo.li.liu@oracle.com>
Signed-off-by: Chris Mason <chris.mason@fusionio.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/file.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/fs/btrfs/file.c
+++ b/fs/btrfs/file.c
@@ -1558,7 +1558,7 @@ int btrfs_sync_file(struct file *file, l
 	 * range being left.
 	 */
 	atomic_inc(&root->log_batch);
-	btrfs_wait_ordered_range(inode, start, end);
+	btrfs_wait_ordered_range(inode, start, end - start + 1);
 	atomic_inc(&root->log_batch);
 
 	/*
