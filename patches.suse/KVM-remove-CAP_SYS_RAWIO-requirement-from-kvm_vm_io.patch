From: Alex Williamson <alex.williamson@redhat.com>
Subject: [PATCH] KVM: remove CAP_SYS_RAWIO requirement from kvm_vm_ioctl_assign_irq
Git-commit: 48bb09eee4e102544808c00f43bc40a4a2e43e50
Patch-mainline: 2.6.34
Reference: bnc#706131

Remove this check in an effort to allow kvm guests to run without
root privileges.  This capability check doesn't seem to add any
security since the device needs to have already been added via the
assign device ioctl and the io actually occurs through the pci
sysfs interface.

Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
Acked-by: Bruce Rogers <brogers@suse.com>
---
 virt/kvm/kvm_main.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

Index: linux-2.6.32-SLE11-SP2/virt/kvm/kvm_main.c
===================================================================
--- linux-2.6.32-SLE11-SP2.orig/virt/kvm/kvm_main.c
+++ linux-2.6.32-SLE11-SP2/virt/kvm/kvm_main.c
@@ -518,9 +518,6 @@ static int kvm_vm_ioctl_assign_irq(struc
 	struct kvm_assigned_dev_kernel *match;
 	unsigned long host_irq_type, guest_irq_type;
 
-	if (!capable(CAP_SYS_RAWIO))
-		return -EPERM;
-
 	if (!irqchip_in_kernel(kvm))
 		return r;
 
