From: Alexander Block <ablock84@googlemail.com>
Date: Wed, 1 Aug 2012 14:42:14 +0200
Patch-mainline: 3.7
Git-commit: 2f28f4787c0fc37c508cfb6b7b11c00ce5072940
References: FATE#312888
Subject: [PATCH] Btrfs: pass root instead of parent_root to
 iterate_inode_ref

We need to pass the root that we determined earlier to iterate_inode_ref.

Reported-by: Alex Lyakas <alex.bolshoy.btrfs@gmail.com>
Signed-off-by: Alexander Block <ablock84@googlemail.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/send.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/fs/btrfs/send.c
+++ b/fs/btrfs/send.c
@@ -3205,8 +3205,8 @@ static int process_all_refs(struct send_
 		    found_key.type != key.type)
 			break;
 
-		ret = iterate_inode_ref(sctx, sctx->parent_root, path,
-				&found_key, 0, cb, sctx);
+		ret = iterate_inode_ref(sctx, root, path, &found_key, 0, cb,
+				sctx);
 		btrfs_release_path(path);
 		if (ret < 0)
 			goto out;
