Subject: sched: Update rq->clock for nohz balanced cpus
From: Suresh Siddha <suresh.b.siddha@intel.com>
Date: Fri Jul 9 15:19:54 2010 +0200
Patch-mainline: commit 5343bdb8fd076f16edc9d113a9e35e2a1d1f4966
References:

Suresh spotted that we don't update the rq->clock in the nohz
load-balancer path.

Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl>
LKML-Reference: <1278626014.2834.74.camel@sbs-t61.sc.intel.com>
Signed-off-by: Ingo Molnar <mingo@elte.hu>
Acked-by: Mike Galbraith <mgalbraith@suse.de>

---
 kernel/sched_fair.c |    1 +
 1 file changed, 1 insertion(+)

Index: linux-2.6.32-SLE11-SP2/kernel/sched_fair.c
===================================================================
--- linux-2.6.32-SLE11-SP2.orig/kernel/sched_fair.c
+++ linux-2.6.32-SLE11-SP2/kernel/sched_fair.c
@@ -3719,6 +3719,7 @@ static void nohz_idle_balance(int this_c
 		}
 
 		spin_lock_irq(&this_rq->lock);
+		update_rq_clock(this_rq);
 		update_cpu_load(this_rq);
 		spin_unlock_irq(&this_rq->lock);
 
