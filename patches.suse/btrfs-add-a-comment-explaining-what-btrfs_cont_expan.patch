From: Josef Bacik <josef@redhat.com>
Date: Fri, 4 Mar 2011 15:46:53 -0500
Patch-mainline: yes
References: FATE#306586
Subject: [PATCH] Btrfs: add a comment explaining what
 btrfs_cont_expand does

Everytime I have to deal with btrfs_cont_expand I stare at it for 20 minutes
trying to remember what exactly it does and why the hell we need it.  So add a
comment to save future-Josef some time.  Thanks,

Signed-off-by: Josef Bacik <josef@redhat.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/inode.c |    6 ++++++
 1 file changed, 6 insertions(+)

--- a/fs/btrfs/inode.c
+++ b/fs/btrfs/inode.c
@@ -3554,6 +3554,12 @@ out:
 	return ret;
 }
 
+/* [not entirely accurate]
+ * This function puts in dummy file extents for the area we're creating a hole
+ * for.  So if we are truncating this file to a larger size we need to insert
+ * these file extents so that btrfs_get_extent will return a EXTENT_MAP_HOLE for
+ * the range between oldsize and size
+ */
 int btrfs_cont_expand(struct inode *inode, loff_t size)
 {
 	struct btrfs_trans_handle *trans;
