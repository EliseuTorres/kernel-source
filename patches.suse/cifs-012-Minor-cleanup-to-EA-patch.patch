From: Steve French <sfrench@us.ibm.com>
Date: Tue, 23 Feb 2010 20:51:43 +0000
Subject: [CIFS] Minor cleanup to EA patch
References: FATE#311695
Git-commit: 96c03bccc7defb1f0d486165af5c0b8590f56c11
Patch-mainline: v2.6.34-rc1

CC: Jeff Layton <jlayton@redhat.com>
Signed-off-by: Steve French <sfrench@us.ibm.com>
Signed-off-by: Suresh Jayaraman <sjayaraman@suse.de>
---
 fs/cifs/CHANGES   |    3 ++-
 fs/cifs/cifssmb.c |    2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/fs/cifs/CHANGES b/fs/cifs/CHANGES
index 49503d2..bc0025c 100644
--- a/fs/cifs/CHANGES
+++ b/fs/cifs/CHANGES
@@ -1,6 +1,7 @@
 Version 1.62
 ------------
-Add sockopt=TCP_NODELAY mount option.
+Add sockopt=TCP_NODELAY mount option. EA (xattr) routines hardened
+to more strictly handle corrupt frames.
 
 Version 1.61
 ------------
diff --git a/fs/cifs/cifssmb.c b/fs/cifs/cifssmb.c
index d6d40b8..99ae57d 100644
--- a/fs/cifs/cifssmb.c
+++ b/fs/cifs/cifssmb.c
@@ -5392,7 +5392,7 @@ QAllEAsRetry:
 	temp_fea = ea_response_data->list;
 	temp_ptr = (char *)temp_fea;
 	while (list_len > 0) {
-		__u8 name_len;
+		int name_len;
 		__u16 value_len;
 
 		list_len -= 4;
-- 
1.7.1

