From: Tom Zanussi <tzanussi@gmail.com>
Date: Tue, 15 Dec 2009 02:53:37 -0600
Subject: perf trace/scripting: Check return val of perl_run()
Patch-mainline: v2.6.33-rc1
Git-commit: 8f11d85a0e7e9025acea7493e6864089c8b52f42

The return value from perl_run() is currently ignored, but it
should be checked and used to exit perf if there are problems
loading the script.

Signed-off-by: Tom Zanussi <tzanussi@gmail.com>
Cc: fweisbec@gmail.com
Cc: rostedt@goodmis.org
LKML-Reference: <1260867220-15699-4-git-send-email-tzanussi@gmail.com>
Signed-off-by: Ingo Molnar <mingo@elte.hu>
Acked-by: Jeff Mahoney <jeffm@suse.com>
---
 tools/perf/util/trace-event-perl.c |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

diff --git a/tools/perf/util/trace-event-perl.c b/tools/perf/util/trace-event-perl.c
index 6f10e76..6d6d76b 100644
--- a/tools/perf/util/trace-event-perl.c
+++ b/tools/perf/util/trace-event-perl.c
@@ -379,7 +379,11 @@ static int perl_start_script(const char *script, int argc, const char **argv)
 		goto error;
 	}
 
-	perl_run(my_perl);
+	if (perl_run(my_perl)) {
+		err = -1;
+		goto error;
+	}
+
 	if (SvTRUE(ERRSV)) {
 		err = -1;
 		goto error;

