From: jvrao <jvrao@linux.vnet.ibm.com>
Subject: [PATCH 078/111]     net/9p: Add a Warning to catch NULL fids passed to p9_client_clunk().
Git-commit: 8e44a0805fc9d77475060280136aa491aa7d7060
Patch-Mainline: 2.6.37
References: FATE#311639

	upstream commit 8e44a0805fc9d77475060280136aa491aa7d7060

    Signed-off-by: Venkateswararao Jujjuri <jvrao@linux.vnet.ibm.com>
    Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
Signed-off-by: Harsh Prateek Bora <harsh@linux.vnet.ibm.com>
Acked-by: Bruce Rogers <brogers@suse.com>
---
 net/9p/client.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/net/9p/client.c b/net/9p/client.c
index 8c6bdd2..9ab9bf5 100644
--- a/net/9p/client.c
+++ b/net/9p/client.c
@@ -1167,6 +1167,12 @@ int p9_client_clunk(struct p9_fid *fid)
 	struct p9_client *clnt;
 	struct p9_req_t *req;
 
+	if (!fid) {
+		P9_EPRINTK(KERN_WARNING, "Trying to clunk with NULL fid\n");
+		dump_stack();
+		return 0;
+	}
+
 	P9_DPRINTK(P9_DEBUG_9P, ">>> TCLUNK fid %d\n", fid->fid);
 	err = 0;
 	clnt = fid->clnt;
-- 
1.7.1.1

