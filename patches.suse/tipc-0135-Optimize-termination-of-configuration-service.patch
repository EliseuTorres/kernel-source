From 590fbbfdc51791d84e97044632e01af0cc1a80c9 Mon Sep 17 00:00:00 2001
From: Allan Stephens <allan.stephens@windriver.com>
Date: Thu, 26 Apr 2012 17:17:39 -0400
Subject: [PATCH 135/183] tipc: Optimize termination of configuration service
Git-commit: 590fbbfdc51791d84e97044632e01af0cc1a80c9
Patch-mainline: Merged into tipc-devel
References: bnc#797455

Termination no longer tests to see if the configuration service
port was successfully created or not. In the unlikely event that the
port was not created, attempting to delete the non-existent port is
detected gracefully and causes no harm.

Signed-off-by: Allan Stephens <allan.stephens@windriver.com>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
Signed-off-by: Erik Hugne <erik.hugne@ericsson.com>
Signed-off-by: Jiri Kosina <jkosina@suse.cz>

---
 net/tipc/config.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/net/tipc/config.c b/net/tipc/config.c
index a4988cd..843d7ae 100644
--- a/net/tipc/config.c
+++ b/net/tipc/config.c
@@ -506,8 +506,6 @@ void tipc_cfg_reinit(void)
 
 void tipc_cfg_stop(void)
 {
-	if (config_port_ref) {
-		tipc_deleteport(config_port_ref);
-		config_port_ref = 0;
-	}
+	tipc_deleteport(config_port_ref);
+	config_port_ref = 0;
 }
-- 
1.7.8.3

