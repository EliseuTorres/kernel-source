From: Tsutomu Itoh <t-itoh@jp.fujitsu.com>
Date: Mon, 1 Oct 2012 03:08:37 -0600
Patch-mainline: 3.7
Git-commit: f0bd95ea72644cbf9210606f6f8edfce13d65d47
References: FATE#312888
Subject: [PATCH] Btrfs: confirmation of value is added before
 trace_btrfs_get_extent() is called

We should confirm the value of extent_map before calling
trace_btrfs_get_extent() because the value of extent_map has the
possibility of NULL.

Signed-off-by: Tsutomu Itoh <t-itoh@jp.fujitsu.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/inode.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/fs/btrfs/inode.c
+++ b/fs/btrfs/inode.c
@@ -5514,7 +5514,8 @@ insert:
 	write_unlock(&em_tree->lock);
 out:
 
-	trace_btrfs_get_extent(root, em);
+	if (em)
+		trace_btrfs_get_extent(root, em);
 
 	if (path)
 		btrfs_free_path(path);
