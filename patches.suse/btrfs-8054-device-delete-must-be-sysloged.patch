From: Anand Jain <Anand.Jain@oracle.com>
Date: Wed, 2 Jul 2014 09:37:32 +0800
Patch-mainline: 3.18
Git-commit: ec95d4917b9b5e9c73fd21294f4ff51f3127b5e7
Subject: [PATCH] btrfs: device delete must be sysloged

as in the disk add patch, disk detached from the volume must be
recorded in the syslog as well for the same reason.

Signed-off-by: Anand Jain <Anand.Jain@oracle.com>
Reviewed-by: David Sterba <dsterba@suse.cz>
Reviewed-by: Satoru Takeuchi <takeuchi_satoru@jp.fujitsu.com>
Tested-by: Satoru Takeuchi <takeuchi_satoru@jp.fujitsu.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/ioctl.c |    4 ++++
 1 file changed, 4 insertions(+)

--- a/fs/btrfs/ioctl.c
+++ b/fs/btrfs/ioctl.c
@@ -2501,6 +2501,10 @@ static long btrfs_ioctl_rm_dev(struct fi
 	mutex_unlock(&root->fs_info->volume_mutex);
 	atomic_set(&root->fs_info->mutually_exclusive_operation_running, 0);
 
+	if (!ret)
+		btrfs_info(root->fs_info, "device deleted %s",
+							vol_args->name);
+
 out:
 	kfree(vol_args);
 	mnt_drop_write_file(file);
