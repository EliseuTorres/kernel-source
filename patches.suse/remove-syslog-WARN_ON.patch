From: Jiri Slaby <jslaby@suse.cz>
Subject: Remove triggerable WARN_ONCE from check_syslog_permissions
Patch-mainline: never (not needed)

With our 11SP2 codebase, we easily trigger the WARN_ONCE on every
boot. It's because the userspace doesn't support CAP_SYSLOG yet. It
should be fixed, but still we don't want the warning to show up.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 kernel/printk.c |    7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

--- a/kernel/printk.c
+++ b/kernel/printk.c
@@ -318,12 +318,9 @@ static int check_syslog_permissions(int
 	if (syslog_action_restricted(type)) {
 		if (capable(CAP_SYSLOG))
 			return 0;
-		/* For historical reasons, accept CAP_SYS_ADMIN too, with a warning */
-		if (capable(CAP_SYS_ADMIN)) {
-			WARN_ONCE(1, "Attempt to access syslog with CAP_SYS_ADMIN "
-				 "but no CAP_SYSLOG (deprecated).\n");
+		/* For historical reasons, accept CAP_SYS_ADMIN too */
+		if (capable(CAP_SYS_ADMIN))
 			return 0;
-		}
 		return -EPERM;
 	}
 	return 0;
