From 2c744ecb1ec75ff1b6205dd372f666a043468686 Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.de>
Date: Thu, 28 Feb 2013 16:38:44 +0100
Subject: [PATCH 1/3] cdc-wdm: add helper to preserve kABI
Patch-Mainline: Never
References: bnc#806908

We need a local copy of usb_translate_errors to keep
the kabi stable

Signed-off-by: Oliver Neukum <oneukum@suse.de>
---
 drivers/usb/class/cdc-wdm.c |   15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/drivers/usb/class/cdc-wdm.c b/drivers/usb/class/cdc-wdm.c
index 545070f..e5e1016 100644
--- a/drivers/usb/class/cdc-wdm.c
+++ b/drivers/usb/class/cdc-wdm.c
@@ -27,6 +27,7 @@
 /*
  * Version Information
  */
+static inline int usb_translate_errors(int error_code);
 #define DRIVER_VERSION "v0.03"
 #define DRIVER_AUTHOR "Oliver Neukum"
 #define DRIVER_DESC "USB Abstract Control Model driver for USB WCM Device Management"
@@ -968,3 +969,17 @@ module_exit(wdm_exit);
 MODULE_AUTHOR(DRIVER_AUTHOR);
 MODULE_DESCRIPTION(DRIVER_DESC);
 MODULE_LICENSE("GPL");
+
+/* translate USB error codes to codes user space understands */
+static inline int usb_translate_errors(int error_code)
+{
+	switch (error_code) {
+	case 0:
+	case -ENOMEM:
+	case -ENODEV:
+	case -EOPNOTSUPP:
+		return error_code;
+	default:
+		return -EIO;
+	}
+}
-- 
1.7.10.4

