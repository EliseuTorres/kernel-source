From: Tony Jones <tonyj@suse.de>
Subject: drop additional perfmon2 syscalls
Patch-mainline: never

Patch accepted from SGI (FATE#303968) still adds the 12 new syscalls
which have been replaced (for SLES11) with an ioctl based interface.

Remove the relevant syscalls.

Signed-off-by: Tony Jones <tonyj@suse.de>

--- linux-2.6.31-master.orig/arch/ia64/kernel/entry.S
+++ linux-2.6.31-master/arch/ia64/kernel/entry.S
@@ -1806,18 +1806,6 @@ sys_call_table:
 	data8 sys_preadv
 	data8 sys_pwritev			// 1320
 	data8 sys_rt_tgsigqueueinfo
-	data8 sys_pfm_create_context
-	data8 sys_pfm_write_pmcs
-	data8 sys_pfm_write_pmds
-	data8 sys_pfm_read_pmds			// 1325
-	data8 sys_pfm_load_context
-	data8 sys_pfm_start
-	data8 sys_pfm_stop
-	data8 sys_pfm_restart
-	data8 sys_pfm_create_evtsets		// 1330
-	data8 sys_pfm_getinfo_evtsets
-	data8 sys_pfm_delete_evtsets
-	data8 sys_pfm_unload_context
 
 	.org sys_call_table + 8*NR_syscalls	// guard against failures to increase NR_syscalls
 #endif /* __IA64_ASM_PARAVIRTUALIZED_NATIVE */
--- linux-2.6.31-master.orig/kernel/sys_ni.c
+++ linux-2.6.31-master/kernel/sys_ni.c
@@ -134,19 +134,6 @@ cond_syscall(sys_io_cancel);
 cond_syscall(sys_io_getevents);
 cond_syscall(sys_syslog);
 
-cond_syscall(sys_pfm_create_context);
-cond_syscall(sys_pfm_write_pmcs);
-cond_syscall(sys_pfm_write_pmds);
-cond_syscall(sys_pfm_read_pmds);
-cond_syscall(sys_pfm_restart);
-cond_syscall(sys_pfm_start);
-cond_syscall(sys_pfm_stop);
-cond_syscall(sys_pfm_load_context);
-cond_syscall(sys_pfm_unload_context);
-cond_syscall(sys_pfm_create_evtsets);
-cond_syscall(sys_pfm_delete_evtsets);
-cond_syscall(sys_pfm_getinfo_evtsets);
-
 /* arch-specific weak syscall entries */
 cond_syscall(sys_pciconfig_read);
 cond_syscall(sys_pciconfig_write);
--- linux-2.6.31-master.orig/arch/ia64/include/asm/unistd.h
+++ linux-2.6.31-master/arch/ia64/include/asm/unistd.h
@@ -311,23 +311,11 @@
 #define __NR_preadv			1319
 #define __NR_pwritev			1320
 #define __NR_rt_tgsigqueueinfo		1321
-#define __NR_pfm_create_context		1319
-#define __NR_pfm_write_pmcs		(__NR_pfm_create_context+1)
-#define __NR_pfm_write_pmds		(__NR_pfm_create_context+2)
-#define __NR_pfm_read_pmds		(__NR_pfm_create_context+3)
-#define __NR_pfm_load_context		(__NR_pfm_create_context+4)
-#define __NR_pfm_start			(__NR_pfm_create_context+5)
-#define __NR_pfm_stop			(__NR_pfm_create_context+6)
-#define __NR_pfm_restart		(__NR_pfm_create_context+7)
-#define __NR_pfm_create_evtsets		(__NR_pfm_create_context+8)
-#define __NR_pfm_getinfo_evtsets 	(__NR_pfm_create_context+9)
-#define __NR_pfm_delete_evtsets 	(__NR_pfm_create_context+10)
-#define __NR_pfm_unload_context		(__NR_pfm_create_context+11)
 
 #ifdef __KERNEL__
 
 
-#define NR_syscalls			310 /* length of syscall table */
+#define NR_syscalls			298 /* length of syscall table */
 
 /*
  * The following defines stop scripts/checksyscalls.sh from complaining about
