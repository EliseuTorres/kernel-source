From: Al Viro <viro@zeniv.linux.org.uk>
Date: Thu, 19 Jul 2012 11:17:49 +0400
Patch-mainline: 3.6
Git-commit: 11e62a8fabd003352e852e74e1b64a437fd908c6
References: FATE#312888
Subject: [PATCH] btrfs: switch btrfs_ioctl_balance() to
 mnt_want_write_file()

Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/ioctl.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/fs/btrfs/ioctl.c
+++ b/fs/btrfs/ioctl.c
@@ -3275,7 +3275,7 @@ static long btrfs_ioctl_balance(struct f
 	if (fs_info->sb->s_flags & MS_RDONLY)
 		return -EROFS;
 
-	ret = mnt_want_write(file->f_path.mnt);
+	ret = mnt_want_write_file(file);
 	if (ret)
 		return ret;
 
@@ -3345,7 +3345,7 @@ out_bargs:
 out:
 	mutex_unlock(&fs_info->balance_mutex);
 	mutex_unlock(&fs_info->volume_mutex);
-	mnt_drop_write(file->f_path.mnt);
+	mnt_drop_write_file(file);
 	return ret;
 }
 
