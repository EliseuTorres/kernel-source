From: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com>
Subject: [PATCH 046/111]     net/9p: Handle the server returned error properly
Git-commit: 69d4b4436b54c1a850d475697fda5ca117b09a5e
Patch-Mainline: 2.6.36
References: FATE#311639

    We need to get the negative errno value in the kernel
    even for dotl.

	upstream commit: 69d4b4436b54c1a850d475697fda5ca117b09a5e

    Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com>
    Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
Signed-off-by: Harsh Prateek Bora <harsh@linux.vnet.ibm.com>
Acked-by: Bruce Rogers <brogers@suse.com>
---
 net/9p/client.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/net/9p/client.c b/net/9p/client.c
index 5398b98..bb15cb1 100644
--- a/net/9p/client.c
+++ b/net/9p/client.c
@@ -459,7 +459,8 @@ static int p9_check_errors(struct p9_client *c, struct p9_req_t *req)
 			return err;
 		}
 
-		if (p9_is_proto_dotu(c))
+		if (p9_is_proto_dotu(c) ||
+			p9_is_proto_dotl(c))
 			err = -ecode;
 
 		if (!err || !IS_ERR_VALUE(err))
-- 
1.7.1.1

