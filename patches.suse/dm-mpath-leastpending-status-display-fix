From: Hannes Reinecke <hare@suse.de>
Subject: dm-leastpending does not work with multipath-tools
References: bnc#653850
Patch-Mainline: n/a

When selecting 'least-pending' as path selector multipath-tools fail
to configure the maps properly. The reason here is that the
'dm-least-pending' module does not issue a proper status string.

Signed-off-by: Hannes Reinecke <hare@suse.de>

diff --git a/drivers/md/dm-least-pending.c b/drivers/md/dm-least-pending.c
index 279bfdf..2cbb7c3 100644
--- a/drivers/md/dm-least-pending.c
+++ b/drivers/md/dm-least-pending.c
@@ -98,6 +98,7 @@ static int lpp_status(struct path_selector *ps, struct dm_path *path,
 					 atomic_read(&pi->io_count));
 		break;
 		case STATUSTYPE_TABLE:
+			DMEMIT("%u ", pi->repeat_count);
 		break;
 		}
 	}
