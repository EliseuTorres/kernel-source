From: Christoph Hellwig <hch@lst.de>
Date: Tue, 2 Sep 2014 21:27:59 -0700
Subject: [PATCH] pnfs: add a nfs4_get_deviceid helper
Git-commit: 30ff0603ca4d66c8244efc80ea8470d3d04aee8b
Patch-mainline: v3.18
References: bnc#898675

This will be used by the block layout driver when splitting extents.

Signed-off-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Trond Myklebust <trond.myklebust@primarydata.com>
Acked-by: NeilBrown <neilb@suse.de>

---
 fs/nfs/pnfs.h |    7 +++++++
 1 file changed, 7 insertions(+)

--- linux-3.12-SLE12.orig/fs/nfs/pnfs.h
+++ linux-3.12-SLE12/fs/nfs/pnfs.h
@@ -282,6 +282,13 @@ void nfs4_deviceid_purge_client(const st
 int nfs4_deviceid_getdevicelist(struct nfs_server *server,
 		const struct nfs_fh *fh);
 
+static inline struct nfs4_deviceid_node *
+nfs4_get_deviceid(struct nfs4_deviceid_node *d)
+{
+	atomic_inc(&d->ref);
+	return d;
+}
+
 static inline struct pnfs_layout_segment *
 pnfs_get_lseg(struct pnfs_layout_segment *lseg)
 {
