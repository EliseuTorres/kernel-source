From: Josef Bacik <josef@redhat.com>
Date: Thu, 5 Apr 2012 14:42:44 -0400
Patch-mainline: 3.6
Git-commit: c5c3c5f31e6af2d12b154251a7f23b7f4add6b1d
References: FATE#312888
Subject: [PATCH] Btrfs: remove ->dirty_inode

We do all of our inode updating when we change it, and now that we do
->update_time we don't need ->dirty_inode for atime updates anymore, so just
remove it.  Thanks,

Signed-off-by: Josef Bacik <josef@redhat.com>
Signed-off-by: David Sterba <dsterba@suse.cz>
---
 fs/btrfs/super.c |   11 -----------
 1 file changed, 11 deletions(-)

--- a/fs/btrfs/super.c
+++ b/fs/btrfs/super.c
@@ -1507,16 +1507,6 @@ static int btrfs_unfreeze(struct super_b
 	return 0;
 }
 
-static void btrfs_fs_dirty_inode(struct inode *inode, int flags)
-{
-	int ret;
-
-	ret = btrfs_dirty_inode(inode);
-	if (ret)
-		printk_ratelimited(KERN_ERR "btrfs: fail to dirty inode %Lu "
-				   "error %d\n", btrfs_ino(inode), ret);
-}
-
 static int btrfs_show_devname(struct seq_file *m, struct vfsmount *vfs)
 {
 	struct btrfs_fs_info *fs_info = btrfs_sb(vfs->mnt_sb);
@@ -1556,7 +1546,6 @@ static const struct super_operations btr
 	.show_options	= btrfs_show_options,
 	.show_devname	= btrfs_show_devname,
 	.write_inode	= btrfs_write_inode,
-	.dirty_inode	= btrfs_fs_dirty_inode,
 	.alloc_inode	= btrfs_alloc_inode,
 	.destroy_inode	= btrfs_destroy_inode,
 	.statfs		= btrfs_statfs,
