From http://xenbits.xen.org/hg/linux-2.6.18-xen.hg/rev/4b8e7a5d4f89
From: xen-devel@lists.xen.org
Patch-mainline: n/a
Subject: pciback: rate limit error message from pciback_enable_msi()
References: CVE-2013-0231 XSA-43 bnc#801178

... as being guest triggerable (e.g. by invoking XEN_PCI_OP_enable_msi
on a device not being MSI capable).

Signed-off-by: Jan Beulich <jbeulich@suse.com>

--- sle11sp2.orig/drivers/xen/pciback/conf_space_capability_msi.c	2009-05-15 13:19:20.000000000 +0200
+++ sle11sp2/drivers/xen/pciback/conf_space_capability_msi.c	2013-01-28 09:30:29.000000000 +0100
@@ -11,13 +11,12 @@
 int pciback_enable_msi(struct pciback_device *pdev,
 		struct pci_dev *dev, struct xen_pci_op *op)
 {
-	int otherend = pdev->xdev->otherend_id;
-	int status;
-
-	status = pci_enable_msi(dev);
+	int status = pci_enable_msi(dev);
 
 	if (status) {
-		printk("error enable msi for guest %x status %x\n", otherend, status);
+		if (printk_ratelimit())
+			printk("error enabling MSI for guest %u status %d\n",
+			       pdev->xdev->otherend_id, status);
 		op->value = 0;
 		return XEN_PCI_ERR_op_failed;
 	}
