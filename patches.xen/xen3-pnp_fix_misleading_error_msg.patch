From: Zhang Rui <rui.zhang@intel.com>
Subject: PNP ACPI:  Fix a buggy debug messagge.
References: bnc#720750
Patch-Mainline: submitted

Signed-off-by: Zhang Rui <rui.zhang@intel.com>
Acked-by: Yinghai Lu <yinghai@kernel.org>
Signed-off-by: Thomas Renninger <trenn@suse.de>

Automatically created from "patches.drivers/pnp_fix_misleading_error_msg.patch" by xen-port-patches.py

--- sle11sp2-2011-11-22.orig/arch/x86/kernel/apic/io_apic-xen.c	2011-07-04 14:54:36.000000000 +0200
+++ sle11sp2-2011-11-22/arch/x86/kernel/apic/io_apic-xen.c	2011-11-22 11:42:25.000000000 +0100
@@ -3713,17 +3713,14 @@ int io_apic_set_pci_routing(struct devic
 	int node;
 
 #ifdef CONFIG_XEN
-	if (irq < PIRQ_BASE || irq >= PIRQ_BASE + nr_pirqs) {
+	if (irq < PIRQ_BASE || irq >= PIRQ_BASE + nr_pirqs || !IO_APIC_IRQ(irq)) {
+#else
+	if (!IO_APIC_IRQ(irq)) {
+#endif
 		apic_printk(APIC_QUIET,KERN_ERR "IOAPIC[%d]: Invalid reference to IRQ %d\n",
 			    irq_attr->ioapic, irq);
 		return -EINVAL;
 	}
-#endif
-	if (!IO_APIC_IRQ(irq)) {
-		apic_printk(APIC_QUIET,KERN_ERR "IOAPIC[%d]: Invalid reference to IRQ 0\n",
-			    irq_attr->ioapic);
-		return -EINVAL;
-	}
 
 	node = dev ? dev_to_node(dev) : cpu_to_node(0);
 
