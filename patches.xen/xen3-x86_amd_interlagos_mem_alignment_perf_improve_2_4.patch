From: Borislav Petkov <bp@amd64.org>
Subject: x86: Add a BSP cpu_dev helper
References: bnc#711285
Patch-Mainline: queued in x86-tip for 3.2
Git-repo: git://git.kernel.org/pub/scm/linux/kernel/git/mingo/linux-2.6-x86
Git-commit: a110b5ec7371592eac856ac5c22dc7b518952d44


Acked-by: Mel Gorman <mgorman@novell.com>
Signed-off-by: Thomas Renninger <trenn@suse.de>

Add a function ptr to struct cpu_dev which is destined to be run only
once on the BSP during boot.

Signed-off-by: Borislav Petkov <borislav.petkov@amd.com>
Link: http://lkml.kernel.org/r/20110805180116.GB26217@aftab
Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>

Automatically created from "patches.arch/x86_amd_interlagos_mem_alignment_perf_improve_2_4.patch" by xen-port-patches.py

--- sle11sp2-2011-09-22.orig/arch/x86/kernel/cpu/common-xen.c	2011-07-01 15:19:34.000000000 +0200
+++ sle11sp2-2011-09-22/arch/x86/kernel/cpu/common-xen.c	2011-09-22 14:53:53.000000000 +0200
@@ -716,6 +716,9 @@ static void __init early_identify_cpu(st
 	filter_cpuid_features(c, false);
 
 	setup_smep(c);
+
+	if (this_cpu->c_bsp_init)
+		this_cpu->c_bsp_init(c);
 }
 
 void __init early_cpu_init(void)
