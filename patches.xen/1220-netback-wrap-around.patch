From http://xenbits.xen.org/hg/linux-2.6.18-xen.hg/rev/d962d1681b10
From: xen-devel@lists.xen.org
Patch-mainline: n/a
Subject: netback: correct netbk_tx_err() to handle wrap around
References: CVE-2013-0216 XSA-39 bnc#800280

Signed-off-by: Ian Campbell <ian.campbell@citrix.com>
Signed-off-by: Jan Beulich <jbeulich@suse.com>

--- sle11sp2.orig/drivers/xen/netback/netback.c	2013-01-24 12:10:07.000000000 +0100
+++ sle11sp2/drivers/xen/netback/netback.c	2013-01-24 12:10:21.000000000 +0100
@@ -1019,7 +1019,7 @@ static void netbk_tx_err(netif_t *netif,
 
 	do {
 		make_tx_response(netif, txp, NETIF_RSP_ERROR);
-		if (cons >= end)
+		if (cons == end)
 			break;
 		txp = RING_GET_REQUEST(&netif->tx, cons++);
 	} while (1);
