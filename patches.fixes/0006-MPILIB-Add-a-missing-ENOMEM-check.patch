From: David Howells <dhowells@redhat.com>
Date: Wed, 18 Jan 2012 10:03:54 +0000
Subject: [PATCH] MPILIB: Add a missing ENOMEM check
Git-commit: 4bf1924c008dffdc154f82507b4052e49263a6f4
Patch-mainline: v3.3
References: fate#314508
Target: SLE-11 SP3

Add a missing ENOMEM check.

Signed-off-by: David Howells <dhowells@redhat.com>
Acked-by: Mimi Zohar <zohar@us.ibm.com>
Signed-off-by: James Morris <jmorris@namei.org>
Acked-by: Lee, Chun-Yi <jlee@suse.com>
---
 lib/mpi/mpicoder.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/lib/mpi/mpicoder.c
+++ b/lib/mpi/mpicoder.c
@@ -255,6 +255,8 @@ void *mpi_get_buffer(MPI a, unsigned *nb
 	if (!n)
 		n++;		/* avoid zero length allocation */
 	p = buffer = kmalloc(n, GFP_KERNEL);
+	if (!p)
+		return NULL;
 
 	for (i = a->nlimbs - 1; i >= 0; i--) {
 		alimb = a->d[i];
