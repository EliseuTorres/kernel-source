From coly.li@suse.de  Fri Sep 24 14:30:43 2010
From: Coly Li <coly.li@suse.de>
Date: Mon, 19 Jul 2010 13:55:10 -0700
Subject: [PATCH 134/314] ocfs2: one more warning fix in ocfs2_file_aio_write(), v2
 MIME-Version: 1.0 Content-Type: text/plain; charset=UTF-8
 Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Oracle-commit: 40ed0ee47dad5e75b22eb6286019784d7914f5f8
Git-commit: a03ab788d070c256eff1ac24cf0e3bc2ca148096
Patch-mainline: 2.6.34-rc7

Mainline commit a03ab788d070c256eff1ac24cf0e3bc2ca148096
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This patch fixes another compiling warning in ocfs2_file_aio_write() like this,
    fs/ocfs2/file.c: In function ‘ocfs2_file_aio_write’:
    fs/ocfs2/file.c:2026: warning: suggest parentheses around ‘&&’ within ‘||’

As Joel suggested, '!ret' is unary, this version removes the wrap from '!ret'.

Signed-off-by: Coly Li <coly.li@suse.de>
Signed-off-by: Joel Becker <joel.becker@oracle.com>
Acked-by: Jeff Mahoney <jeffm@suse.com>
Signed-off-by: Mark Fasheh <mfasheh@suse.com>
---
 fs/ocfs2/file.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/fs/ocfs2/file.c b/fs/ocfs2/file.c
index d43dbaf..d76ef5c 100644
--- a/fs/ocfs2/file.c
+++ b/fs/ocfs2/file.c
@@ -2020,10 +2020,9 @@ out_dio:
 		if (ret < 0)
 			written = ret;
 
-		if (!ret &&
-		    (old_size != i_size_read(inode) ||
-		     old_clusters != OCFS2_I(inode)->ip_clusters) ||
-		    has_refcount) {
+		if (!ret && ((old_size != i_size_read(inode)) ||
+			     (old_clusters != OCFS2_I(inode)->ip_clusters) ||
+			     has_refcount)) {
 			ret = jbd2_journal_force_commit(osb->journal->j_journal);
 			if (ret < 0)
 				written = ret;
-- 
1.7.1

