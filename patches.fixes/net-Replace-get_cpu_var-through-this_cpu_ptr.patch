From: Christoph Lameter <cl@linux.com>
Date: Sun, 17 Aug 2014 12:30:35 -0500
Subject: net: Replace get_cpu_var through this_cpu_ptr
Patch-mainline: v3.18-rc1
Git-commit: 903ceff7ca7b4d80c083a80ee5163b74e9fa359f (partial)
References: FATE#318825

Replace uses of get_cpu_var for address calculation through this_cpu_ptr.

Cc: netdev@vger.kernel.org
Cc: Eric Dumazet <edumazet@google.com>
Acked-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Christoph Lameter <cl@linux.com>
Signed-off-by: Tejun Heo <tj@kernel.org>
Acked-by: Benjamin Poirier <bpoirier@suse.de>
---
 net/core/drop_monitor.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/net/core/drop_monitor.c
+++ b/net/core/drop_monitor.c
@@ -141,7 +141,7 @@ static void trace_drop_common(struct sk_
 	unsigned long flags;
 
 	local_irq_save(flags);
-	data = &__get_cpu_var(dm_cpu_data);
+	data = this_cpu_ptr(&dm_cpu_data);
 	spin_lock(&data->lock);
 	dskb = data->skb;
 
