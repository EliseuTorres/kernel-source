From 1396a21ba0d4ec381db19bc9cd5b6f25a89cf633 Mon Sep 17 00:00:00 2001
From: Martin Hicks <mort@sgi.com>
Date: Wed, 21 Jul 2010 19:27:05 -0500
Subject: kdb: break out of kdb_ll() when command is terminated
Patch-mainline: 2.6.35-rc6
References: bnc#609172
Git-commit: 1396a21ba0d4ec381db19bc9cd5b6f25a89cf633

Without this patch the "ll" linked-list traversal command won't
terminate when you hit q/Q.

Signed-off-by: Martin Hicks <mort@sgi.com>
Signed-off-by: Jason Wessel <jason.wessel@windriver.com>
Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 kdb/kdbmain.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/kdb/kdbmain.c
+++ b/kdb/kdbmain.c
@@ -3472,6 +3472,9 @@ kdb_ll(int argc, const char **argv)
 	while (va) {
 		char buf[80];
 
+		if (KDB_FLAG(CMD_INTERRUPT))
+			return 0;
+
 		sprintf(buf, "%s " kdb_machreg_fmt "\n", command, va);
 		diag = kdb_parse(buf);
 		if (diag)
