From: Rafael J. Wysocki <rjw@suse.de>
Subject: PM / Hibernate: Make some boot messages look less scary
Patch-mainline: Not yet
References: bnc#614226
    
The hibernate resume code checks if there is an image to resume from
on every boot and, if the kernel is built with CONFIG_PM_DEBUG set
and the image is not present, it prints some scary messages
suggesting there was a boot error of some sort.  Apparently, some
users are confused by them, so make them look less scary and adjust
the other hibernate resume debug messages to match them.
    
Signed-off-by: Rafael J. Wysocki <rjw@suse.de>

---
 kernel/power/hibernate.c |   12 ++++++------
 kernel/power/swap.c      |    4 ++--
 2 files changed, 8 insertions(+), 8 deletions(-)

Index: linux-2.6.32-SLE11-SP1/kernel/power/hibernate.c
===================================================================
--- linux-2.6.32-SLE11-SP1.orig/kernel/power/hibernate.c
+++ linux-2.6.32-SLE11-SP1/kernel/power/hibernate.c
@@ -657,7 +657,7 @@ static int software_resume(void)
 		goto Unlock;
 	}
 
-	pr_debug("PM: Checking image partition %s\n", resume_file);
+	pr_debug("PM: Checking hibernation image partition %s\n", resume_file);
 
 	/* Check if the device is there */
 	swsusp_resume_device = name_to_dev_t(resume_file);
@@ -682,10 +682,10 @@ static int software_resume(void)
 	}
 
  Check_image:
-	pr_debug("PM: Resume from partition %d:%d\n",
+	pr_debug("PM: Hibernation image partition %d:%d present\n",
 		MAJOR(swsusp_resume_device), MINOR(swsusp_resume_device));
 
-	pr_debug("PM: Checking hibernation image.\n");
+	pr_debug("PM: Looking for hibernation image.\n");
 	error = swsusp_check();
 	if (error)
 		goto Unlock;
@@ -717,14 +717,14 @@ static int software_resume(void)
 		goto Done;
 	}
 
-	pr_debug("PM: Reading hibernation image.\n");
+	pr_debug("PM: Loading hibernation image.\n");
 
 	error = swsusp_read(&flags);
 	swsusp_close(FMODE_READ);
 	if (!error)
 		hibernation_restore(flags & SF_PLATFORM_MODE);
 
-	printk(KERN_ERR "PM: Restore failed, recovering.\n");
+	printk(KERN_ERR "PM: Failed to load hibernation image, recovering.\n");
 	swsusp_free();
 	thaw_processes();
  Done:
@@ -737,7 +737,7 @@ static int software_resume(void)
 	/* For success case, the suspend path will release the lock */
  Unlock:
 	mutex_unlock(&pm_mutex);
-	pr_debug("PM: Resume from disk failed.\n");
+	pr_debug("PM: Hibernation image not present or could not be loaded.\n");
 	return error;
 close_finish:
 	swsusp_close(FMODE_READ);
Index: linux-2.6.32-SLE11-SP1/kernel/power/swap.c
===================================================================
--- linux-2.6.32-SLE11-SP1.orig/kernel/power/swap.c
+++ linux-2.6.32-SLE11-SP1/kernel/power/swap.c
@@ -610,13 +610,13 @@ put:
 		if (error)
 			blkdev_put(resume_bdev, FMODE_READ);
 		else
-			pr_debug("PM: Signature found, resuming\n");
+			pr_debug("PM: Image signature found, resuming\n");
 	} else {
 		error = PTR_ERR(resume_bdev);
 	}
 
 	if (error)
-		pr_debug("PM: Error %d checking image file\n", error);
+		pr_debug("PM: Image not found (code %d)\n", error);
 
 	return error;
 }
