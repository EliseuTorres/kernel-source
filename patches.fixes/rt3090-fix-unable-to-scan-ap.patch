From: Chen, Chien-Chia <machen@novell.com>
Subject: Fix RT3090 scan AP function
Patch-mainline: Hopefully after 2.6.37
References: bnc#656471

Fix RT3090 scan AP function.

This patch fixes the rt3090 wireless module failed
to scan AP around due to  Windows driver causing
rt3090 module unable to scan AP in Linux.


Acked-by: Lee, Chun-Yi <jlee@novell.com>
Signed-off-by: Chen, Chien-Chia <machen@novell.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/staging/rt3090/chips/rt3090.c |    3 ++-
 drivers/staging/rt3090/chips/rt30xx.c |    4 ++--
 2 files changed, 4 insertions(+), 3 deletions(-)

--- a/drivers/staging/rt3090/chips/rt3090.c
+++ b/drivers/staging/rt3090/chips/rt3090.c
@@ -54,7 +54,8 @@ VOID NICInitRT3090RFRegisters(IN PRTMP_A
 	{
 		// Init RF calibration
 		// Driver should toggle RF R30 bit7 before init RF registers
-		UINT32 RfReg = 0, data;
+		UINT8 RfReg;
+		UINT32 data;
 
 		RT30xxReadRFRegister(pAd, RF_R30, (PUCHAR)&RfReg);
 		RfReg |= 0x80;
--- a/drivers/staging/rt3090/chips/rt30xx.c
+++ b/drivers/staging/rt3090/chips/rt30xx.c
@@ -53,7 +53,7 @@ REG_PAIR   RT30xx_RFRegTable[] = {
         {RF_R04,          0x40},
         {RF_R05,          0x03},
         {RF_R06,          0x02},
-        {RF_R07,          0x70},
+        {RF_R07,          0x60},
         {RF_R09,          0x0F},
         {RF_R10,          0x41},
         {RF_R11,          0x21},
@@ -446,7 +446,7 @@ VOID RT30xxReverseRFSleepModeSetup(
 
 		// VCO_IC, RF R7 register Bit 4 & Bit 5 to 1
 		RT30xxReadRFRegister(pAd, RF_R07, &RFValue);
-		RFValue |= 0x30;
+		RFValue |= 0x20;
 		RT30xxWriteRFRegister(pAd, RF_R07, RFValue);
 
 		// Idoh, RF R9 register Bit 1, Bit 2 & Bit 3 to 1
