From: Jeff Mahoney <jeffm@suse.com>
Subject: megaraid_sas: Fix permissions on poll_mode_io
References: bnc#557180 CVE-2009-3939

 This patch fixes the permissions on the poll_mode_io sysfs file
 for megaraid_sas. Otherwise, it's world writable.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 drivers/scsi/megaraid/megaraid_sas.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/scsi/megaraid/megaraid_sas.c
+++ b/drivers/scsi/megaraid/megaraid_sas.c
@@ -4042,7 +4042,7 @@ megasas_aen_polling(struct work_struct *
 }
 
 
-static DRIVER_ATTR(poll_mode_io, S_IRUGO|S_IWUGO,
+static DRIVER_ATTR(poll_mode_io, S_IRUGO|S_IWUSR,
 		megasas_sysfs_show_poll_mode_io,
 		megasas_sysfs_set_poll_mode_io);
 
