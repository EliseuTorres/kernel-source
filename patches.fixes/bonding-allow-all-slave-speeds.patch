From: Jiri Pirko <jpirko@redhat.com>
Date: Wed, 1 Jun 2011 10:36:33 +0000
Subject: bonding: allow all slave speeds
Git-commit: 6f92c66f7190b1677ea666249b72298723392115
Patch-mainline: 3.1
References: bnc#771428

No need to check for 10, 100, 1000, 10000 explicitly. Just make this
generic and check for invalid values only (similar check is in ethtool
userspace app). This enables correct speed handling for slave devices
with "nonstandard" speeds.

Signed-off-by: Jiri Pirko <jpirko@redhat.com>
Reviewed-by: Nicolas de Peslo√ºan <nicolas.2p.debian@free.fr>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Jean Delvare <jdelvare@suse.de>

---
 drivers/net/bonding/bond_main.c |    9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

--- a/drivers/net/bonding/bond_main.c
+++ b/drivers/net/bonding/bond_main.c
@@ -635,15 +635,8 @@ static int bond_update_speed_duplex(stru
 		return -1;
 
 	slave_speed = ethtool_cmd_speed(&etool);
-	switch (slave_speed) {
-	case SPEED_10:
-	case SPEED_100:
-	case SPEED_1000:
-	case SPEED_10000:
-		break;
-	default:
+	if (slave_speed == 0 || slave_speed == ((__u32) -1))
 		return -1;
-	}
 
 	switch (etool.duplex) {
 	case DUPLEX_FULL:
