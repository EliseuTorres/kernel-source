From sunil.mushran@oracle.com  Fri Sep 24 14:30:46 2010
From: Sunil Mushran <sunil.mushran@oracle.com>
Date: Wed, 1 Sep 2010 16:19:25 -0700
Subject: [PATCH 268/314] ocfs2: replace USHORT_MAX,
 SHORT_MAX and SHORT_MIN with USHRT_MAX, SHRT_MAX and SHRT_MIN
Oracle-commit: a0f57b7bd9348bc22dc29929bac0f64848d81ce3
Git-commit: 4be929be34f9bdeffa40d815d32d7d60d2c7f03b
Patch-mainline: 2.6.35-rc1

Derived from mainline commit 4be929be34f9bdeffa40d815d32d7d60d2c7f03b

Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com>
Acked-by: Jeff Mahoney <jeffm@suse.com>
Signed-off-by: Mark Fasheh <mfasheh@suse.com>
---
 fs/ocfs2/blockcheck.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/fs/ocfs2/blockcheck.c b/fs/ocfs2/blockcheck.c
index b7428c5..cfaba0e 100644
--- a/fs/ocfs2/blockcheck.c
+++ b/fs/ocfs2/blockcheck.c
@@ -33,6 +33,12 @@
 
 #include "blockcheck.h"
 
+/* Mainline commit 4be929be34f9bdeffa40d815d32d7d60d2c7f03b */
+#ifndef USHRT_MAX
+# define USHRT_MAX	((u16)(~0U))
+# define SHRT_MAX	((s16)(USHRT_MAX>>1))
+# define SHRT_MIN	((s16)(-SHRT_MAX - 1))
+#endif
 
 /*
  * We use the following conventions:
@@ -403,7 +409,7 @@ void ocfs2_block_check_compute(void *data, size_t blocksize,
 	 * No ecc'd ocfs2 structure is larger than 4K, so ecc will be no
 	 * larger than 16 bits.
 	 */
-	BUG_ON(ecc > USHORT_MAX);
+	BUG_ON(ecc > USHRT_MAX);
 
 	bc->bc_crc32e = cpu_to_le32(crc);
 	bc->bc_ecc = cpu_to_le16((u16)ecc);
@@ -508,7 +514,7 @@ void ocfs2_block_check_compute_bhs(struct buffer_head **bhs, int nr,
 	 * No ecc'd ocfs2 structure is larger than 4K, so ecc will be no
 	 * larger than 16 bits.
 	 */
-	BUG_ON(ecc > USHORT_MAX);
+	BUG_ON(ecc > USHRT_MAX);
 
 	bc->bc_crc32e = cpu_to_le32(crc);
 	bc->bc_ecc = cpu_to_le16((u16)ecc);
-- 
1.7.1

