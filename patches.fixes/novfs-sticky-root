From: Sankar P <psankar@novell.com>
Subject: novfs: Set the sticky bit for the novfs mountpoint
References: bnc#686412
Patch-mainline: No

The file permission of the novfs mount is world-writeable
and not having the sticky bit set. The patch fixes this issue.

Signed-off-by: Sankar P <psankar@novell.com>
Reported-by: Shaun Price <sprice@novell.com>

diff --git a/fs/novfs/inode.c b/fs/novfs/inode.c
index 56e055a..3c40c8d 100644
--- a/fs/novfs/inode.c
+++ b/fs/novfs/inode.c
@@ -3370,7 +3370,7 @@ int novfs_fill_super(struct super_block *SB, void *Data, int Silent)
 	name.len = 1;
 	name.name = "/";
 
-	inode = novfs_get_inode(SB, S_IFDIR | 0777, 0, 0, 0, &name);
+	inode = novfs_get_inode(SB, S_IFDIR | 01777, 0, 0, 0, &name);
 	if (!inode) {
 		return (-ENOMEM);
 	}
@@ -3396,7 +3396,7 @@ int novfs_fill_super(struct super_block *SB, void *Data, int Silent)
 		name.len = strlen(SERVER_DIRECTORY_NAME);
 		name.hash = novfs_internal_hash(&name);
 
-		inode = novfs_get_inode(SB, S_IFDIR | 0777, 0, 0, 0, &name);
+		inode = novfs_get_inode(SB, S_IFDIR | 01777, 0, 0, 0, &name);
 		if (inode) {
 			info.mode = inode->i_mode;
 			info.namelength = 0;
@@ -3419,7 +3419,7 @@ int novfs_fill_super(struct super_block *SB, void *Data, int Silent)
 		name.len = strlen(TREE_DIRECTORY_NAME);
 		name.hash = novfs_internal_hash(&name);
 
-		inode = novfs_get_inode(SB, S_IFDIR | 0777, 0, 0, 0, &name);
+		inode = novfs_get_inode(SB, S_IFDIR | 01777, 0, 0, 0, &name);
 		if (inode) {
 			info.mode = inode->i_mode;
 			info.namelength = 0;
